<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/Blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/Blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/Blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/Blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/Blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha256-xejo6yLi6vGtAjcMIsY8BHdKsLg7QynVlFMzdQgUuy8=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"yexiaorain.github.io","root":"/Blog/","images":"/Blog/images","scheme":"Muse","darkmode":false,"version":"8.12.3","exturl":false,"sidebar":{"position":"right","display":"hide","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/Blog/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/Blog/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="YeXiaoRain Blog">
<meta property="og:url" content="https://yexiaorain.github.io/Blog/index.html">
<meta property="og:site_name" content="YeXiaoRain Blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Xiao Ye">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://yexiaorain.github.io/Blog/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-TW","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>YeXiaoRain Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/Blog/css/noscript.css">
  </noscript>
<link rel="alternate" href="/Blog/atom.xml" title="YeXiaoRain Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/Blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">YeXiaoRain Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/Blog/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li><li class="menu-item menu-item-archives"><a href="/Blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔<span class="badge">224</span></a></li><li class="menu-item menu-item-yearmonth"><a href="/Blog/yearmonth/" rel="section"><i class="fa fa-calendar-days fa-fw"></i>年月</a></li><li class="menu-item menu-item-categories"><a href="/Blog/categories/" rel="section"><i class="fa fa-shapes fa-fw"></i>分類<span class="badge">15</span></a></li><li class="menu-item menu-item-tags"><a href="/Blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤<span class="badge">219</span></a></li><li class="menu-item menu-item-rss"><a href="/Blog/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>rss</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Xiao Ye"
      src="https://avatars.githubusercontent.com/u/7298239?v=4">
  <p class="site-author-name" itemprop="name">Xiao Ye</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/Blog/archives/">
          <span class="site-state-item-count">224</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/Blog/categories/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/Blog/tags/">
        <span class="site-state-item-count">219</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yexiaorain" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yexiaorain" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yexiaorain@gmail.com" title="E-Mail → mailto:yexiaorain@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://atcoder.jp/users/cromarmot" title="https:&#x2F;&#x2F;atcoder.jp&#x2F;users&#x2F;cromarmot" rel="noopener" target="_blank">AtCoder</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://codeforces.com/profile/YeXiaoRain" title="https:&#x2F;&#x2F;codeforces.com&#x2F;profile&#x2F;YeXiaoRain" rel="noopener" target="_blank">Codeforces</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="回到頂端">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/2022-12-17-ac-abc282/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/2022-12-17-ac-abc282/" class="post-title-link" itemprop="url">Atcoder abc282</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2022-12-17 00:00:00" itemprop="dateCreated datePublished" datetime="2022-12-17T00:00:00+08:00">2022-12-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2022-12-25 08:08:39" itemprop="dateModified" datetime="2022-12-25T08:08:39+08:00">2022-12-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Atcoder/" itemprop="url" rel="index"><span itemprop="name">Atcoder</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Atcoder/ABC/" itemprop="url" rel="index"><span itemprop="name">ABC</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/2022-12-17-ac-abc282/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022-12-17-ac-abc282/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>3k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>7 分鐘</span>
    </span>
</div>

            <div class="post-description">G(DP,前缀和)Ex(二分,分治)</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc282/tasks">https://atcoder.jp/contests/abc282/tasks</a></p>
<h1 id="G-Similar-Permutation"><a href="#G-Similar-Permutation" class="headerlink" title="G - Similar Permutation"></a>G - Similar Permutation</h1><p>两个长n排列A,B</p>
<p>相似度为 相邻同增次数 + 相邻同减次数, (A[i+1]-A[i])(B[i+1]-B[i]) &gt; 0</p>
<p>问 相似度为k的有序对 (A,B) 有多少个, mod p</p>
<h2 id="范围"><a href="#范围" class="headerlink" title="范围"></a>范围</h2><p>n 100</p>
<p>p [1e8~1e9]</p>
<p>4s</p>
<p>1024mb</p>
<h2 id="我的思路"><a href="#我的思路" class="headerlink" title="我的思路"></a>我的思路</h2><p>看这 n, 感觉有可能就要到4次方, 想一维度的排列,每次 从N-1到n, 就是考虑n的插入位置</p>
<p>但是两个序列的话</p>
<p>a0 a1 a2…..</p>
<p>b0 a1 b2…..</p>
<p>插入一个值, 会让后面的值平移, 增减关系会错位</p>
<hr>
<p>变一变, f(k) &#x3D; 至少k个位置增减关系一致, 那么ans &#x3D; f(k) - f(k+1)</p>
<p>但这样也不知道怎么统计</p>
<p>因为</p>
<p>1 2 3, 假设定了第一个位置是增</p>
<p>那么</p>
<p>1-2 3</p>
<p>2-3 1</p>
<p>1-3 2</p>
<p>第二个位置并不是增 减 数量相等的</p>
<hr>
<p>如果a和b在从n-1变到n时, 插入位置相同, 那么这个位置的左右增减都是相等的, 但是插入前可能相等可能不等,增量是1, 但不同怎么处理</p>
<p>再就是不要插入n, 而是末尾插入一个</p>
<p>f(len a, last a, len b, last b), 似乎可以搞?, 注意到两个len是相等的</p>
<p>插入 x, 等于 原来 [1…x-1] 不变, [x..n-1] 平移1变成[x+1,n]</p>
<p>f(len, last a, last b,同增减k)</p>
<p><code>f[n][a1][b1][k1] += f[n-1][a0][b0][k0] </code>, k1 &#x3D; k0+ bool( (a1 &lt;&#x3D; a0)^(b1 &lt;&#x3D; b0) )</p>
<p>这样状态是 O(n^4) 转移是 O(n^2) 一共O(n^6) 过不了</p>
<p>可能需要二维前缀和搞一搞?, 实际就是一条纵线 a1 &#x3D; a0 和 b1 &#x3D; b0 划分的</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>恩 类似的 就是需要二维前缀和搞一搞</p>
<p><code>dp[长i][当前相似度j][k个大于Ai][l个大于Bi]</code></p>
<h1 id="Ex-Min-Sum"><a href="#Ex-Min-Sum" class="headerlink" title="Ex - Min + Sum"></a>Ex - Min + Sum</h1><p>给两个长n序列, A,B</p>
<p>问有多少 (l,r) 满足</p>
<p>min(A[l..r]) + sum(B[l..r]) &lt;&#x3D; S</p>
<h2 id="范围-1"><a href="#范围-1" class="headerlink" title="范围"></a>范围</h2><p>n 2e5</p>
<p>s 3e14</p>
<p>ai [0,1e14]</p>
<p>bi [0,1e9]</p>
<h2 id="我的思路-1"><a href="#我的思路-1" class="headerlink" title="我的思路"></a>我的思路</h2><p>当固定了l以后, 随着r增大,  min(A[l..]) 非严格单调递减, sum(B[l..]) 非严格单调递增</p>
<p>这穿插着不知道怎么搞</p>
<p>但是 考虑l 时 算出了多个可行的r</p>
<p>那么 l 变成 l+1,</p>
<p>对于一个r, 如果原来 min &#x3D; A[l], 那么 A[l1] + (B[l+1…r] &#x3D; A[l] + B[l…r] + (A[l1]-A[l] - B[l]), 主要考察A[l1]-A[l] - B[l] 的大小,</p>
<p>对于一个r, 如果原来min !&#x3D; A[l], 那么 A[l1] + B[l+1..r] &#x3D; A[l1]+B[l..r] - B[l] &lt;&#x3D; S 一定成立</p>
<p>所以l -&gt; l+1 时, 从可行变成不可行的r一定是 被a[l] min覆盖了 A[l1]-A[l]-B[l] , 而 不可行变为可行的A[l1]-A[l]-B[l] &lt; 0</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>分治?!</p>
<p>考虑 统计 [L,R] 中的合法对</p>
<p>令 M为(L+R)&#x2F;2 (中点)</p>
<p>然后 a[..m] 为 后缀min, a[m..] 为前缀min</p>
<p>考虑如何找 l \in [L,M], r \in [M,R] 的合法对</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">双指针 p=m, q=m</span><br><span class="line">if a[p-1..m] &gt;= a[m..q+1]:</span><br><span class="line">  p = p-1</span><br><span class="line">  统计 l=p, r\in [M,q] ?????</span><br><span class="line">else</span><br><span class="line">  q = q+1</span><br><span class="line">  统计 l \in [p,M]</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">        m</span><br><span class="line">1 3 5 7 9 8 6 4 2</span><br><span class="line">        p q       (固定q)</span><br><span class="line">      p . q       (固定p)</span><br><span class="line">      p .   q     (固定q)</span><br><span class="line">    p   . . q     (固定p)</span><br><span class="line">    p . .     q   (固定q)</span><br><span class="line">  p     . . . q   (固定p)</span><br><span class="line">  p . . .       q (固定q)</span><br><span class="line">p       . . . . q (固定p)</span><br></pre></td></tr></table></figure>

<p>换句话说, 就是从中间向两边 扩散, 固定最小值, 另一半用二分, 这样就是 O(n (log n)^2)</p>
<hr>
<p>不要选中点m, 而是选最小值m来划分, 这样 怎么保证复杂度呢</p>
<p>[L..l..m..r…R] 那么这时 每次选长度更小的枚举, 而另一侧用 二分找(因为min确定了)</p>
<p>这样 O(n (log n)^2)</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>指定最小值的 <a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc282/submissions/37530192">https://atcoder.jp/contests/abc282/submissions/37530192</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,a,n) for (ll i=a;i&lt;(ll)n;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> per(i,a,n) for (ll i=n;i--&gt;(ll)a;)</span></span><br><span class="line"><span class="function">ll <span class="title">read</span><span class="params">()</span></span>&#123;ll r;<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;r);<span class="keyword">return</span> r;&#125;</span><br><span class="line"></span><br><span class="line">ll ans=<span class="number">0</span>;</span><br><span class="line">ll s;</span><br><span class="line">vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; to;</span><br><span class="line">vector&lt;ll&gt; a,b,c;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dc</span><span class="params">(<span class="type">int</span> v, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123; <span class="comment">// [l,r)</span></span><br><span class="line">  <span class="keyword">if</span> (v == <span class="number">-1</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span> (v-l &lt; r-v) &#123; <span class="comment">// for 短的, 二分长的</span></span><br><span class="line">    <span class="built_in">rep</span>(i,l,v+<span class="number">1</span>) ans += <span class="built_in">upper_bound</span>(<span class="built_in">begin</span>(c)+v+<span class="number">1</span>,<span class="built_in">begin</span>(c)+r+<span class="number">1</span>,s-a[v]+c[i])-<span class="built_in">begin</span>(c)-(v+<span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">rep</span>(j,v+<span class="number">1</span>,r+<span class="number">1</span>) ans += v+<span class="number">1</span>-(<span class="built_in">lower_bound</span>(<span class="built_in">begin</span>(c)+l,<span class="built_in">begin</span>(c)+v+<span class="number">1</span>,-s+a[v]+c[j])-<span class="built_in">begin</span>(c));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dc</span>(to[v].first,l,v);</span><br><span class="line">  <span class="built_in">dc</span>(to[v].second,v+<span class="number">1</span>,r);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> n=<span class="built_in">read</span>();</span><br><span class="line">  s=<span class="built_in">read</span>();</span><br><span class="line">  a=<span class="built_in">vector</span>&lt;ll&gt;(n);</span><br><span class="line">  b=<span class="built_in">vector</span>&lt;ll&gt;(n);</span><br><span class="line">  c=<span class="built_in">vector</span>&lt;ll&gt;(n+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,n) a[i]=<span class="built_in">read</span>();</span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,n) b[i]=<span class="built_in">read</span>();</span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,n) c[i+<span class="number">1</span>] = c[i]+b[i]; <span class="comment">// b的前缀和</span></span><br><span class="line"></span><br><span class="line">  a.<span class="built_in">push_back</span>(<span class="number">-1</span>);</span><br><span class="line">  to=<span class="built_in">vector</span>(n+<span class="number">1</span>,<span class="built_in">pair</span>&lt;<span class="type">int</span>,<span class="type">int</span>&gt;(<span class="number">-1</span>,<span class="number">-1</span>)); <span class="comment">// 记录最小值 [左侧切割的最小值, 右侧切割的最小值)</span></span><br><span class="line">  &#123;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; st; <span class="comment">// 单调增栈</span></span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,n+<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="type">int</span> l = <span class="number">-1</span>; <span class="comment">// 最后一个出栈的</span></span><br><span class="line">      <span class="keyword">while</span> (st.<span class="built_in">size</span>() &amp;&amp; a[st.<span class="built_in">top</span>()] &gt; a[i]) &#123;</span><br><span class="line">        <span class="type">int</span> j = st.<span class="built_in">top</span>();</span><br><span class="line">        st.<span class="built_in">pop</span>();</span><br><span class="line">        to[j].second = l;</span><br><span class="line">        l = j;</span><br><span class="line">      &#125;</span><br><span class="line">      to[i].first = l;</span><br><span class="line">      st.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">dc</span>(to[n].first,<span class="number">0</span>,n);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>G</p>
<p>dp + 前缀和</p>
<p>Ex</p>
<p>emmm, 题做少了, 这种固定最小值(不论直接选还是从中间双指针), 事后看起来就很自然且无脑啊</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc282/editorial">官方题解</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/2022-12-16-CF1767/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/2022-12-16-CF1767/" class="post-title-link" itemprop="url">Educational Codeforces Round 140 (Rated for Div. 2)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2022-12-16 00:00:00" itemprop="dateCreated datePublished" datetime="2022-12-16T00:00:00+08:00">2022-12-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2022-12-25 08:08:39" itemprop="dateModified" datetime="2022-12-25T08:08:39+08:00">2022-12-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Codeforces/" itemprop="url" rel="index"><span itemprop="name">Codeforces</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/2022-12-16-CF1767/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022-12-16-CF1767/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>6.8k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>17 分鐘</span>
    </span>
</div>

            <div class="post-description">E(meet-in-the-middle,bitmask)F(树链剖分,莫队,根号分治,dsu on tree)</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1767">https://codeforces.com/contest/1767</a></p>
<h1 id="E-Algebra-Flash"><a href="#E-Algebra-Flash" class="headerlink" title="E. Algebra Flash"></a>E. Algebra Flash</h1><p>长n的 染色格子</p>
<p>每次只能走 i+1 或 i+2</p>
<p>颜色要激活才能走(一次激活所有同色), 求最小代价, 让1到n是通的</p>
<h2 id="范围"><a href="#范围" class="headerlink" title="范围"></a>范围</h2><p>n 3e5</p>
<p>颜色种类 m [1,40]</p>
<p>激活代价 [1,1e7]</p>
<p>2s</p>
<p>256mb</p>
<h2 id="我的思路"><a href="#我的思路" class="headerlink" title="我的思路"></a>我的思路</h2><p>只感受到 i如果不激活, 那么i-1 和i+1必定要激活, 这样有一定的 约束性, 不知道能不能2-sat, 但感觉2-sat 出来的强联通块的意义 也不明</p>
<p>m 40 的话, 就没法直接bitmask</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>显然 如果提前买, 很容易检测 通, 但枚举太多</p>
<p>没法在过程中dp购买, 信息状态太大,</p>
<p>也是 相邻至少一个被买</p>
<p>就变成点覆盖问题</p>
<p>相当于 相邻就是边, 而颜色为点,也就是 选价值最小的点覆盖, 让每条边的两端至少一个被选</p>
<p>这是np-hard, (无法多项式时间)</p>
<p>一个办法是 枚举 mask, 遍历边 检查, O(2^m m^2), 显然TLE</p>
<p>考虑 前半 mask 和 后半mask</p>
<p>边有3种: 两端都在前半, 两端都在后半, 一端在前一端在后</p>
<p>两端在同一半的 mask 容易检查,</p>
<p>一前一后的, 反过来看 前半未选的, 决定了后半的必选 子mask</p>
<p>for mask2 in 后半:<br>  if mask2 双端后半 ok</p>
<p>for mask1 in 前半:<br>  if 双端前半 ok:<br>    submask &#x3D; f(前半-mask1)<br>    ans &#x3D; min(ans, cost(mask1) + min(后半ok 且 包裹submask 的))</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1767/submission/186167586">https://codeforces.com/contest/1767/submission/186167586</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,a,n) for (ll i=a;i&lt;(ll)n;i++)</span></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">read</span><span class="params">()</span></span>&#123;ll r;<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;r);<span class="keyword">return</span> r;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> n=<span class="built_in">read</span>();</span><br><span class="line">  <span class="type">int</span> m=<span class="built_in">read</span>();</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">c</span><span class="params">(n)</span></span>; <span class="comment">// color 0-index</span></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,n) c[i]=<span class="built_in">read</span>()<span class="number">-1</span>;</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">x</span><span class="params">(m)</span></span>; <span class="comment">// cost</span></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,m) x[i]=<span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">  <span class="function">vector&lt;ll&gt; <span class="title">g</span><span class="params">(m)</span></span>; <span class="comment">// g[color] = 相邻颜色的 bitmask (边的两端)</span></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>, n<span class="number">-1</span>)&#123;</span><br><span class="line">    g[c[i]]   |= (<span class="number">1ll</span> &lt;&lt; c[i+<span class="number">1</span>]);</span><br><span class="line">    g[c[i+<span class="number">1</span>]] |= (<span class="number">1ll</span> &lt;&lt; c[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  g[c[<span class="number">0</span>]]     |= (<span class="number">1ll</span> &lt;&lt; c[<span class="number">0</span>]); <span class="comment">// 1和n 必定要选</span></span><br><span class="line">  g[c[n - <span class="number">1</span>]] |= (<span class="number">1ll</span> &lt;&lt; c[n - <span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> l = m / <span class="number">2</span>; <span class="comment">// meet-in-the-ldle</span></span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dp</span><span class="params">(<span class="number">1</span>&lt;&lt;l, <span class="number">1e9</span>)</span></span>; <span class="comment">// 左侧 dp[mask] = 最小 右侧代价</span></span><br><span class="line">  <span class="keyword">auto</span> chmin=[](<span class="keyword">auto</span> &amp;a,<span class="keyword">auto</span> &amp;b)&#123;a=<span class="built_in">min</span>(a,b);&#125;;</span><br><span class="line">  <span class="built_in">rep</span>(mask,<span class="number">0</span>, <span class="number">1</span>&lt;&lt;(m-l))&#123; <span class="comment">// 右侧</span></span><br><span class="line">    ll chk = <span class="number">0</span>; <span class="comment">// 左侧必选的mask</span></span><br><span class="line">    <span class="type">int</span> tot = <span class="number">0</span>; <span class="comment">// 代价</span></span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>, m-l)&#123;</span><br><span class="line">      <span class="keyword">if</span> ((mask &gt;&gt; i) &amp; <span class="number">1</span>) tot += x[i + l];</span><br><span class="line">      <span class="keyword">else</span> chk |= g[i + l]; <span class="comment">// 左侧必选mask</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (((chk &gt;&gt; l) | mask) != mask) <span class="keyword">continue</span>; <span class="comment">// 两端都在 右侧 的检查</span></span><br><span class="line">    chk &amp;= ((<span class="number">1ll</span> &lt;&lt; l) - <span class="number">1</span>); <span class="comment">// 只考虑左侧</span></span><br><span class="line">    dp[chk] = <span class="built_in">min</span>(dp[chk], tot); <span class="comment">// 更新最小值</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 收集 子mask 的min</span></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>, l) <span class="built_in">rep</span>(mask,<span class="number">0</span>, <span class="number">1</span>&lt;&lt;l) <span class="keyword">if</span> (!((mask &gt;&gt; i) &amp; <span class="number">1</span>)) <span class="built_in">chmin</span>(dp[mask | (<span class="number">1</span> &lt;&lt; i)],dp[mask]);</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1e9</span>;</span><br><span class="line">  <span class="built_in">rep</span>(mask,<span class="number">0</span>, <span class="number">1</span> &lt;&lt; l)&#123;</span><br><span class="line">    ll chk = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>, l)&#123;</span><br><span class="line">      <span class="keyword">if</span> ((mask &gt;&gt; i) &amp; <span class="number">1</span>) tot += x[i];</span><br><span class="line">      <span class="keyword">else</span> chk |= g[i];</span><br><span class="line">    &#125;</span><br><span class="line">    chk &amp;= ((<span class="number">1ll</span> &lt;&lt; l) - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ((chk | mask) != mask) <span class="keyword">continue</span>; <span class="comment">// 两端都在左侧检查</span></span><br><span class="line">    ans = <span class="built_in">min</span>(ans, dp[mask] + tot); <span class="comment">// 自身 加上 合法子集对应右侧最小代价</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="F-Two-Subtrees"><a href="#F-Two-Subtrees" class="headerlink" title="F. Two Subtrees"></a>F. Two Subtrees</h1><p>n点,根1树, 点上有数 v[i]</p>
<p>q个询问, 每次ui,vi, 考虑所有 u的子树或v的子树的点 w, (同时是u和v的子树则计算两次, 找出现最多次数的值, 如果有多个则找最小的</p>
<h2 id="范围-1"><a href="#范围-1" class="headerlink" title="范围"></a>范围</h2><p>n 2e5</p>
<p>vi [1,2e5]</p>
<p>q 2e5</p>
<p>9s</p>
<p>1024mb</p>
<h2 id="我的思路-1"><a href="#我的思路-1" class="headerlink" title="我的思路"></a>我的思路</h2><p>树可以展开到线段上</p>
<p>问, 两个线段上,出现次数最多的最小值为多少, 依然不会做?</p>
<p>感觉是4个 指针, 有办法莫队吗?</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>先解决一个简单的问题</p>
<p>维护可重复集合, 处理3种询问</p>
<ol>
<li>增加值到集合</li>
<li>删除某个值一次</li>
<li>计算可重集合的mode, 维护cnt[值]记录次数, mode &#x3D; cnt最大的 最左侧下标</li>
</ol>
<p>考虑cnt  通过 sqrt-decomposition 构造</p>
<p>每个块, 记录最大值, 和一个最大值的下标数组, 这样每次增删 最大值变化不超过1, cnt数组就暴力更新, 这样每次 询问是O(sqrt(max value))</p>
<hr>
<p>回到题目, 一样的想法, 树可以展开到线段上, 考虑先序遍历, 记录每个点的出入时刻, 这样子树就是一个ie区间</p>
<p>sz[u] &#x3D; u的子树大小, 取某个整数 B, 如果sz &lt; B则称作轻, 否则称作重</p>
<p>[lv,rv],[lu, ru]</p>
<p>考虑 lv &lt;&#x3D; lu</p>
<p>之考虑 v的大小</p>
<hr>
<p>轻(v轻,u任意) 询问:</p>
<p>用 small-to-large 技术来维护 可重集合</p>
<p>有关于点w的可重集合, 来回答所有 轻询问 ui&#x3D;w</p>
<p>取所有vi子树的 节点, 计算现在可重集合的mode, 通过增删来复用</p>
<p>O(n log n 维护u对应的w(莫队) + q B 枚举小节点 + q sqrt(A) 回答询问)</p>
<p>这里树上拍扁 的 u对应的区间  (()())() 也和直接区间不同,</p>
<hr>
<p>重(v重,u任意) 询问</p>
<p>把重点 分割成不相交的 点路径</p>
<p>那么两个点, 同一个路径, 有子树 的差异不超过B个点</p>
<p>这样的路径数是 O(n&#x2F;B)</p>
<p>如果满足地一个条件, 标记所有路径上的点被用. 只要有未使用的重点, 就反复这样</p>
<ol>
<li>如果当前路径包含root, root没有父节点, 路径会终止, 至多一条路径</li>
<li>如果 路径中最后一个节点 的 父节点 只有1个重儿子(最后一个节点), 路径中点个数 + 孩子外部重儿子子树最后一个点父节点 &gt; B, 这样路径数不会超过 n&#x2F;B</li>
<li>路径最后一个节点的父节点 有多个重儿子. leave only 重节点在树中(重节点的父节点一定是重节点), 这树 包含至多n&#x2F;b个叶子,  计算树中总度, 至多 n&#x2F;b个额外孩子, 这样的路径之多n&#x2F;B</li>
</ol>
<p>把vi的子树分割成路径, 和轻 询问 类似</p>
<p>at the very beginning, we add to the multiset all the vertices of the subtree of the initial vertex of the path and mentally remove these vertices from the subtrees of vi vertices</p>
<p>加所有点O(n)</p>
<p>small-to-large O(n log n),</p>
<p>回答一个询问 due to condition on vertices from one path we have to add at most B vertices, O(n^2 log n &#x2F;b + qb + q sqrt(A)),</p>
<hr>
<p>重节点构成的链, 不只是重链, 而且要同链上的点 child[u] - child[v] &lt; B, 这样再按链id排序, 做莫队</p>
<p>链的个数 &lt; n&#x2F;b</p>
<h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,a,n) for (int i=a;i&lt;(int)n;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> per(i,a,n) for (int i=n;i--&gt;(int)a;)</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;<span class="type">int</span> r;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;r);<span class="keyword">return</span> r;&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> A = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> B = <span class="number">2000</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> SQRTA = <span class="number">500</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> val[N]; <span class="comment">// 点上值</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[N]; <span class="comment">// 图</span></span><br><span class="line"><span class="type">int</span> fa[N]; <span class="comment">// 父节点</span></span><br><span class="line"><span class="type">int</span> sz[N]; <span class="comment">// 子树大小</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> tin[N], tout[N]; <span class="comment">// 点 -&gt; 线段区间</span></span><br><span class="line"><span class="type">int</span> et[N]; <span class="comment">// 线段 -&gt; 点</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 记录父节点,子树大小,重儿子</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> v, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">  fa[v] = f;</span><br><span class="line">  sz[v] = <span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> mx = <span class="number">0</span>; <span class="comment">// 最大重儿子</span></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,g[v].<span class="built_in">size</span>()) <span class="keyword">if</span>(g[v][i]!=f) &#123;</span><br><span class="line">    <span class="type">int</span> u = g[v][i];</span><br><span class="line">    <span class="built_in">dfs1</span>(u, v);</span><br><span class="line">    sz[v] += sz[u];</span><br><span class="line">    <span class="keyword">if</span>(sz[g[v][mx]] &lt; sz[u]) mx = i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(mx) <span class="built_in">swap</span>(g[v][mx], g[v][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 树 子树 与 线段展开</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> v,<span class="type">int</span> &amp;T)</span> </span>&#123;</span><br><span class="line">  et[T] = v;</span><br><span class="line">  tin[v] = T++;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> u : g[v]) <span class="keyword">if</span>(u != fa[v]) <span class="built_in">dfs2</span>(u, T);</span><br><span class="line">  tout[v] = T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> cnt[A]; <span class="comment">// [值] = 次数</span></span><br><span class="line"><span class="type">int</span> v2b[A]; <span class="comment">// [值] = block</span></span><br><span class="line"><span class="type">int</span> bmx[A]; <span class="comment">// 块最大值</span></span><br><span class="line"><span class="type">int</span> v2c[A / SQRTA + <span class="number">13</span>][A]; <span class="comment">// [块block][次数] = 个数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> n=<span class="built_in">read</span>();</span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,n)val[i]=<span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">    <span class="type">int</span> u=<span class="built_in">read</span>()<span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> v=<span class="built_in">read</span>()<span class="number">-1</span>;</span><br><span class="line">    g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    g[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">dfs1</span>(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">  vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; <span class="built_in">ord</span>(n); <span class="comment">// size index</span></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,n) ord[i] = &#123;sz[i], i&#125;; <span class="comment">// 点从小到大</span></span><br><span class="line">  <span class="built_in">sort</span>(ord.<span class="built_in">begin</span>(), ord.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">gr</span><span class="params">(n,<span class="number">-1</span>)</span></span>; <span class="comment">// [点] 链id</span></span><br><span class="line">  <span class="type">int</span> cur = <span class="number">0</span>; <span class="comment">// 链id</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> [siz,v]:ord) <span class="keyword">if</span>(siz &gt;= B <span class="keyword">and</span> gr[v] == <span class="number">-1</span>)&#123; <span class="comment">// 重 点</span></span><br><span class="line">    <span class="type">int</span> u = v;</span><br><span class="line">    <span class="keyword">while</span>(gr[u] == <span class="number">-1</span> &amp;&amp; sz[u] - sz[v] &lt; B) &#123; <span class="comment">// u....v 都是重点, u的子节点而非v的子节点个数 &lt; B</span></span><br><span class="line">      gr[u] = cur;</span><br><span class="line">      u = fa[u];</span><br><span class="line">    &#125;</span><br><span class="line">    cur++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> T=<span class="number">0</span>;</span><br><span class="line">  <span class="built_in">dfs2</span>(<span class="number">0</span>,T);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,n) <span class="keyword">if</span>(sz[i] &lt; B) gr[i] = cur + tin[i] / B; <span class="comment">// 轻点 分组</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> q=<span class="built_in">read</span>();</span><br><span class="line">  vector&lt;array&lt;<span class="type">int</span>,6&gt; &gt; <span class="built_in">Q</span>(q); <span class="comment">// block, lv rv, lu ru, ans index</span></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,q)&#123;</span><br><span class="line">    <span class="type">int</span> v =<span class="built_in">read</span>()<span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> u =<span class="built_in">read</span>()<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> lv = tin[v];</span><br><span class="line">    <span class="type">int</span> rv = tout[v];</span><br><span class="line">    <span class="type">int</span> lu = tin[u];</span><br><span class="line">    <span class="type">int</span> ru = tout[u];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(lv &gt; lu) &#123; <span class="comment">// lv &lt;= lu</span></span><br><span class="line">      <span class="built_in">swap</span>(v,u);</span><br><span class="line">      <span class="built_in">swap</span>(lv, lu);</span><br><span class="line">      <span class="built_in">swap</span>(rv, ru);</span><br><span class="line">    &#125;</span><br><span class="line">    Q[i] = &#123;gr[v],lu,ru,lv,rv,i&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">sort</span>(<span class="built_in">begin</span>(Q),<span class="built_in">end</span>(Q)); <span class="comment">// 先b 后lu</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> lv = <span class="number">0</span>, rv = <span class="number">0</span>, lu = <span class="number">0</span>, ru = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,A) v2b[i] = i / SQRTA;</span><br><span class="line">  <span class="keyword">auto</span> insert=[&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="type">int</span> x=val[et[i]];</span><br><span class="line">    v2c[v2b[x]][cnt[x]]--;</span><br><span class="line">    cnt[x]++;</span><br><span class="line">    v2c[v2b[x]][cnt[x]]++;</span><br><span class="line">    <span class="keyword">if</span>(cnt[x] &gt; bmx[v2b[x]]) bmx[v2b[x]]++;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">auto</span> erase=[&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="type">int</span> x=val[et[i]];</span><br><span class="line">    <span class="keyword">if</span>(cnt[x] == bmx[v2b[x]] &amp;&amp; v2c[v2b[x]][cnt[x]] == <span class="number">1</span>) bmx[v2b[x]]--;</span><br><span class="line">    v2c[v2b[x]][cnt[x]]--;</span><br><span class="line">    cnt[x]--;</span><br><span class="line">    v2c[v2b[x]][cnt[x]]++;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">auto</span>  get_mode=[&amp;]() &#123;</span><br><span class="line">    <span class="type">int</span> mx = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">0</span>,A/SQRTA+<span class="number">1</span>) mx = <span class="built_in">max</span>(mx, bmx[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; ; i++)  <span class="keyword">if</span>(bmx[i] == mx)  <span class="keyword">for</span>(<span class="type">int</span> j = i * SQRTA; ; j++)  <span class="keyword">if</span>(cnt[j] == mx) <span class="keyword">return</span> j;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">ans</span><span class="params">(q)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> [b,qlu,qru,qlv,qrv,idx]:Q)&#123;</span><br><span class="line">    <span class="keyword">if</span>(b &lt; cur) &#123; <span class="comment">// 重块</span></span><br><span class="line">      <span class="keyword">while</span>(rv &lt; qrv) <span class="built_in">insert</span>(rv++);</span><br><span class="line">      <span class="keyword">while</span>(lv &gt; qlv) <span class="built_in">insert</span>(--lv);</span><br><span class="line">      <span class="keyword">while</span>(rv &gt; qrv) <span class="built_in">erase</span>(--rv);</span><br><span class="line">      <span class="keyword">while</span>(lv &lt; qlv) <span class="built_in">erase</span>(lv++);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">while</span>(rv &gt; lv) <span class="built_in">erase</span>(--rv); <span class="comment">// 枚举 替代 平移</span></span><br><span class="line">      lv = qlv;</span><br><span class="line">      rv = lv;</span><br><span class="line">      <span class="keyword">while</span>(rv &lt; qrv) <span class="built_in">insert</span>(rv++);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(ru &lt; qru) <span class="built_in">insert</span>(ru++);</span><br><span class="line">    <span class="keyword">while</span>(lu &gt; qlu) <span class="built_in">insert</span>(--lu);</span><br><span class="line">    <span class="keyword">while</span>(ru &gt; qru) <span class="built_in">erase</span>(--ru);</span><br><span class="line">    <span class="keyword">while</span>(lu &lt; qlu) <span class="built_in">erase</span>(lu++);</span><br><span class="line"></span><br><span class="line">    ans[idx] = <span class="built_in">get_mode</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">0</span>,q) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>E</p>
<p>meet-in-the-middle</p>
<p>感觉看到 40 要能向 bitmask + meet-in-the-middle 去想了</p>
<p>F</p>
<p>子树 &#x3D; 展开线段上的区间的想法有了,</p>
<p>这也能 轻-重 处理, 完全想不到</p>
<p>树链剖分(从根到某一点的路径上，不超过O(logN)条轻边，不超过O(logN)条重路径。)</p>
<p>然后就是 树上拍扁的区间 比 直接区间多一些特性</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://codeforces.com/blog/entry/110225">官方</a></p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/10524122">https://baike.baidu.com/item/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/10524122</a></p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/solution/CF1767F">https://www.luogu.com.cn/problem/solution/CF1767F</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/2022-12-15-CF1762/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/2022-12-15-CF1762/" class="post-title-link" itemprop="url">Codeforces Round 838 (Div. 2)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2022-12-15 00:00:00" itemprop="dateCreated datePublished" datetime="2022-12-15T00:00:00+08:00">2022-12-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2022-12-25 08:08:39" itemprop="dateModified" datetime="2022-12-25T08:08:39+08:00">2022-12-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Codeforces/" itemprop="url" rel="index"><span itemprop="name">Codeforces</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/2022-12-15-CF1762/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022-12-15-CF1762/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>6.1k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>15 分鐘</span>
    </span>
</div>

            <div class="post-description">D(gcd)E(Cayley's formula)F(DP,线段树)G(构造)</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1762">https://codeforces.com/contest/1762</a></p>
<h1 id="D-GCD-Queries"><a href="#D-GCD-Queries" class="headerlink" title="D. GCD Queries"></a>D. GCD Queries</h1><p>交互题</p>
<p>有 [0…n-1] 的排列 固定但是隐藏</p>
<p>你最多 2n 次询问, 找到2个下标, 其中一个要是0的下标</p>
<p>每次可以询问 gcd(a[i],a[j]), i!&#x3D;j</p>
<h2 id="范围"><a href="#范围" class="headerlink" title="范围"></a>范围</h2><p>n 2e4</p>
<p>3s</p>
<p>256mb</p>
<h2 id="我的思路"><a href="#我的思路" class="headerlink" title="我的思路"></a>我的思路</h2><p>筛出 2的倍数</p>
<p>筛出 4的倍数</p>
<p>这样下去就可以了</p>
<p>但 次数无法保证</p>
<p>要找2的倍数 首先得找到一个是2的倍数的, 这最坏需要 n&#x2F;2 + 3 次, 再找 就需要 n - 4 次</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/Blog/2022-12-15-CF1762/#more" rel="contents">
                閱讀全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/2022-12-12-CF1766/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/2022-12-12-CF1766/" class="post-title-link" itemprop="url">Educational Codeforces Round 139 (Rated for Div. 2)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2022-12-12 00:00:00" itemprop="dateCreated datePublished" datetime="2022-12-12T00:00:00+08:00">2022-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2022-12-25 08:08:39" itemprop="dateModified" datetime="2022-12-25T08:08:39+08:00">2022-12-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Codeforces/" itemprop="url" rel="index"><span itemprop="name">Codeforces</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/2022-12-12-CF1766/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022-12-12-CF1766/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>4.3k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>11 分鐘</span>
    </span>
</div>

            <div class="post-description">F(费用流, 上下界网络流)</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1766">https://codeforces.com/contest/1766</a></p>
<h1 id="F-MCF"><a href="#F-MCF" class="headerlink" title="F. MCF"></a>F. MCF</h1><p>n 点 m边 网络求一个最大流,最小费用 方案</p>
<p>且满足每条边上 实际流 与 其容量 奇偶性一致</p>
<p>输出方案, 或不存在</p>
<h2 id="范围"><a href="#范围" class="headerlink" title="范围"></a>范围</h2><p>n 100</p>
<p>m 200</p>
<p>容量 [1,100]</p>
<p>单位代价 wi [-100,100]</p>
<h2 id="我的思路"><a href="#我的思路" class="headerlink" title="我的思路"></a>我的思路</h2><p>想着把奇数处理掉, 剩下就是容量处以2, 费用乘以2的问题了</p>
<p>但不会处理奇数, 想到可以每个点出度入度, 但具体也不会</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/Blog/2022-12-12-CF1766/#more" rel="contents">
                閱讀全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/2022-12-10-ac-abc281/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/2022-12-10-ac-abc281/" class="post-title-link" itemprop="url">Atcoder abc281</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2022-12-10 00:00:00" itemprop="dateCreated datePublished" datetime="2022-12-10T00:00:00+08:00">2022-12-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2022-12-25 08:08:39" itemprop="dateModified" datetime="2022-12-25T08:08:39+08:00">2022-12-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Atcoder/" itemprop="url" rel="index"><span itemprop="name">Atcoder</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Atcoder/ABC/" itemprop="url" rel="index"><span itemprop="name">ABC</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/2022-12-10-ac-abc281/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022-12-10-ac-abc281/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>5.2k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>13 分鐘</span>
    </span>
</div>

            <div class="post-description">G(DP)Ex(生成函数,cdq分治)</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc281/tasks">https://atcoder.jp/contests/abc281/tasks</a></p>
<h1 id="G-Farthest-CIty"><a href="#G-Farthest-CIty" class="headerlink" title="G - Farthest CIty"></a>G - Farthest CIty</h1><p>问 n个点, 的简单连通图, 1到n的距离 严格大于所有1到其它点的距离的 图有多少个</p>
<p>个数 mod m</p>
<h2 id="范围"><a href="#范围" class="headerlink" title="范围"></a>范围</h2><p>n 500</p>
<p>m [1e8,1e9]</p>
<p>4s</p>
<p>1024mb</p>
<h2 id="我的思路"><a href="#我的思路" class="headerlink" title="我的思路"></a>我的思路</h2><p>数数嘛, 对于一个具体的图, 考虑计算所有点到1的距离,看一下相邻点的性质, </p>
<p>显然 相邻点的<code>距离</code>值 差不大于1</p>
<p>所以有一个O(n^4) 的dp</p>
<p><code>dp[最大距离为i][距离为i的有j个][距离&lt;=i的有k个] = 的方案数</code></p>
<p>有转移 <code>dp[i][j0][k0] = dp[i-1][j1][k1] * binom(n-k1,j0)/j0个在剩下的中选/ * (2^(j1)-1)^j0(每个分别和前面j1的连接方式) * 2^(j0(j0-1)/2) (j0个内部的任意连接) , 其中 k0=k1+j0</code></p>
<p>这样答案就是 <code>sum dp[1..n][1][n]</code></p>
<p>要是能优化成O(n^3)就能过了, 比赛时想了半天, 发现i无关, 想说矩阵乘法快速幂次, binom拆一拆 搞了半天</p>
<hr>
<p>赛后又想了想, 可以完全不要 <code>i</code> 直接 <code>dp[用了k个点][最大距离的有j个点]</code>的方案数 就完了………………..</p>
<p><code>dp[i0][j0] = dp[i1][j1] * binom(n-i1,j0) * (2^&#123;j1&#125;-1)^j0 * 2^(j0(j0-1)/2), 其中 i0=i1+j0</code></p>
<p><code>ans=dp[n][1]</code></p>
<p>其实这里有点问题, 因为中间选的时候不能选择 最后一个</p>
<p>所以不妨 先把 n拿出来 最后考虑它</p>
<p>这样转移方程不变</p>
<p><code>ans= sum dp[n-1][j=1..n-1] * (2^j-1)</code></p>
<hr>
<p>然后加个预处理 去掉 中间的log复杂度</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/Blog/2022-12-10-ac-abc281/#more" rel="contents">
                閱讀全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/Blog/page/2/">2</a><a class="page-number" href="/Blog/page/4/">4</a><a class="page-number" href="/Blog/page/8/">8</a><a class="page-number" href="/Blog/page/16/">16</a><a class="page-number" href="/Blog/page/32/">32</a><a class="page-number" href="/Blog/page/45/">45</a><a class="extend next" rel="next" href="/Blog/page/2/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiao Ye</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">1.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">44:18</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/Blog/js/comments.js"></script><script src="/Blog/js/utils.js"></script><script src="/Blog/js/schemes/muse.js"></script><script src="/Blog/js/next-boot.js"></script><script src="/Blog/js/bookmark.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/Blog/js/third-party/search/local-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/Blog/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.2.0/quicklink.umd.js" integrity="sha256-4kQf9z5ntdQrzsBC3YSHnEz02Z9C1UeW/E9OgnvlzSY=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":false,"home":false,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://yexiaorain.github.io/Blog/"}</script>
  <script src="/Blog/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"yexiaorain","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/Blog/js/third-party/comments/disqus.js"></script>

</body>
</html>
