---
title: NIM's GAME
date: 2020-01-10 10:37:14
tags: [nim的游戏,博弈论]
category: [algorithm]
mathjax: true
---

# 入门题目(Bash Game)

有一堆物品，两人轮流取,每次只能[1,a]个，最后取空的赢/输，求对策

假设你的对手取i个，有`1<=x<=a`,也就有`1<=a+1-x<=a`,保证不论对手怎么取x，只要你取对应的`a+1-x`个就能保证剩余的个数 对`a+1` 取模不变

控制到了不变量(对`a+1`取模不变)也就找到了解题的关键

# NIM(Nimm Game)

## NIM 1

现在是两堆石头（可能相同个数，可能不同），每轮任选一堆，从该堆取任意正数个，最后取空的人赢/输

如果 两相等，则对方任意取多少，你取相同的，总能维持一个不变`两堆的差值为0`

## NIM 2

变为n堆石头（每堆数量独立），取法和上题一致，最后取空的人赢/输

假设有偶数堆，且成对的相等，那么用上题的结论，然而，这里我们发现，上题无论初始状态如何，我们都能通过0步或者1步达到我们的平衡的状态/不变的状态，而这里如果假设是偶数堆和成对的相等，这样的状态并不是任意可达的。

对于数据小，又想不到“数学”方法去找平衡态，可以用递归搜索去做，不过不是本文要讲的内容。

然后是枚举，发现并不是只有上面的状态是必胜/必败

例如有石堆`1 2 3`，也是能做到最后取空的控制，说明 偶数堆且成对相等 和 必胜必败没 不全等只有被包含关系。

先直接上结论

所有石头堆的亦或值为0，显然如果当前为0,那么任意操作会使亦或值变成非0

假设亦或值为k，从数量为a的堆中取走，最后剩下newa个，

那么取走的个数为`a-newa >= 0`,`k^a^newa = 0`(原来的亦或 去掉a 新增newa)

所以`newa=a^k`也就是要证明存在a使得`a>=a^k`,k是所有数量的亦或结果，所以k的最高位1一定存在于某个`a[i]`中，所以对于`a[i]`来说`a[i]^k`在高于k的最高位和`a[i]`是一致的，在k的最高位`a[i]`为1,而`a[i]^k`为零，所以一定存在`a`使得`a>=a^k`,所以任意亦或非0可以一步转化为0。

综上任意状态，能够通过0步或者1步转化为亦或和为0。并且亦或和为0是一个可以交替进行并被控制的平衡态。

至于为什么是想到亦或和，我说不出，这个结论我也是从其它地方拿来，只会证明。

反过来再看NIM 1,会发现，虽然说是控制值相等，同时也就是控制亦或和相等。

# SG 函数

有向无环图上

$ \operatorname{mex}(S)=\min(\\\{x\\\}) \quad (x \notin S, x \in N) $

`mex`集合中不包含的最小非负整数

$ \operatorname{SG}(x)=\operatorname{mex}( \\\{ \operatorname{SG}(y) \| y是x的后继 \\\} ) $

边界也就是没有出度的点，$\operatorname{SG}(\emptyset)=0$

显然如果`SG(x)`为0，那么它的所有后继非0,如果`SG(x)`非0,那么一定存在一个后继`SG(y)`为0

所以一定能控制`SG(x)`为0的平衡态，也一定能通过0步，或1步达到这个平衡态。

## 对于多个游戏(n个有向图)?

```
还未理解

https://blog.csdn.net/philipsweng/article/details/48395375

$\operatorname{SG}(s_1) \oplus \operatorname{SG}(s_2) \oplus \ldots \oplus \operatorname{SG}(s_n)$

如果值为0,显然任何一个SG的改动都会导致最后非0。

任何非0能变为0?

同上面证明NIM 2的过程，假设所有亦或和为k，我们能得到

存在至少一个i满足`SG(s_i) > SG(s_i)^k`,但是如何证明对于第i个游戏，`SG(s_i)^k`是`SG(s_i)`的后继状态？？？？？？
```


# 参考

[game theory](https://oi-wiki.org/math/game-theory/)

[Sprague–Grundy_theorem](https://en.wikipedia.org/wiki/Sprague%E2%80%93Grundy_theorem)


