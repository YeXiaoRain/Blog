---
title: Atcoder arc113 E (数学+枚举+分类讨论)
date: 2021-02-22 10:37:14
tags: [math,enum]
category: [Atcoder]
mathjax: true
---

# 题目

https://atcoder.jp/contests/arc113/tasks/arc113_e

题目大意

给字符串,仅由a和b组成

操作: 任意选择两个相同的字母，把它们之间的内容 颠倒顺序，删掉这两个被选择的字母

你可以操作 0 到任意次

求字典序最大的结果

# 题解

显然，可以把a看作0,b看作1,也就是1尽量靠前且尽量多，而在满足1尽量多的时候，让0也尽量多

显然 如果0有偶数个，可以不消耗任何1,让结果以1开始

如果以0结束，也同样可以不消耗任何1,让结果以1开始

...

那么就是如何分类是这个问题的关键，怎么尽量少的分化，覆盖所有情况。

比赛里做出的人不多，有些cf红名大佬都没出 XD

我在讨论时，从 起始字符，终止字符，字符个数，连续字符个数多个方面去分类，想也不用想，没写出来,(之讨论到了部分情况)

---

直接看看 官方答案 怎么搞的。

## a结束

显然

如果前面的a偶数个，能不删除b变成 `b*a+`的形式

如果前面的a奇数个，能不删除b变成 `b*a*`的形式

那么我们其实要求的变成了，如何尽可能的少删除a

注意到因为完全不会删除b，所以不论b有多少个，它原本连接在一起就不会被拆开。

所以把连接在一起的b看作一个b，可以看作

`(a+)b(a+)b(a+)b(a+)b(a+)b(a+)` 的形式

那么我们一次 删除a至少连接 一次b，至多连接两次b。

选取一个`b(a{2,})b` 和 `b(a+)b`中的a进行删除 能连接一次b

选取两个`bab`中的a进行删除 能连接两次b

所以`长度为1的a`和`长度为1的a`先完成同时选择删除，最后处理剩余a

这样能做到总的操作次数最少 `= a(len=1) / 2 + a(len=1)%2 + a(len>1)` (不包括最后的a串)

例如 `aaabababababaaaaaa` ,a的连续串有4个1和1个3,所以删除次数 = 4/2 + 0 + 1 = 3, 剩余a的个数=原始个数-2x3

至此，对于a结束的情况可以解了

## b 结束

`abb` 和 `aabb` 结果就很不一样，看着这些连局部性都没有的串，很难受

### 如果a是偶数个

那必定可以不损耗b，且损耗所有a

### a是奇数个

现在的情况，奇数个a+结尾是b

继续讨论结尾

#### ab结尾

奇数个a，显然a删不完，那么这个ab结尾的b肯定无法移动到前面

对于b的个数，把字符串删来剩下一个a,可以不损耗b的情况得到`b*ab`

所以，前缀b最多是b的个数-1,也是可达到的。

这是可达也是最大可达的字符串，因为如果选了b，一定就变成个数-2,会比这个结果小

#### abb结尾

同上

我们可以得到 `b*abb`, 其中不会损耗任何b，前缀b的个数=b总个数-2

那 我们任何选择b的操作 都会 导致b的个数 <= 总个数-2,

所以，这也是最大可达

#### bbb结尾

（这种情况，我没有在赛内讨论到方案）

你看 `aaaaabbbbb`,`abaaaabbbb`, 就很不一样

##### a+b+

显然，其实都没了翻转只有删除，那 `ab+` 就是结果了

##### 其它

`a*b+a+b+`

其中 一定有`ba`

把它的b和末尾的b交换，一定能b少两个且以a结尾。(就是上面讨论过的情况)

从而 b的个数减2,以b开头是一个解

又字符串, 在不操作b的情况下，一定能变成 `b+ab+`，保留原始最后的a，这是能得到的最大的

也是比操作了b一次字典序小。（个数 小于 b的个数减2）

所以，一定要操作且仅操作一次b。

答案一定是 `b+a*` 其中b的个数少两个

那么这种情况又是讨论，如何留下尽可能多的a

首先，操作b的时候一定选的是ba的b，因为其余情况，都无法让结尾变成a，而结尾不是a的情况如上，得不到更长的b的前缀。

注意到对于a结尾我们已经有了答案，最后一个b前面x个长为1的a和y个长大于1的a，那么x/2 + x%2 + y

我们直接定义，在处理之前的状态叫做预期答案，也定义为 x/2 + x%2 + y。

那么，那一次选择两个b的操作

`.*b[(a+)b.*bb]b` => `.*[bbb.*b(a+)]`

如果`(a+)` 的部分长是1， 那么根据1个数的奇偶性，可能让预期答案减1或减少0

如果`(a+)` 的部分长度大于1, 那么让预期的答案减1

又如果先操作a，再操作b。

操作a时，产出和剩余预期的和为常量，且a的奇偶性不变

综上，存在`b(a{2,})` 则换它的b

否则换`ba`的b

最后和1一样计算a的个数

# 总结

分类有点难，其实上面几种情况全都有推过，但是我在类型分化时加上了起始的 字符，这样的题解看下来，是不太需要讨论起始字符的。但是在推的过程中不知道怎么排除。

第二是我分类的时候，奇偶的分类顺序比结束字符的高，又导致了过多的分类分叉 QAQ

然后我还有想转换（从情况某某+操作转换到情况某某），这样看来这题也不太需要转换

另外其实对于代码上做分类，不太怕重复，毕竟如果两个非类方式有重复，进任何一种都可以，怕的是漏掉了分类。

# Code

分类的顺序和内容做好了，还要啥代码呢

https://atcoder.jp/contests/arc113/submissions/20437840

# Ref

https://atcoder.jp/contests/arc113/editorial/792
