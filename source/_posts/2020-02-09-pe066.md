---
title: project euler 066 diophantine equation
date: 2020-02-09 10:37:14
tags: [pe,project euler,math]
category: [project euler]
mathjax: true
---

# 题目

https://projecteuler.net/problem=66

# 大意

d = 1->1000，d是非平方数

每个d 求最小的正整数`x`使得`x*x-d*y*y=1`，其中x,y都是整数,

最后对所有这些x求最大的x

# 自闭尝试

## 一些自己的数学推论

如果质数p是d的因子，那么$x^2 = 1 (mod p)$,由此$x = 1 (mod p)$ 或者$x=p-1(mod p)$

所以我们可以按d的最大质因子的倍数 加减1去搜，能快个常数倍

如果$x^2-dy^2=1$

显然有$(x-1)(x+1) = dy^2$

令$d=d_1 \cdot d_2$

令$y=y_1 \cdot y_2$

根据对称性必然有 $d_1 \cdot {y_1}^2 - d_2 \cdot {y_2}^2 = 2$

一定程度上能减少搜索量，优化最多也就最大质数常数倍，也是最多100倍的优化

> 另外就是MOd4的性质，用处不大，2倍左右常数优化

> 然后就是1-100内的尝试是d=61最大1766319049

> 如果d0能找到x0，那么d0和y0因子平方的组合最多是x0,也是优化不大

## python3写了个 按x递增搜索

```python
N = 1000
d = set()
Q = set()

for d in range(1,N+1):
    d.add(d)

x = 1
while len(d) != 0:
    Q.add(x**2)
    delarr = []
    for d in d:
        if x**2 - 1 > 0 and (x**2-1)%d == 0 and (x**2-1)//d in Q:
            print(x,"^2-",d,"*",(x**2-1)//d,"=1,leftcnt=",len(d))
            delarr.append(d)
    for d in delarr:
        d.remove(d)
    x+=1
"""
2 ^2- 3 * 1 =1,leftcnt= 1000
3 ^2- 2 * 4 =1,leftcnt= 999
3 ^2- 8 * 1 =1,leftcnt= 999
4 ^2- 15 * 1 =1,leftcnt= 997
5 ^2- 6 * 4 =1,leftcnt= 996
5 ^2- 24 * 1 =1,leftcnt= 996
6 ^2- 35 * 1 =1,leftcnt= 994
7 ^2- 12 * 4 =1,leftcnt= 993
7 ^2- 48 * 1 =1,leftcnt= 993
8 ^2- 7 * 9 =1,leftcnt= 991
8 ^2- 63 * 1 =1,leftcnt= 991
9 ^2- 5 * 16 =1,leftcnt= 989
9 ^2- 20 * 4 =1,leftcnt= 989
9 ^2- 80 * 1 =1,leftcnt= 989
10 ^2- 11 * 9 =1,leftcnt= 986
10 ^2- 99 * 1 =1,leftcnt= 986
11 ^2- 30 * 4 =1,leftcnt= 984
11 ^2- 120 * 1 =1,leftcnt= 984
12 ^2- 143 * 1 =1,leftcnt= 982
13 ^2- 42 * 4 =1,leftcnt= 981
13 ^2- 168 * 1 =1,leftcnt= 981
14 ^2- 195 * 1 =1,leftcnt= 979
15 ^2- 14 * 16 =1,leftcnt= 978
15 ^2- 56 * 4 =1,leftcnt= 978
15 ^2- 224 * 1 =1,leftcnt= 978
16 ^2- 255 * 1 =1,leftcnt= 975
17 ^2- 18 * 16 =1,leftcnt= 974
17 ^2- 32 * 9 =1,leftcnt= 974
17 ^2- 72 * 4 =1,leftcnt= 974
17 ^2- 288 * 1 =1,leftcnt= 974
18 ^2- 323 * 1 =1,leftcnt= 970
19 ^2- 10 * 36 =1,leftcnt= 969
19 ^2- 40 * 9 =1,leftcnt= 969
19 ^2- 90 * 4 =1,leftcnt= 969
19 ^2- 360 * 1 =1,leftcnt= 969
20 ^2- 399 * 1 =1,leftcnt= 965
21 ^2- 110 * 4 =1,leftcnt= 964
21 ^2- 440 * 1 =1,leftcnt= 964
22 ^2- 483 * 1 =1,leftcnt= 962
23 ^2- 33 * 16 =1,leftcnt= 961
23 ^2- 132 * 4 =1,leftcnt= 961
23 ^2- 528 * 1 =1,leftcnt= 961
24 ^2- 23 * 25 =1,leftcnt= 958
24 ^2- 575 * 1 =1,leftcnt= 958
25 ^2- 39 * 16 =1,leftcnt= 956
25 ^2- 156 * 4 =1,leftcnt= 956
25 ^2- 624 * 1 =1,leftcnt= 956
26 ^2- 27 * 25 =1,leftcnt= 953
26 ^2- 75 * 9 =1,leftcnt= 953
26 ^2- 675 * 1 =1,leftcnt= 953
27 ^2- 182 * 4 =1,leftcnt= 950
27 ^2- 728 * 1 =1,leftcnt= 950
28 ^2- 87 * 9 =1,leftcnt= 948
28 ^2- 783 * 1 =1,leftcnt= 948
29 ^2- 210 * 4 =1,leftcnt= 946
29 ^2- 840 * 1 =1,leftcnt= 946
30 ^2- 899 * 1 =1,leftcnt= 944
31 ^2- 60 * 16 =1,leftcnt= 943
31 ^2- 240 * 4 =1,leftcnt= 943
31 ^2- 960 * 1 =1,leftcnt= 943
33 ^2- 17 * 64 =1,leftcnt= 940
33 ^2- 68 * 16 =1,leftcnt= 940
33 ^2- 272 * 4 =1,leftcnt= 940
35 ^2- 34 * 36 =1,leftcnt= 937
35 ^2- 136 * 9 =1,leftcnt= 937
35 ^2- 306 * 4 =1,leftcnt= 937
37 ^2- 38 * 36 =1,leftcnt= 934
37 ^2- 152 * 9 =1,leftcnt= 934
37 ^2- 342 * 4 =1,leftcnt= 934
39 ^2- 95 * 16 =1,leftcnt= 931
39 ^2- 380 * 4 =1,leftcnt= 931
41 ^2- 105 * 16 =1,leftcnt= 929
41 ^2- 420 * 4 =1,leftcnt= 929
43 ^2- 462 * 4 =1,leftcnt= 927
44 ^2- 215 * 9 =1,leftcnt= 926
45 ^2- 506 * 4 =1,leftcnt= 925
46 ^2- 235 * 9 =1,leftcnt= 924
47 ^2- 138 * 16 =1,leftcnt= 923
47 ^2- 552 * 4 =1,leftcnt= 923
48 ^2- 47 * 49 =1,leftcnt= 921
49 ^2- 96 * 25 =1,leftcnt= 920
49 ^2- 150 * 16 =1,leftcnt= 920
49 ^2- 600 * 4 =1,leftcnt= 920
50 ^2- 51 * 49 =1,leftcnt= 917
51 ^2- 26 * 100 =1,leftcnt= 916
51 ^2- 104 * 25 =1,leftcnt= 916
51 ^2- 650 * 4 =1,leftcnt= 916
53 ^2- 78 * 36 =1,leftcnt= 913
53 ^2- 312 * 9 =1,leftcnt= 913
53 ^2- 702 * 4 =1,leftcnt= 913
55 ^2- 21 * 144 =1,leftcnt= 910
55 ^2- 84 * 36 =1,leftcnt= 910
55 ^2- 189 * 16 =1,leftcnt= 910
55 ^2- 336 * 9 =1,leftcnt= 910
55 ^2- 756 * 4 =1,leftcnt= 910
57 ^2- 203 * 16 =1,leftcnt= 905
57 ^2- 812 * 4 =1,leftcnt= 905
59 ^2- 870 * 4 =1,leftcnt= 903
61 ^2- 930 * 4 =1,leftcnt= 902
62 ^2- 427 * 9 =1,leftcnt= 901
63 ^2- 62 * 64 =1,leftcnt= 900
63 ^2- 248 * 16 =1,leftcnt= 900
63 ^2- 992 * 4 =1,leftcnt= 900
64 ^2- 455 * 9 =1,leftcnt= 897
65 ^2- 66 * 64 =1,leftcnt= 896
65 ^2- 264 * 16 =1,leftcnt= 896
71 ^2- 140 * 36 =1,leftcnt= 894
71 ^2- 315 * 16 =1,leftcnt= 894
71 ^2- 560 * 9 =1,leftcnt= 894
73 ^2- 37 * 144 =1,leftcnt= 891
73 ^2- 148 * 36 =1,leftcnt= 891
73 ^2- 333 * 16 =1,leftcnt= 891
73 ^2- 592 * 9 =1,leftcnt= 891
74 ^2- 219 * 25 =1,leftcnt= 887
76 ^2- 231 * 25 =1,leftcnt= 886
79 ^2- 390 * 16 =1,leftcnt= 885
80 ^2- 79 * 81 =1,leftcnt= 884
80 ^2- 711 * 9 =1,leftcnt= 884
81 ^2- 410 * 16 =1,leftcnt= 882
82 ^2- 83 * 81 =1,leftcnt= 881
82 ^2- 747 * 9 =1,leftcnt= 881
87 ^2- 473 * 16 =1,leftcnt= 879
89 ^2- 55 * 144 =1,leftcnt= 878
89 ^2- 220 * 36 =1,leftcnt= 878
89 ^2- 495 * 16 =1,leftcnt= 878
89 ^2- 880 * 9 =1,leftcnt= 878
91 ^2- 230 * 36 =1,leftcnt= 874
91 ^2- 920 * 9 =1,leftcnt= 874
95 ^2- 141 * 64 =1,leftcnt= 872
95 ^2- 564 * 16 =1,leftcnt= 872
97 ^2- 147 * 64 =1,leftcnt= 870
97 ^2- 192 * 49 =1,leftcnt= 870
97 ^2- 588 * 16 =1,leftcnt= 870
99 ^2- 50 * 196 =1,leftcnt= 867
99 ^2- 98 * 100 =1,leftcnt= 867
99 ^2- 200 * 49 =1,leftcnt= 867
99 ^2- 392 * 25 =1,leftcnt= 867
101 ^2- 102 * 100 =1,leftcnt= 863
101 ^2- 408 * 25 =1,leftcnt= 863
103 ^2- 663 * 16 =1,leftcnt= 861
105 ^2- 689 * 16 =1,leftcnt= 860
107 ^2- 318 * 36 =1,leftcnt= 859
109 ^2- 330 * 36 =1,leftcnt= 858
111 ^2- 770 * 16 =1,leftcnt= 857
113 ^2- 798 * 16 =1,leftcnt= 856
119 ^2- 885 * 16 =1,leftcnt= 855
120 ^2- 119 * 121 =1,leftcnt= 854
121 ^2- 915 * 16 =1,leftcnt= 853
122 ^2- 123 * 121 =1,leftcnt= 852
124 ^2- 615 * 25 =1,leftcnt= 851
125 ^2- 434 * 36 =1,leftcnt= 850
126 ^2- 635 * 25 =1,leftcnt= 849
127 ^2- 28 * 576 =1,leftcnt= 848
127 ^2- 112 * 144 =1,leftcnt= 848
127 ^2- 252 * 64 =1,leftcnt= 848
127 ^2- 448 * 36 =1,leftcnt= 848
129 ^2- 65 * 256 =1,leftcnt= 844
129 ^2- 260 * 64 =1,leftcnt= 844
143 ^2- 142 * 144 =1,leftcnt= 842
143 ^2- 568 * 36 =1,leftcnt= 842
145 ^2- 146 * 144 =1,leftcnt= 840
145 ^2- 584 * 36 =1,leftcnt= 840
146 ^2- 435 * 49 =1,leftcnt= 838
148 ^2- 447 * 49 =1,leftcnt= 837
149 ^2- 222 * 100 =1,leftcnt= 836
149 ^2- 888 * 25 =1,leftcnt= 836
151 ^2- 57 * 400 =1,leftcnt= 834
151 ^2- 228 * 100 =1,leftcnt= 834
151 ^2- 912 * 25 =1,leftcnt= 834
159 ^2- 395 * 64 =1,leftcnt= 831
161 ^2- 45 * 576 =1,leftcnt= 830
161 ^2- 180 * 144 =1,leftcnt= 830
161 ^2- 320 * 81 =1,leftcnt= 830
161 ^2- 405 * 64 =1,leftcnt= 830
161 ^2- 720 * 36 =1,leftcnt= 830
163 ^2- 82 * 324 =1,leftcnt= 825
163 ^2- 328 * 81 =1,leftcnt= 825
163 ^2- 738 * 36 =1,leftcnt= 825
168 ^2- 167 * 169 =1,leftcnt= 822
170 ^2- 19 * 1521 =1,leftcnt= 821
170 ^2- 171 * 169 =1,leftcnt= 821
179 ^2- 890 * 36 =1,leftcnt= 819
181 ^2- 910 * 36 =1,leftcnt= 818
191 ^2- 570 * 64 =1,leftcnt= 817
193 ^2- 582 * 64 =1,leftcnt= 816
195 ^2- 194 * 196 =1,leftcnt= 815
195 ^2- 776 * 49 =1,leftcnt= 815
197 ^2- 22 * 1764 =1,leftcnt= 813
197 ^2- 88 * 441 =1,leftcnt= 813
197 ^2- 198 * 196 =1,leftcnt= 813
197 ^2- 792 * 49 =1,leftcnt= 813
199 ^2- 44 * 900 =1,leftcnt= 809
199 ^2- 176 * 225 =1,leftcnt= 809
199 ^2- 275 * 144 =1,leftcnt= 809
199 ^2- 396 * 100 =1,leftcnt= 809
201 ^2- 101 * 400 =1,leftcnt= 805
201 ^2- 404 * 100 =1,leftcnt= 805
215 ^2- 321 * 144 =1,leftcnt= 803
217 ^2- 327 * 144 =1,leftcnt= 802
223 ^2- 777 * 64 =1,leftcnt= 801
224 ^2- 223 * 225 =1,leftcnt= 800
225 ^2- 791 * 64 =1,leftcnt= 799
226 ^2- 227 * 225 =1,leftcnt= 798
233 ^2- 377 * 144 =1,leftcnt= 797
241 ^2- 480 * 121 =1,leftcnt= 796
242 ^2- 723 * 81 =1,leftcnt= 795
243 ^2- 122 * 484 =1,leftcnt= 794
243 ^2- 488 * 121 =1,leftcnt= 794
244 ^2- 135 * 441 =1,leftcnt= 792
244 ^2- 735 * 81 =1,leftcnt= 792
249 ^2- 155 * 400 =1,leftcnt= 790
249 ^2- 620 * 100 =1,leftcnt= 790
251 ^2- 70 * 900 =1,leftcnt= 788
251 ^2- 280 * 225 =1,leftcnt= 788
251 ^2- 630 * 100 =1,leftcnt= 788
255 ^2- 254 * 256 =1,leftcnt= 785
257 ^2- 258 * 256 =1,leftcnt= 784
271 ^2- 510 * 144 =1,leftcnt= 783
287 ^2- 572 * 144 =1,leftcnt= 782
288 ^2- 287 * 289 =1,leftcnt= 781
289 ^2- 145 * 576 =1,leftcnt= 780
289 ^2- 580 * 144 =1,leftcnt= 780
290 ^2- 291 * 289 =1,leftcnt= 778
293 ^2- 438 * 196 =1,leftcnt= 777
295 ^2- 111 * 784 =1,leftcnt= 776
295 ^2- 444 * 196 =1,leftcnt= 776
299 ^2- 894 * 100 =1,leftcnt= 774
301 ^2- 906 * 100 =1,leftcnt= 773
305 ^2- 646 * 144 =1,leftcnt= 772
323 ^2- 322 * 324 =1,leftcnt= 771
325 ^2- 326 * 324 =1,leftcnt= 770
337 ^2- 672 * 169 =1,leftcnt= 769
339 ^2- 170 * 676 =1,leftcnt= 768
339 ^2- 680 * 169 =1,leftcnt= 768
343 ^2- 817 * 144 =1,leftcnt= 766
351 ^2- 77 * 1600 =1,leftcnt= 765
351 ^2- 308 * 400 =1,leftcnt= 765
359 ^2- 895 * 144 =1,leftcnt= 763
360 ^2- 359 * 361 =1,leftcnt= 762
361 ^2- 905 * 144 =1,leftcnt= 761
362 ^2- 363 * 361 =1,leftcnt= 760
377 ^2- 987 * 144 =1,leftcnt= 759
383 ^2- 573 * 256 =1,leftcnt= 758
385 ^2- 579 * 256 =1,leftcnt= 757
391 ^2- 780 * 196 =1,leftcnt= 756
393 ^2- 197 * 784 =1,leftcnt= 755
393 ^2- 788 * 196 =1,leftcnt= 755
399 ^2- 398 * 400 =1,leftcnt= 753
401 ^2- 402 * 400 =1,leftcnt= 752
415 ^2- 299 * 576 =1,leftcnt= 751
424 ^2- 799 * 225 =1,leftcnt= 750
440 ^2- 439 * 441 =1,leftcnt= 749
442 ^2- 443 * 441 =1,leftcnt= 748
449 ^2- 126 * 1600 =1,leftcnt= 747
449 ^2- 350 * 576 =1,leftcnt= 747
449 ^2- 504 * 400 =1,leftcnt= 747
449 ^2- 896 * 225 =1,leftcnt= 747
451 ^2- 226 * 900 =1,leftcnt= 743
451 ^2- 904 * 225 =1,leftcnt= 743
483 ^2- 482 * 484 =1,leftcnt= 741
485 ^2- 54 * 4356 =1,leftcnt= 740
485 ^2- 216 * 1089 =1,leftcnt= 740
485 ^2- 486 * 484 =1,leftcnt= 740
485 ^2- 726 * 324 =1,leftcnt= 740
487 ^2- 183 * 1296 =1,leftcnt= 736
487 ^2- 732 * 324 =1,leftcnt= 736
489 ^2- 305 * 784 =1,leftcnt= 734
513 ^2- 257 * 1024 =1,leftcnt= 733
528 ^2- 527 * 529 =1,leftcnt= 732
530 ^2- 59 * 4761 =1,leftcnt= 731
530 ^2- 531 * 529 =1,leftcnt= 731
551 ^2- 759 * 400 =1,leftcnt= 729
575 ^2- 574 * 576 =1,leftcnt= 728
577 ^2- 128 * 2601 =1,leftcnt= 727
577 ^2- 578 * 576 =1,leftcnt= 727
579 ^2- 290 * 1156 =1,leftcnt= 725
599 ^2- 897 * 400 =1,leftcnt= 724
601 ^2- 903 * 400 =1,leftcnt= 723
604 ^2- 335 * 1089 =1,leftcnt= 722
624 ^2- 623 * 625 =1,leftcnt= 721
626 ^2- 627 * 625 =1,leftcnt= 720
638 ^2- 923 * 441 =1,leftcnt= 719
649 ^2- 13 * 32400 =1,leftcnt= 718
649 ^2- 52 * 8100 =1,leftcnt= 718
649 ^2- 117 * 3600 =1,leftcnt= 718
649 ^2- 208 * 2025 =1,leftcnt= 718
649 ^2- 325 * 1296 =1,leftcnt= 718
649 ^2- 468 * 900 =1,leftcnt= 718
675 ^2- 674 * 676 =1,leftcnt= 712
677 ^2- 678 * 676 =1,leftcnt= 711
685 ^2- 266 * 1764 =1,leftcnt= 710
687 ^2- 602 * 784 =1,leftcnt= 709
701 ^2- 546 * 900 =1,leftcnt= 708
703 ^2- 858 * 576 =1,leftcnt= 707
721 ^2- 160 * 3249 =1,leftcnt= 706
723 ^2- 362 * 1444 =1,leftcnt= 705
727 ^2- 273 * 1936 =1,leftcnt= 704
728 ^2- 727 * 729 =1,leftcnt= 703
730 ^2- 731 * 729 =1,leftcnt= 702
737 ^2- 943 * 576 =1,leftcnt= 701
783 ^2- 782 * 784 =1,leftcnt= 700
785 ^2- 786 * 784 =1,leftcnt= 699
801 ^2- 401 * 1600 =1,leftcnt= 698
809 ^2- 505 * 1296 =1,leftcnt= 697
840 ^2- 839 * 841 =1,leftcnt= 696
842 ^2- 843 * 841 =1,leftcnt= 695
881 ^2- 990 * 784 =1,leftcnt= 694
883 ^2- 442 * 1764 =1,leftcnt= 693
899 ^2- 898 * 900 =1,leftcnt= 692
901 ^2- 902 * 900 =1,leftcnt= 691
960 ^2- 959 * 961 =1,leftcnt= 690
962 ^2- 107 * 8649 =1,leftcnt= 689
962 ^2- 963 * 961 =1,leftcnt= 689
969 ^2- 485 * 1936 =1,leftcnt= 687
1015 ^2- 381 * 2704 =1,leftcnt= 686
1025 ^2- 114 * 9216 =1,leftcnt= 685
1025 ^2- 456 * 2304 =1,leftcnt= 685
1059 ^2- 530 * 2116 =1,leftcnt= 683
1079 ^2- 165 * 7056 =1,leftcnt= 682
1079 ^2- 660 * 1764 =1,leftcnt= 682
1126 ^2- 115 * 11025 =1,leftcnt= 680
1135 ^2- 994 * 1296 =1,leftcnt= 679
1151 ^2- 92 * 14400 =1,leftcnt= 678
1151 ^2- 207 * 6400 =1,leftcnt= 678
1151 ^2- 368 * 3600 =1,leftcnt= 678
1151 ^2- 828 * 1600 =1,leftcnt= 678
1153 ^2- 577 * 2304 =1,leftcnt= 674
1209 ^2- 755 * 1936 =1,leftcnt= 673
1249 ^2- 975 * 1600 =1,leftcnt= 672
1251 ^2- 626 * 2500 =1,leftcnt= 671
1279 ^2- 710 * 2304 =1,leftcnt= 670
1324 ^2- 159 * 11025 =1,leftcnt= 669
1351 ^2- 108 * 16900 =1,leftcnt= 668
1351 ^2- 300 * 6084 =1,leftcnt= 668
1351 ^2- 432 * 4225 =1,leftcnt= 668
1351 ^2- 507 * 3600 =1,leftcnt= 668
1353 ^2- 677 * 2704 =1,leftcnt= 664
1376 ^2- 935 * 2025 =1,leftcnt= 663
1451 ^2- 174 * 12100 =1,leftcnt= 662
1451 ^2- 696 * 3025 =1,leftcnt= 662
1459 ^2- 730 * 2916 =1,leftcnt= 660
1471 ^2- 690 * 3136 =1,leftcnt= 659
1520 ^2- 31 * 74529 =1,leftcnt= 658
1520 ^2- 279 * 8281 =1,leftcnt= 658
1567 ^2- 348 * 7056 =1,leftcnt= 656
1569 ^2- 785 * 3136 =1,leftcnt= 655
1574 ^2- 91 * 27225 =1,leftcnt= 654
1574 ^2- 819 * 3025 =1,leftcnt= 654
1601 ^2- 178 * 14400 =1,leftcnt= 652
1601 ^2- 712 * 3600 =1,leftcnt= 652
1665 ^2- 221 * 12544 =1,leftcnt= 650
1665 ^2- 884 * 3136 =1,leftcnt= 650
1682 ^2- 187 * 15129 =1,leftcnt= 648
1683 ^2- 842 * 3364 =1,leftcnt= 647
1691 ^2- 470 * 6084 =1,leftcnt= 646
1693 ^2- 658 * 4356 =1,leftcnt= 645
1695 ^2- 371 * 7744 =1,leftcnt= 644
1735 ^2- 651 * 4624 =1,leftcnt= 643
1801 ^2- 901 * 3600 =1,leftcnt= 642
1814 ^2- 555 * 5929 =1,leftcnt= 641
1923 ^2- 962 * 3844 =1,leftcnt= 640
1961 ^2- 545 * 7056 =1,leftcnt= 639
2024 ^2- 175 * 23409 =1,leftcnt= 638
2024 ^2- 567 * 7225 =1,leftcnt= 638
2049 ^2- 41 * 102400 =1,leftcnt= 636
2049 ^2- 164 * 25600 =1,leftcnt= 636
2049 ^2- 656 * 6400 =1,leftcnt= 636
2167 ^2- 813 * 5776 =1,leftcnt= 633
2177 ^2- 153 * 30976 =1,leftcnt= 632
2177 ^2- 612 * 7744 =1,leftcnt= 632
2351 ^2- 282 * 19600 =1,leftcnt= 630
2367 ^2- 518 * 10816 =1,leftcnt= 629
2402 ^2- 267 * 21609 =1,leftcnt= 628
2431 ^2- 285 * 20736 =1,leftcnt= 627
2449 ^2- 544 * 11025 =1,leftcnt= 626
2449 ^2- 850 * 7056 =1,leftcnt= 626
2501 ^2- 278 * 22500 =1,leftcnt= 624
2524 ^2- 303 * 21025 =1,leftcnt= 623
2526 ^2- 707 * 9025 =1,leftcnt= 622
2647 ^2- 993 * 7056 =1,leftcnt= 621
2663 ^2- 407 * 17424 =1,leftcnt= 620
2737 ^2- 608 * 12321 =1,leftcnt= 619
3041 ^2- 855 * 10816 =1,leftcnt= 618
3365 ^2- 374 * 30276 =1,leftcnt= 617
3401 ^2- 357 * 32400 =1,leftcnt= 616
3480 ^2- 71 * 170569 =1,leftcnt= 615
3482 ^2- 43 * 281961 =1,leftcnt= 614
3482 ^2- 387 * 31329 =1,leftcnt= 614
3699 ^2- 74 * 184900 =1,leftcnt= 612
3699 ^2- 296 * 46225 =1,leftcnt= 612
3725 ^2- 874 * 15876 =1,leftcnt= 610
3871 ^2- 860 * 17424 =1,leftcnt= 609
3970 ^2- 539 * 29241 =1,leftcnt= 608
3970 ^2- 891 * 17689 =1,leftcnt= 608
4115 ^2- 714 * 23716 =1,leftcnt= 606
4231 ^2- 940 * 19044 =1,leftcnt= 605
4393 ^2- 793 * 24336 =1,leftcnt= 604
4490 ^2- 499 * 40401 =1,leftcnt= 603
4599 ^2- 437 * 48400 =1,leftcnt= 602
4607 ^2- 188 * 112896 =1,leftcnt= 601
4607 ^2- 423 * 50176 =1,leftcnt= 601
4607 ^2- 752 * 28224 =1,leftcnt= 601
4625 ^2- 514 * 41616 =1,leftcnt= 598
4801 ^2- 294 * 78400 =1,leftcnt= 597
4801 ^2- 384 * 60025 =1,leftcnt= 597
4999 ^2- 204 * 122500 =1,leftcnt= 595
4999 ^2- 816 * 30625 =1,leftcnt= 595
5201 ^2- 234 * 115600 =1,leftcnt= 593
5201 ^2- 416 * 65025 =1,leftcnt= 593
5201 ^2- 936 * 28900 =1,leftcnt= 593
5291 ^2- 270 * 103684 =1,leftcnt= 590
5777 ^2- 642 * 51984 =1,leftcnt= 589
5781 ^2- 590 * 56644 =1,leftcnt= 588
5930 ^2- 659 * 53361 =1,leftcnt= 587
6049 ^2- 525 * 69696 =1,leftcnt= 586
6349 ^2- 762 * 52900 =1,leftcnt= 585
6499 ^2- 130 * 324900 =1,leftcnt= 584
6499 ^2- 520 * 81225 =1,leftcnt= 584
6626 ^2- 795 * 55225 =1,leftcnt= 582
6761 ^2- 345 * 132496 =1,leftcnt= 581
7226 ^2- 803 * 65025 =1,leftcnt= 580
7397 ^2- 822 * 66564 =1,leftcnt= 579
7501 ^2- 186 * 302500 =1,leftcnt= 578
7501 ^2- 744 * 75625 =1,leftcnt= 578
7743 ^2- 158 * 379456 =1,leftcnt= 576
7743 ^2- 632 * 94864 =1,leftcnt= 576
7775 ^2- 69 * 876096 =1,leftcnt= 574
7775 ^2- 276 * 219024 =1,leftcnt= 574
7775 ^2- 621 * 97344 =1,leftcnt= 574
7937 ^2- 558 * 112896 =1,leftcnt= 571
8380 ^2- 551 * 127449 =1,leftcnt= 570
8749 ^2- 378 * 202500 =1,leftcnt= 569
8837 ^2- 982 * 79524 =1,leftcnt= 568
9249 ^2- 185 * 462400 =1,leftcnt= 567
9249 ^2- 740 * 115600 =1,leftcnt= 567
9801 ^2- 29 * 3312400 =1,leftcnt= 565
9801 ^2- 116 * 828100 =1,leftcnt= 565
9801 ^2- 464 * 207025 =1,leftcnt= 565
9801 ^2- 725 * 132496 =1,leftcnt= 565
10093 ^2- 618 * 164836 =1,leftcnt= 561
10405 ^2- 86 * 1258884 =1,leftcnt= 560
10405 ^2- 344 * 314721 =1,leftcnt= 560
10405 ^2- 774 * 139876 =1,leftcnt= 560
10610 ^2- 131 * 859329 =1,leftcnt= 557
10951 ^2- 876 * 136900 =1,leftcnt= 556
11551 ^2- 924 * 144400 =1,leftcnt= 555
11663 ^2- 238 * 571536 =1,leftcnt= 554
11663 ^2- 952 * 142884 =1,leftcnt= 554
11775 ^2- 161 * 861184 =1,leftcnt= 552
11775 ^2- 644 * 215296 =1,leftcnt= 552
12151 ^2- 93 * 1587600 =1,leftcnt= 550
12151 ^2- 372 * 396900 =1,leftcnt= 550
12151 ^2- 837 * 176400 =1,leftcnt= 550
12799 ^2- 316 * 518400 =1,leftcnt= 547
13447 ^2- 332 * 544644 =1,leftcnt= 546
13449 ^2- 269 * 672400 =1,leftcnt= 545
13719 ^2- 665 * 283024 =1,leftcnt= 544
14849 ^2- 957 * 230400 =1,leftcnt= 543
15124 ^2- 375 * 609961 =1,leftcnt= 542
15871 ^2- 465 * 541696 =1,leftcnt= 541
16855 ^2- 129 * 2202256 =1,leftcnt= 540
16855 ^2- 516 * 550564 =1,leftcnt= 540
17151 ^2- 938 * 313600 =1,leftcnt= 538
17299 ^2- 346 * 864900 =1,leftcnt= 537
17406 ^2- 515 * 588289 =1,leftcnt= 536
18514 ^2- 595 * 576081 =1,leftcnt= 535
18768 ^2- 383 * 919681 =1,leftcnt= 534
18817 ^2- 768 * 461041 =1,leftcnt= 533
19601 ^2- 162 * 2371600 =1,leftcnt= 532
19601 ^2- 242 * 1587600 =1,leftcnt= 532
19601 ^2- 450 * 853776 =1,leftcnt= 532
19601 ^2- 648 * 592900 =1,leftcnt= 532
19601 ^2- 800 * 480249 =1,leftcnt= 532
19601 ^2- 882 * 435600 =1,leftcnt= 532
19601 ^2- 968 * 396900 =1,leftcnt= 532
19603 ^2- 58 * 6625476 =1,leftcnt= 525
19603 ^2- 232 * 1656369 =1,leftcnt= 525
19603 ^2- 522 * 736164 =1,leftcnt= 525
21295 ^2- 154 * 2944656 =1,leftcnt= 522
21295 ^2- 616 * 736164 =1,leftcnt= 522
22899 ^2- 458 * 1144900 =1,leftcnt= 520
24335 ^2- 46 * 12873744 =1,leftcnt= 519
24335 ^2- 184 * 3218436 =1,leftcnt= 519
24335 ^2- 414 * 1430416 =1,leftcnt= 519
24335 ^2- 736 * 804609 =1,leftcnt= 519
24648 ^2- 503 * 1207801 =1,leftcnt= 515
27379 ^2- 810 * 925444 =1,leftcnt= 514
27849 ^2- 557 * 1392400 =1,leftcnt= 513
28799 ^2- 476 * 1742400 =1,leftcnt= 512
29767 ^2- 492 * 1800964 =1,leftcnt= 511
31212 ^2- 767 * 1270129 =1,leftcnt= 510
33281 ^2- 585 * 1893376 =1,leftcnt= 509
33639 ^2- 695 * 1628176 =1,leftcnt= 508
33857 ^2- 418 * 2742336 =1,leftcnt= 507
34595 ^2- 706 * 1695204 =1,leftcnt= 506
34849 ^2- 697 * 1742400 =1,leftcnt= 505
39689 ^2- 205 * 7683984 =1,leftcnt= 504
39689 ^2- 820 * 1920996 =1,leftcnt= 504
40899 ^2- 818 * 2044900 =1,leftcnt= 502
42283 ^2- 638 * 2802276 =1,leftcnt= 501
42435 ^2- 866 * 2079364 =1,leftcnt= 500
46551 ^2- 209 * 10368400 =1,leftcnt= 499
46551 ^2- 836 * 2592100 =1,leftcnt= 499
48599 ^2- 297 * 7952400 =1,leftcnt= 497
48599 ^2- 825 * 2862864 =1,leftcnt= 497
48842 ^2- 67 * 35605089 =1,leftcnt= 495
48842 ^2- 603 * 3956121 =1,leftcnt= 495
49299 ^2- 986 * 2464900 =1,leftcnt= 493
49730 ^2- 411 * 6017209 =1,leftcnt= 492
51841 ^2- 245 * 10969344 =1,leftcnt= 491
51841 ^2- 980 * 2742336 =1,leftcnt= 491
52021 ^2- 190 * 14243076 =1,leftcnt= 489
52021 ^2- 760 * 3560769 =1,leftcnt= 489
56447 ^2- 668 * 4769856 =1,leftcnt= 487
57499 ^2- 966 * 3422500 =1,leftcnt= 486
57799 ^2- 76 * 43956900 =1,leftcnt= 485
57799 ^2- 304 * 10989225 =1,leftcnt= 485
57799 ^2- 475 * 7033104 =1,leftcnt= 485
57799 ^2- 684 * 4884100 =1,leftcnt= 485
58620 ^2- 671 * 5121169 =1,leftcnt= 481
59535 ^2- 206 * 17205904 =1,leftcnt= 480
59535 ^2- 824 * 4301476 =1,leftcnt= 480
62423 ^2- 177 * 22014864 =1,leftcnt= 478
62423 ^2- 708 * 5503716 =1,leftcnt= 478
62425 ^2- 351 * 11102224 =1,leftcnt= 476
66249 ^2- 53 * 82810000 =1,leftcnt= 475
66249 ^2- 212 * 20702500 =1,leftcnt= 475
66249 ^2- 848 * 5175625 =1,leftcnt= 475
68122 ^2- 563 * 8242641 =1,leftcnt= 472
70226 ^2- 243 * 20295025 =1,leftcnt= 471
70226 ^2- 867 * 5688225 =1,leftcnt= 471
73035 ^2- 494 * 10797796 =1,leftcnt= 469
75263 ^2- 933 * 6071296 =1,leftcnt= 468
75646 ^2- 715 * 8003241 =1,leftcnt= 467
77617 ^2- 352 * 17114769 =1,leftcnt= 466
79201 ^2- 704 * 8910225 =1,leftcnt= 465
80801 ^2- 909 * 7182400 =1,leftcnt= 464
85292 ^2- 247 * 29452329 =1,leftcnt= 463
88751 ^2- 426 * 18490000 =1,leftcnt= 462
88805 ^2- 246 * 32058244 =1,leftcnt= 461
88805 ^2- 984 * 8014561 =1,leftcnt= 461
95831 ^2- 385 * 23853456 =1,leftcnt= 459
97970 ^2- 339 * 28313041 =1,leftcnt= 458
100351 ^2- 892 * 11289600 =1,leftcnt= 457
102151 ^2- 908 * 11492100 =1,leftcnt= 456
106133 ^2- 942 * 11957764 =1,leftcnt= 455
111555 ^2- 386 * 32239684 =1,leftcnt= 454
113399 ^2- 413 * 31136400 =1,leftcnt= 453
114243 ^2- 338 * 38613796 =1,leftcnt= 452
118337 ^2- 978 * 14318656 =1,leftcnt= 451
119071 ^2- 540 * 26255376 =1,leftcnt= 450
120126 ^2- 875 * 16491721 =1,leftcnt= 449
122695 ^2- 939 * 16032016 =1,leftcnt= 448
126003 ^2- 218 * 72829156 =1,leftcnt= 447
126003 ^2- 872 * 18207289 =1,leftcnt= 447
137215 ^2- 469 * 40144896 =1,leftcnt= 445
139128 ^2- 263 * 73599241 =1,leftcnt= 444
143649 ^2- 425 * 48553024 =1,leftcnt= 443
145925 ^2- 134 * 158911236 =1,leftcnt= 442
145925 ^2- 536 * 39727809 =1,leftcnt= 442
146411 ^2- 830 * 25826724 =1,leftcnt= 440
156644 ^2- 815 * 30107169 =1,leftcnt= 439
165337 ^2- 687 * 39790864 =1,leftcnt= 438
165676 ^2- 591 * 46444225 =1,leftcnt= 437
179777 ^2- 498 * 64899136 =1,leftcnt= 436
193549 ^2- 474 * 79032100 =1,leftcnt= 435
194399 ^2- 213 * 177422400 =1,leftcnt= 434
194399 ^2- 852 * 44355600 =1,leftcnt= 434
202501 ^2- 950 * 43164900 =1,leftcnt= 432
213859 ^2- 370 * 123609924 =1,leftcnt= 431
227528 ^2- 103 * 502611561 =1,leftcnt= 430
227528 ^2- 927 * 55845729 =1,leftcnt= 430
228151 ^2- 237 * 219632400 =1,leftcnt= 428
228151 ^2- 948 * 54908100 =1,leftcnt= 428
236926 ^2- 611 * 91872225 =1,leftcnt= 426
237161 ^2- 705 * 79780624 =1,leftcnt= 425
246401 ^2- 693 * 87609600 =1,leftcnt= 424
258065 ^2- 354 * 188128656 =1,leftcnt= 423
275561 ^2- 945 * 80353296 =1,leftcnt= 422
284088 ^2- 983 * 82101721 =1,leftcnt= 421
285769 ^2- 85 * 960752016 =1,leftcnt= 420
285769 ^2- 340 * 240188004 =1,leftcnt= 420
285769 ^2- 765 * 106750224 =1,leftcnt= 420
306917 ^2- 118 * 798288516 =1,leftcnt= 417
306917 ^2- 472 * 199572129 =1,leftcnt= 417
332929 ^2- 985 * 112529664 =1,leftcnt= 415
360449 ^2- 979 * 132710400 =1,leftcnt= 414
392499 ^2- 314 * 490622500 =1,leftcnt= 413
469224 ^2- 887 * 248220025 =1,leftcnt= 412
470449 ^2- 864 * 256160025 =1,leftcnt= 411
499850 ^2- 459 * 544335561 =1,leftcnt= 410
500001 ^2- 89 * 2809000000 =1,leftcnt= 409
500001 ^2- 356 * 702250000 =1,leftcnt= 409
515095 ^2- 201 * 1320014224 =1,leftcnt= 407
515095 ^2- 804 * 330003556 =1,leftcnt= 407
522785 ^2- 561 * 487173184 =1,leftcnt= 405
561799 ^2- 236 * 1337364900 =1,leftcnt= 404
561799 ^2- 944 * 334341225 =1,leftcnt= 404
561835 ^2- 286 * 1103701284 =1,leftcnt= 402
605695 ^2- 609 * 602407936 =1,leftcnt= 401
641602 ^2- 347 * 1186320249 =1,leftcnt= 400
665857 ^2- 512 * 865948329 =1,leftcnt= 399
669337 ^2- 543 * 825068176 =1,leftcnt= 398
669878 ^2- 403 * 1113490161 =1,leftcnt= 397
714024 ^2- 743 * 686178025 =1,leftcnt= 396
842401 ^2- 832 * 852932025 =1,leftcnt= 395
847225 ^2- 259 * 2771390736 =1,leftcnt= 394
848719 ^2- 310 * 2323625616 =1,leftcnt= 393
900602 ^2- 827 * 980754489 =1,leftcnt= 392
903223 ^2- 973 * 838449936 =1,leftcnt= 391
907925 ^2- 366 * 2252261764 =1,leftcnt= 390
930249 ^2- 125 * 6922905616 =1,leftcnt= 389
930249 ^2- 500 * 1730726404 =1,leftcnt= 389
930249 ^2- 605 * 1430352400 =1,leftcnt= 389
954809 ^2- 355 * 2568056976 =1,leftcnt= 386
1024001 ^2- 645 * 1625702400 =1,leftcnt= 385
1039681 ^2- 490 * 2205993024 =1,leftcnt= 384
1039681 ^2- 640 * 1688963409 =1,leftcnt= 384
1098305 ^2- 594 * 2030764096 =1,leftcnt= 382
1159172 ^2- 703 * 1911350961 =1,leftcnt= 381
1197901 ^2- 682 * 2104056900 =1,leftcnt= 380
1201887 ^2- 497 * 2906503744 =1,leftcnt= 379
1204353 ^2- 113 * 12835983616 =1,leftcnt= 378
1204353 ^2- 452 * 3208995904 =1,leftcnt= 378
1280001 ^2- 761 * 2152960000 =1,leftcnt= 376
1294299 ^2- 854 * 1961604100 =1,leftcnt= 375
1524095 ^2- 429 * 5414605056 =1,leftcnt= 374
1555849 ^2- 925 * 2616936336 =1,leftcnt= 373
1574351 ^2- 598 * 4144784400 =1,leftcnt= 372
1618804 ^2- 535 * 4898180169 =1,leftcnt= 371
1625626 ^2- 467 * 5658800625 =1,leftcnt= 370
1653751 ^2- 453 * 6037290000 =1,leftcnt= 369
1850887 ^2- 428 * 8004165156 =1,leftcnt= 368
1907162 ^2- 587 * 6196366089 =1,leftcnt= 367
2024999 ^2- 295 * 13900410000 =1,leftcnt= 366
2143295 ^2- 94 * 48869292096 =1,leftcnt= 365
2143295 ^2- 376 * 12217323024 =1,leftcnt= 365
2143295 ^2- 846 * 5429921344 =1,leftcnt= 365
2271050 ^2- 699 * 7378638201 =1,leftcnt= 362
2281249 ^2- 73 * 71289000000 =1,leftcnt= 361
2281249 ^2- 292 * 17822250000 =1,leftcnt= 361
2281249 ^2- 657 * 7921000000 =1,leftcnt= 361
2376415 ^2- 329 * 17165192256 =1,leftcnt= 358
2499849 ^2- 173 * 36122803600 =1,leftcnt= 357
2499849 ^2- 692 * 9030700900 =1,leftcnt= 357
2535751 ^2- 460 * 13978332900 =1,leftcnt= 355
2550251 ^2- 750 * 8671706884 =1,leftcnt= 354
2588599 ^2- 133 * 50382291600 =1,leftcnt= 353
2588599 ^2- 532 * 12595572900 =1,leftcnt= 353
2862251 ^2- 430 * 19052280900 =1,leftcnt= 351
2989440 ^2- 479 * 18657101281 =1,leftcnt= 350
3034565 ^2- 934 * 9859298436 =1,leftcnt= 349
3287049 ^2- 389 * 27775555600 =1,leftcnt= 348
3505951 ^2- 636 * 19326560400 =1,leftcnt= 347
3674890 ^2- 251 * 53804049849 =1,leftcnt= 346
3678725 ^2- 534 * 25342729636 =1,leftcnt= 345
3844063 ^2- 217 * 68095946304 =1,leftcnt= 344
3844063 ^2- 868 * 17023986576 =1,leftcnt= 344
3959299 ^2- 274 * 57211856100 =1,leftcnt= 342
4120901 ^2- 918 * 18498720100 =1,leftcnt= 341
4190210 ^2- 179 * 98088602481 =1,leftcnt= 340
4276623 ^2- 302 * 60561272464 =1,leftcnt= 339
4293183 ^2- 542 * 34006310464 =1,leftcnt= 338
4620799 ^2- 124 * 172191801600 =1,leftcnt= 337
4620799 ^2- 496 * 43047950400 =1,leftcnt= 337
4620799 ^2- 775 * 27550688256 =1,leftcnt= 337
4730624 ^2- 127 * 176211050625 =1,leftcnt= 334
4954951 ^2- 364 * 67449284100 =1,leftcnt= 333
5286367 ^2- 713 * 39194496576 =1,leftcnt= 332
5658247 ^2- 748 * 42801816996 =1,leftcnt= 331
5791211 ^2- 670 * 50056902756 =1,leftcnt= 330
5848201 ^2- 229 * 149351331600 =1,leftcnt= 329
5848201 ^2- 916 * 37337832900 =1,leftcnt= 329
6083073 ^2- 137 * 270100562944 =1,leftcnt= 327
6083073 ^2- 548 * 67525140736 =1,leftcnt= 327
6166395 ^2- 806 * 47176708804 =1,leftcnt= 325
6195120 ^2- 239 * 160583731441 =1,leftcnt= 324
6998399 ^2- 717 * 68309049600 =1,leftcnt= 323
7022501 ^2- 422 * 116861422500 =1,leftcnt= 322
7338680 ^2- 391 * 137739703689 =1,leftcnt= 321
7352695 ^2- 741 * 72958331664 =1,leftcnt= 320
7838695 ^2- 471 * 130456771344 =1,leftcnt= 319
8193151 ^2- 700 * 95896747584 =1,leftcnt= 318
8193151 ^2- 847 * 79253510400 =1,leftcnt= 318
8396801 ^2- 369 * 191073894400 =1,leftcnt= 316
8418574 ^2- 851 * 83281302225 =1,leftcnt= 315
8429543 ^2- 583 * 121881981456 =1,leftcnt= 314
8553815 ^2- 249 * 293846389776 =1,leftcnt= 313
8553815 ^2- 996 * 73461597444 =1,leftcnt= 313
8835999 ^2- 995 * 78467214400 =1,leftcnt= 311
8915765 ^2- 654 * 121545665956 =1,leftcnt= 310
8994000 ^2- 191 * 423518513089 =1,leftcnt= 309
9314703 ^2- 878 * 98819694736 =1,leftcnt= 308
9478657 ^2- 833 * 107857069056 =1,leftcnt= 307
9799705 ^2- 831 * 115564642704 =1,leftcnt= 306
10394175 ^2- 734 * 147191926336 =1,leftcnt= 305
10626551 ^2- 341 * 331154211600 =1,leftcnt= 304
11785490 ^2- 779 * 178302663081 =1,leftcnt= 303
12320649 ^2- 293 * 518083248400 =1,leftcnt= 302
12769001 ^2- 745 * 218855552400 =1,leftcnt= 301
12901780 ^2- 319 * 521805414321 =1,leftcnt= 300
13588951 ^2- 969 * 190567171600 =1,leftcnt= 299
13771351 ^2- 513 * 369688320400 =1,leftcnt= 298
14851876 ^2- 519 * 425006205625 =1,leftcnt= 297
16883880 ^2- 311 * 916609015609 =1,leftcnt= 296
18412804 ^2- 415 * 816943014801 =1,leftcnt= 295
19731763 ^2- 202 * 1927437975684 =1,leftcnt= 294
19731763 ^2- 808 * 481859493921 =1,leftcnt= 294
22619537 ^2- 722 * 708647443344 =1,leftcnt= 292
23915529 ^2- 365 * 1566993225616 =1,leftcnt= 291
24220799 ^2- 284 * 2065658817600 =1,leftcnt= 290
24220799 ^2- 639 * 918070585600 =1,leftcnt= 290
24248647 ^2- 172 * 3418586519364 =1,leftcnt= 288
24248647 ^2- 688 * 854646629841 =1,leftcnt= 288
27365201 ^2- 666 * 1124405744400 =1,leftcnt= 286
30580901 ^2- 550 * 1700348192676 =1,leftcnt= 285
32080051 ^2- 106 * 9708770492100 =1,leftcnt= 284
32080051 ^2- 424 * 2427192623025 =1,leftcnt= 284
32080051 ^2- 954 * 1078752276900 =1,leftcnt= 284
^CTraceback (most recent call last):
  File "./p066.py", line 13, in <module>
    if x**2 - 1 > 0 and (x**2-1)%d == 0 and (x**2-1)//d in Q:
KeyboardInterrupt
^C
real	135m43.883s
user	133m30.473s
sys	0m20.102s
"""
```

我给它掐断了,跑了两小时，虽然是单核的，但是还有284个数

## go并行 每个数各算各的 

值过大需要big/int

写了一个可分段，可并行，可"断点"计算的

第一遍把1到1000直接跑，每次找到值都会输出剩余表

没统计计算时间，反正很久，每次运算的结果可以去替换slowv和ans

```go
package main

// x*x-d*y*y=1
// 如果d包含质因子p
// x*x mod p = 1
// 所以 x mod p = 1 or p-1
//

import (
  "fmt"
  "math/big"
  "sync"
)

type Xd struct {
  X big.Int
  d int
}

var prime [1010]bool

const offset = 0
const VCNT = 1000

var slowv = []int{739, 367, 547, 835, 457, 797, 766, 508, 931, 166, 937, 556, 989, 517, 926, 554, 834, 253, 796, 331, 976, 953, 883, 394, 977, 511, 199, 449, 661, 919, 571, 581, 814, 271, 805, 862, 277, 526, 653, 981, 664, 829, 749, 382, 956, 821, 412, 913, 596, 911, 871, 268, 941, 859, 967, 809, 214, 317, 298, 622, 974, 565, 997, 607, 649, 991, 751, 823, 358, 487, 679, 921, 501, 716, 826, 929, 853, 478, 586, 863, 309, 947, 569, 946, 778, 849, 481, 157, 553, 673, 301, 681, 244, 509, 523, 865, 754, 844, 433, 773, 634, 869, 753, 643, 669, 589, 790, 721, 614, 857, 685, 334, 521, 149, 709, 856, 694, 491, 971, 789, 549, 281, 757, 893, 907, 964, 313, 746, 454, 724, 463, 617, 109, 886, 337, 477, 489, 922, 637, 641, 877, 597, 211, 881, 409, 493, 631, 593, 599, 397, 889, 838, 610, 970, 801, 949, 628, 928, 436, 181, 719, 811, 613, 538, 604, 421, 958, 619, 972, 379, 772, 241, 769, 541, 193, 686, 601, 691, 764, 988, 652, 353, 461, 61, 787, 718,}

// 判断是否平方数 返回 {开根,true}或者{0,false}
func getSqrt(x *big.Int) (*big.Int, bool) {
  xsqrt := big.NewInt(0).Sqrt(x)
  var xx big.Int
  xx.Mul(xsqrt, xsqrt)
  if xx.Cmp(x) == 0 {
    return xsqrt, true
  }
  return big.NewInt(0), false
}

// 对每个d尝试
func findx(d int, ch chan Xd) {
  if _, ok := getSqrt(big.NewInt(int64(d))); ok {
    ch <- Xd{*big.NewInt(0), d}
    return
  }
  // d的最大质因子
  maxp := 1
  for i := 2; i <= d; i++ {
    if prime[i] {
      continue
    }
    if d%i == 0 && i > maxp {
      maxp = i
    }
  }

  for i := big.NewInt(1); ; i.Add(i, big.NewInt(1)) {
    imaxp := big.NewInt(0).Mul(i, big.NewInt(int64(maxp)))
    sub1 := big.NewInt(0).Sub(imaxp, big.NewInt(1))
    add1 := big.NewInt(0).Add(imaxp, big.NewInt(1))
    for _, x := range []*big.Int{sub1, add1} {
      // x^2-1
      x2s1 := big.NewInt(0).Sub(big.NewInt(0).Mul(x, x), big.NewInt(1))
      x2s1mod := big.NewInt(0).Mod(x2s1, big.NewInt(int64(d)))
      if x2s1mod.Cmp(big.NewInt(0)) != 0 {
        continue
      }
      x2s1div := big.NewInt(0).div(x2s1, big.NewInt(int64(d)))
      if _, ok := getSqrt(x2s1div); ok {
        ch <- Xd{*x, d}
        return
      }
    }
  }
}
// 结果处理
func waitAns(ch chan Xd, ans *Xd, wg *sync.WaitGroup) {
  s := make(map[int]int)
  for _,v := range slowv{
    s[v]=1
  }
  cnt := 0
  for v := range ch {
    cnt++
    delete(s,v.d)
    fmt.Println(s)
    if v.X.Cmp(&ans.X) == 1 {
      *ans = v
      fmt.Println("new",*ans, cnt)
    }
    wg.done()
  }
}

func main() {
  for i := 2; i < 100; i++ {
    if prime[i] {
      continue
    }
    for j := i * i; j <= 1000; j += i {
      prime[j] = true
    }
  }
  // 1828310451 794
  ans := Xd{*big.NewInt(3832352837), 502}
  var wg sync.WaitGroup
  ch := make(chan Xd)
  if len(slowv) == 0{
    // 第一遍的时候 lowv 为空 用这个代码
    for i := 1+offset; i <= VCNT+offset; i++ {
      slowv = append(slowv, i)
      wg.Add(1)
      go findx(i, ch)
    }
  }else{
    for _,v := range slowv{
      wg.Add(1)
      go findx(v,ch)
    }
  }

  go waitAns(ch, &ans, &wg)
  wg.Wait()
  fmt.Println(ans)
}
```

# 题解

## pell方程的解

### 解的性质

如果$x^2-d \cdot y^2=1$ 平方得 $x^4+d^2 \cdot y^4-2dx^2y^2=1$

$x^4+2dx^2y^2+d^2 \cdot y^4-d \cdot 4x^2y^2=1$

$(x^2+dy^2) - d \cdot (2xy)^2=1$

也可得$(x+\sqrt{d} \cdot y)\cdot (x-\sqrt{d} \cdot y)=1$

也可得$((x+\sqrt{d} \cdot y)\cdot (x-\sqrt{d} \cdot y))^n=1$

$(x+\sqrt{d} \cdot y)^n\cdot (x-\sqrt{d} \cdot y)^n=1$

根据二项式展开有

若 $(x+\sqrt{d} \cdot y)^n = A + B\cdot{d}$

则 $(x-\sqrt{d} \cdot y)^n = A - B\cdot{d}$ 即是 $A^2-d \cdot B^2=1$

也就是它的n次方展开的系数也是一组解

> 同样假设是两组(x1,y1)和(x2,y2)的解，它们也可以合成一组解

**下面证明所有解都是最小解生成的**

设$x_1,y_1$为最小解,$x_k,y_k$不是由最小解生成的一个解

则存在一个整数n

$(x_1+y_1 \cdot \sqrt{d})^n < (x_k+y_k \cdot \sqrt{d}) < (x_1+y_1 \cdot \sqrt{d})^{n+1} $

同时乘$(x_1-y_1 \cdot \sqrt{d})^n$有

$1 < (x_k+y_k \cdot \sqrt{d}) \cdot (x_1-y_1 \cdot \sqrt{d})^n < (x_1+y_1 \cdot \sqrt{d}) $

注意到中间的表达式 也是满足参数形式的 也是一组解

这与最小解定义冲突，所以所有解都是最小解生成的

### 解的存在性证明

存在无穷多对整数(x,y)满足 $|x-y\sqrt{d}|<\frac 1y$

取正整数$q_0$

取$t=0,1,...,q_0$ 共计$q_0+1$个

把区间$[0,1)$等分为$q_0$部分，则每部分长度为$\frac 1{q_0}$,考虑 $t \sqrt{d}$的小数部分，必定有两个落在同一区间 所以存在$0<=i<j<=q_0$使得 $| t_i \sqrt{d} - t_j \sqrt{d} |$ 的小数部分 $<\frac 1{q_0}$

即$|x-(t_j-t_i)\sqrt{d}| < \frac 1{q_0} < \frac 1{t_j-t_i}$


得到一个解

取$\frac 1{q_1} < |x-(t_j-t_i)\sqrt{d}|$

可以得到新的解，反复如此可生成无个解

---

0 < $\left|x^2-dy^2\right|=\left|x+y\sqrt{d}\right|\cdot\left|x-y\sqrt{d}\right|=\left|x-y\sqrt{d}+2y\sqrt{d}\right|\cdot\left|x-y\sqrt{d}\right|<=(\left|x-y\sqrt{d}\right|+\left|2y\sqrt{d}\right|)\cdot\left|x-y\sqrt{d}\right|<\left(2y\sqrt{d}+\frac{1}{y}\right)\cdot\frac{1}{y}\le 2\sqrt{d}+\frac 1{y^2}$

说明这无限个(x,y)的取值的计算结果是有限范围内的

再一次根据抽屉原理，存在正整数k,使得$|x^2-dy^2|=k$的解有无限个

考虑这些解$(x \bmod k,y \bmod k)$ , 可以的方案数$<=k^2$,也是有限的，

再根据抽屉原理，存在$i \neq j ,s.t. (x_i \bmod k, y_i \bmod k) = (x_j \bmod k, y_j \bmod k)  $

取 $X=|\frac{x_1x_2-y_1y_2d}{k}|,Y=|\frac{x_2y_1-x_1y_2}{k}|$

有 $X^2-d \cdot Y^2 = \frac{(x_1^2-d \cdot y_1^2)(x_2^2-d \cdot y_2^2)}{k^2} = 1$

显然 X 不为0

因为 $(x_1x_2-y_1y_2d)\bmod k = (x_1x_1-y_1y_1d)\bmod k = k \bmod k = 0$,所以X为整数，所以X为正整数

因为 $(x_2y_1-x_1y_2)\bmod k = (x_1y_1-x_1y_1) \bmod k = 0 \bmod k = 0$,所以Y是整数(x_1^2-d \cdot y_1^2)

注意到 $x^2-dy^2$ 的取值范围为 $\pm k$,因此存在$(x_i,y_i)\neq(x_j,y_j)$使得 $x_i^2-dy_i^2=x_j^2-dy_j^2$ 这时 $\frac{x_i}{y_i} \neq \frac{x_j}{y_j}$, 即Y不为0

综上，一定存在解

## 连分数

### 定义

$x = a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \cfrac{1}{\ddots\,}}}} $


例如 

$ \sqrt{2} = 1 + \frac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \ddots}}}}}} $

展开的剩余部分是在`[0,1)`之间

### 性质

所有无限连分数都是无理数。

证明：如果一个数是有理数，把它写成分数的形式，再按照连分数的方式展开，你会发现这过程就是辗转相除，分子分母单调递减 所以一定有限，它的逆否命题就是要证明的性质

### 递推序列

假设h,k分别为渐进分数的分子分母

$\begin{bmatrix} h_n & k_n \end{bmatrix} = \begin{bmatrix} 1 & 0 \end{bmatrix} \cdot \begin{bmatrix} a_n & 1 \\\ 1 & 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} & 1 \\\ 1 & 0 \end{bmatrix}  \cdot \begin{bmatrix} a_0 & 1 \\\ 1 & 0 \end{bmatrix} $

然而这不好建立递推关系,稍做变形

$\begin{bmatrix} h_n & k_n \\\ ? & ? \end{bmatrix} = \begin{bmatrix} 1 & 0 \\\ 0 & 1 \end{bmatrix} \cdot \begin{bmatrix} a_n & 1 \\\ 1 & 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} & 1 \\\ 1 & 0 \end{bmatrix}  \cdot \begin{bmatrix} a_0 & 1 \\\ 1 & 0 \end{bmatrix} $

$\begin{bmatrix} h_n & k_n \\\ ? & ? \end{bmatrix} = \begin{bmatrix} a_n & 1 \\\ 1 & 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} & 1 \\\ 1 & 0 \end{bmatrix}  \cdot \begin{bmatrix} a_0 & 1 \\\ 1 & 0 \end{bmatrix} $

$\begin{bmatrix} h_n & k_n \\\ ? & ? \end{bmatrix} = \begin{bmatrix} a_n & 1 \\\ 1 & 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} & k_{n-1} \\\ ? & ? \end{bmatrix} $

显然左式的底部可以确定

$\begin{bmatrix} h_n & k_n \\\ h_{n-1} & k_{n-1} \end{bmatrix} = \begin{bmatrix} a_n & 1 \\\ 1 & 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} & k_{n-1} \\\ ? & ? \end{bmatrix} $

又因为递推关系，右边式子相当于左式带入n-1

$\begin{bmatrix} h_n & k_n \\\ h_{n-1} & k_{n-1} \end{bmatrix} = \begin{bmatrix} a_n & 1 \\\ 1 & 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} & k_{n-1} \\\ h_{n-2} & k_{n-2} \end{bmatrix} $

综上

$h_n = a_n \cdot h_{n-1} + h_{n-2}$
$k_n = a_n \cdot k_{n-1} + k_{n-2}$

且根据计算过程，可知 h,k互质

---

由上面的递推关系再递推有

$k_nh_{n-1}-k_{n-1}h_n=k_{n-1}h_{n-2}-k_{n-2}h_{n-1}=(-1)^n $, 

$k_nh_{n-2}-k_{n-2}h_n=a_n(k_{n-1}h_{n-2}-k_{n-2}h_{n-1})=a_n(-1)^{n-1} $, 

设$\sqrt d$的精确表示为$[a_0,a_1,...,a_n,\beta_{n+1}]$,即是最后$a_{n+1}$替换为精确的非整数值$\beta_{n+1}$的有$1<=a_{n+1}<\beta_{n+1},(n>=1)$

---

根据递推式有

$\sqrt d-\frac{h_n}{k_n} =\frac{\beta_{n+1}h_n+h_{n-1}}{\beta_{n+1}k_n+k_{n-1}} -\frac{h_n}{k_n} $

$=\frac{h_{n-1}k_{n}-h_nk_{n-1}}{k_n(\beta_{n+1}k_n+k_{n-1})}$

$=\frac{(-1)^n}{k_n(\beta_{n+1}k_n+k_{n-1})}$

$|\sqrt d-\frac{h_n}{k_n}| =\frac{1}{k_n(\beta_{n+1}k_n+k_{n-1})} < \frac{1}{k_n(a_{n+1}k_n+k_{n-1})} = \frac{1}{k_nk_{n+1}}$

---

$|k_n\sqrt d - h_n|$单调递减,证明:

$|k_n\sqrt d - h_n| - |k_{n-1}\sqrt d - h_{n-1}|$

$ = |k_n(\sqrt d - \frac{h_n}{k_n})| - |k_{n-1}(\sqrt d - \frac{h_{n-1}}{k_{n-1}}|)$

$ = \frac 1{\beta_{n+1}k_n+k_{n-1}} - \frac 1{\beta_{n}k_{n-1}+k_{n-2}} $

$ = \frac {(\beta_{n}k_{n-1}+k_{n-2})-(\beta_{n+1}k_n+k_{n-1})}{(\beta_{n+1}k_n+k_{n-1})(\beta_{n}k_{n-1}+k_{n-2})}$

$ = \frac {((a_n+\frac 1{\beta_{n+1}})k_{n-1}+k_{n-2})-(\beta_{n+1}k_n+k_{n-1})}{(\beta_{n+1}k_n+k_{n-1})(\beta_{n}k_{n-1}+k_{n-2})}$

$ = \frac {(\beta_{n+1}(a_nk_{n-1}+k_{n-2})+k_{n-1})-\beta_{n+1}(\beta_{n+1}k_n+k_{n-1})}{\beta_{n+1}(\beta_{n+1}k_n+k_{n-1})(\beta_{n}k_{n-1}+k_{n-2})}$

$ = \frac {(\beta_{n+1}k_n+k_{n-1})-\beta_{n+1}(\beta_{n+1}k_n+k_{n-1})}{\beta_{n+1}(\beta_{n+1}k_n+k_{n-1})(\beta_{n}k_{n-1}+k_{n-2})}$


$ = \frac {(1-\beta_{n+1})(\beta_{n+1}k_n+k_{n-1})}{\beta_{n+1}(\beta_{n+1}k_n+k_{n-1})(\beta_{n}k_{n-1}+k_{n-2})} < 0$

由此也可知$|\sqrt d-\frac{h_n}{k_n}|$单调递减

---

$|\sqrt d-\frac{h_n}{k_n}|-|\sqrt d-\frac{h_{n-1}}{k_{n-1}}|$

$=\frac {|{k_n}\sqrt d-{h_n}|-\frac {k_n}{k_{n-1}}|{k_{n-1}}\sqrt d-{h_{n-1}}|}{k_n}$

$<\frac {|{k_n}\sqrt d-{h_n}|-|{k_{n-1}}\sqrt d-{h_{n-1}}|}{k_n} < 0$

---

若$(h_n,k_n)$是一个渐进分数，则对于分母$k_n$,分子取$h_n$时，整个分数最接近原无理数

取任意$h\neq h_n$,根据三角不等式

$|\sqrt d -\frac{h}{k_n}| \geq |\frac{h-h_n}{k_n}| - |\sqrt d - \frac{h_n}{k_n}|$

$>\frac 1{k_n} - \frac 1{k_nk_{n+1}} $,因为 $k_{n+1}>=3$

$> \frac 1{k_n} - \frac 1{2k_n} $

$=\frac 1{2k_n} $

$>|\sqrt d -\frac{h_n}{k_n}|$

证明了$h_n$是最接近的分子

也得到 $|k_n\sqrt d-h|$在 $h=h_n$时取最小值

---

下面证明任何$(h,k),(0<k<k_n)$，有$|k_n\sqrt d h_n|$为最小值

考虑任意$(h,k),(0<k<k_n)$，且$\frac hk$的最简分数不是渐进数，（因为已经证明了渐进数随着n增大$|k\sqrt d - h|$单调递减）

设二元一次方程组

$h_nx+h_{n-1}y=h$

$k_nx+k_{n-1}y=k$

则有$(x,y)=(\frac {hk_{n-1}-kh_{n-1}}{h_nk_{n-1}-h_{n-1}k_n},\frac {hk_{n}-kh_{n}}{h_nk_{n-1}-h_{n-1}k_n}) = ((-1)^{n-1}(hk_{n-1}-kh_{n-1}),(-1)^{n-1}(hk_{n}-kh_{n}))$

因为$\frac hk$不是渐进分数，所以$x,y$都是非零整数，又因为$k<k_n$和$k_nx+k_{n-1}y=k$有，x,y异号

因为$\sqrt d - \frac {h_n}{k_n}$的分子为$(-1)^n$,因此$\sqrt d - \frac {h_n}{k_n}$和$\sqrt d - \frac {h_{n-1}}{k_{n-1}}$异号

因此$k_n\sqrt d - {h_n}$和$k_{n-1}\sqrt d - {h_{n-1}}$异号

因此$x(k_n\sqrt d - {h_n})$和$y(k_{n-1}\sqrt d - {h_{n-1}})$同号

$|k\sqrt d -h| = |(k_nx+k_{n-1}y)\sqrt d - (h_nx+h_{n-1}y)|$

$= |x(k_n\sqrt d - {h_n}) + y(k_{n-1}\sqrt d - {h_{n-1}})|$,因为同号：

$= |x(k_n\sqrt d - {h_n})|+|y(k_{n-1}\sqrt d - {h_{n-1}})|$，因为x,y非零:

$|k\sqrt d -h| > |k_n\sqrt d - {h_n}|$且$|k\sqrt d -h|>|k_{n-1}\sqrt d - {h_{n-1}}|$

---

1. 连续的两个渐进数中至少有一个满足，$|\sqrt d - \frac hk|<\frac 1{2k^2}$

2. 任何最简分数如果满足$|\sqrt d - \frac hk|<\frac 1{2k^2}$，那么它是个渐进分数

假设都不满足，有

$0 \leq |\sqrt d-\frac{h_{n+1}}{k_{n+1}}| - \frac{1}{2k_{n+1}^2} + |\sqrt d-\frac{h_{n}}{k_{n}}|-\frac{1}{2k_{n}^2}$, 因为$\sqrt d - \frac{h_{n}}{k_{n}}$正负交替,所以

$ = |\frac{h_{n+1}}{k_{n+1}}-\frac{h_{n}}{k_{n}}|-\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$

$ = |\frac{h_{n+1}k_{n}-h_{n}k_{n+1}}{k_{n+1}k_{n}}|-\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$

$ = \frac 1{k_nk_{n+1}} -\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$

$ = \frac 1{k_nk_{n+1}} -\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$

$ = \frac {-(k_n-k_{n+1})^2}{2k_{n}^2k_{n+1}^2}$

矛盾

因此至少有一个大于满足，1得证

设$\frac hk$满足不等式$|\sqrt d - \frac hk|<\frac 1{2k^2}$，则存在n使得渐进数分母满足 $k_{n+2}>k>=k_n $且$\frac {h_n}{k_n}$满足$|\sqrt d - \frac hk|<\frac 1{2k^2}$(因为相邻渐进数必有一个满足)，根据上面的不等式 有$|k_n\sqrt d- h_n| < |k\sqrt d - h\|$，设$\frac hk \neq \frac{h_n}{k_n}$

$0 \leq \frac{|hk_n-h_nk|-1}{kk_n}$

$= |\frac{h}{k}-\frac{h_n}{k_n}|-\frac{1}{kk_n}$,因为三角不等式，有

$\leq |\sqrt d -\frac{h}{k}|+|\sqrt d -\frac{h_n}{k_n}|-\frac{1}{kk_n}$, 因为假设满足的不等式

$< \frac 1{2k^2} + \frac 1{k_n}|k_n\sqrt d - h_n|-\frac{1}{kk_n}$,因为上面的最小接近

$< \frac 1{2k^2} + \frac 1{k_n}|k\sqrt d - h|-\frac{1}{kk_n}$

$= \frac 1{2k^2} + \frac {k}{k_n}|\sqrt d - \frac hk|-\frac{1}{kk_n}$因为假设满足的不等式

$< \frac 1{2k^2} + \frac {k}{k_n}\cdot \frac 1{2k^2}-\frac{1}{kk_n}$

$= \frac {k_n-k}{2k^2k_n}$

矛盾，因此$\frac hk$和某个渐进数相等(**一定直接是吗上面假设了比例?**)

# Lagrange’s Theorem

quadratic irrational : 二次整式多项式的根 $\frac{-b\pm \sqrt{b^2-4ac}}{2a}$

或者二次无理数 形如$\frac{P+\sqrt{D}}{Q}$

 An irrational number is quadratic irrational if and only if its continued fraction is periodic.

先证明简单的一侧，循环连分数一定是二次根式的根，按照连分数的写法，直接将第二个循环节及以后的部分换为原无理数，则把连分数部分通分，根据计算过程，最后一定是一个二次根式$x=\frac{ax+b}{cx+d}$。所以连分数一定为其中一个解

# Galois' Theorem

Definition 1.24. Let α be a quadratic irrational and β be its conjugate. Then, α
is reduced if α > 1 and -1 < β < 0.????????





# 代码

# 参考

[Continued fraction](https://en.wikipedia.org/wiki/Continued_fraction)

[Pell equation](https://en.wikipedia.org/wiki/Pell%27s_equation)

[Yang.pdf](https://www.math.uchicago.edu/~may/VIGRE/VIGRE2008/REUPapers/Yang.pdf)

https://crypto.stanford.edu/pbc/notes/contfrac/pell.html



# 总结


多核没智力还是搞不动数学啊,
