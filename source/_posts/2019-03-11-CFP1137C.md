---
title: CF EDU 61 E
date: 2019-03-09 11:20:14
tags: 
category: [Codeforces]
---

# [题目HERE](https://codeforces.com/contest/1137/problem/C)

## 题目大意

n 个点 (`1<=n<=100000`)

m 条边 (`1<=m<=100000`)

有向图

从端点1出发，总共走d (`1<=d<=50`)天，每天能走一条边，能访问多少个不同的开放的点

开放时间表 `n*d`,0表示N号点 在D天关闭，1表示开放

# 解法

翻译自[官方题解](https://codeforces.com/blog/entry/65825)

新建一个图

图上的点为 `([1->n],[0->d-1])` O(nd)

如果原来题目图上有(u,v)

建立边 `(u,t) -> (v,(t+1)%d)` , O(m d d)

然后算 新图 的强连通分量，对每一个强连通分量缩点，计算 不同的开放的点的个数 = cost

在新的DAG上求最长路

假设一个点u 在新图中拆成 (u,j1)和(u,j2),也就是u 能通过某些边走到j1，注意到，新图里的边只和原图是否连通有关，所以 (u,j2) 能走到(u,(j2+(j2-j1))%d) 沿着`j1->j2`的路径，沿着这条路径走d-1次，那么走到`(u,(j2+(d-1)(j2-j1))%d) = (u,j1+d*(j2-j1)%d) = (u,j1)` 所以如果(u,j1)和(u,j2)弱连通，则它们强连通

在新的DAG(缩点后的)上 不会存在2个 u

在DAG有向无环图上 做dp

# 代码

待补
