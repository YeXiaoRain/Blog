---
title: Atcoder abc260
date: 2022-10-21
tags: []
category: [Atcoder,ABC]
description: Ex()
---

https://atcoder.jp/contests/abc260/tasks

# Ex - Colorfulness

n球, 颜色ci

f(球的一个排列) = 相邻不同色的个数

对于k=1..m分别求 $\sum(f(排列)^k)$ mod 998244353

## 范围

n 2.5e5

m 2.5e5

ci [1,n]

8s

1024mb

### 我的思路

k==1 时

那颜色可以分开考虑

一个颜色 去计算它能构成x个间隔, 那么它每个贡献 (x+1(两端))/2, 再乘上方案数

注意每个排列的最左和最右还要-1, 所以还要减 n!

---

k==2时

明显就不一样了, 因为贡献变成了 (相邻不同色)^2

颜色c 有 x间隔 ( (x+1) + 其它颜色间隔贡献 -1)^2

问题 其它颜色贡献会受到颜色c的间隔数x 影响

---

如果直接按照题目来, 按f(P)归类

如果能算出 不同为y个的 出现次数t(y)

那么 就是 f(1) = sum t(y) * y

f(2) = sum t(y) * y^2

这样做也是 需要O(n m) 的

<!--more-->

### 题解

也是先计算a[i] = 有多少个排列会有i个不同的相邻颜色

然后再基于a 计算 和

#### 计算排列出现次数






# 总结

这场现场过了A-F, 赛后超时过了G, 就Ex不会

Ex

# 参考

[官方题解](https://atcoder.jp/contests/abc260/editorial)

