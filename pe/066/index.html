<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/Blog/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/Blog/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/Blog/images/favicon-16x16.png">
  <link rel="mask-icon" href="/Blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/Blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"yexiaorain.github.io","root":"/Blog/","images":"/Blog/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"right","display":"hide","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":null,"activeClass":"disqus"},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/Blog/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/Blog/js/config.js"></script>

    <meta name="description" content="叹气从2020 02 09 挖的坑，中间很长一段时间鸽了，终于在05 29写完了. 题目https:&#x2F;&#x2F;projecteuler.net&#x2F;problem&#x3D;66 大意d &#x3D; 1-&gt;1000，d是非平方数 对于每个d 求最小的正整数x使得$x^2-dy^2&#x3D;1$，其中x,y都是正整数, 最后对所有这些x求最大的x 读懂本文你可能需要的前置知识抽屉原理 二元一次方程 绝对值 有">
<meta property="og:type" content="article">
<meta property="og:title" content="project euler 066 diophantine equation">
<meta property="og:url" content="https://yexiaorain.github.io/Blog/pe/066/index.html">
<meta property="og:site_name" content="YeXiaoRain Blog">
<meta property="og:description" content="叹气从2020 02 09 挖的坑，中间很长一段时间鸽了，终于在05 29写完了. 题目https:&#x2F;&#x2F;projecteuler.net&#x2F;problem&#x3D;66 大意d &#x3D; 1-&gt;1000，d是非平方数 对于每个d 求最小的正整数x使得$x^2-dy^2&#x3D;1$，其中x,y都是正整数, 最后对所有这些x求最大的x 读懂本文你可能需要的前置知识抽屉原理 二元一次方程 绝对值 有">
<meta property="og:locale" content="zh_TW">
<meta property="article:published_time" content="2020-05-29T02:37:14.000Z">
<meta property="article:modified_time" content="2023-05-28T14:26:27.157Z">
<meta property="article:author" content="Xiao Ye">
<meta property="article:tag" content="数学">
<meta name="twitter:card" content="&lt;twitter:card&gt;">


<link rel="canonical" href="https://yexiaorain.github.io/Blog/pe/066/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-TW","comments":true,"permalink":"https://yexiaorain.github.io/Blog/pe/066/","path":"pe/066/","title":"project euler 066 diophantine equation"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>project euler 066 diophantine equation | YeXiaoRain Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/Blog/css/noscript.css">
  </noscript>
<link rel="alternate" href="/Blog/atom.xml" title="YeXiaoRain Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/Blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">YeXiaoRain Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜尋" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/Blog/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li><li class="menu-item menu-item-archives"><a href="/Blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔<span class="badge">255</span></a></li><li class="menu-item menu-item-yearmonth"><a href="/Blog/yearmonth/" rel="section"><i class="fa fa-calendar-days fa-fw"></i>年月</a></li><li class="menu-item menu-item-categories"><a href="/Blog/categories/" rel="section"><i class="fa fa-shapes fa-fw"></i>分類<span class="badge">18</span></a></li><li class="menu-item menu-item-tags"><a href="/Blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤<span class="badge">248</span></a></li><li class="menu-item menu-item-rss"><a href="/Blog/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>rss</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%B9%E6%B0%94"><span class="nav-text">叹气</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-text">题目</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A4%A7%E6%84%8F"><span class="nav-text">大意</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AF%BB%E6%87%82%E6%9C%AC%E6%96%87%E4%BD%A0%E5%8F%AF%E8%83%BD%E9%9C%80%E8%A6%81%E7%9A%84%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="nav-text">读懂本文你可能需要的前置知识</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%87%AA%E9%97%AD%E5%B0%9D%E8%AF%95"><span class="nav-text">自闭尝试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E5%AD%A6%E6%8E%A8%E8%AE%BA"><span class="nav-text">一些自己的数学推论</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#python3%E5%86%99%E4%BA%86%E4%B8%AA-%E6%8C%89x%E9%80%92%E5%A2%9E%E6%90%9C%E7%B4%A2"><span class="nav-text">python3写了个 按x递增搜索</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#go%E5%B9%B6%E8%A1%8C-%E6%AF%8F%E4%B8%AA%E6%95%B0%E5%90%84%E7%AE%97%E5%90%84%E7%9A%84"><span class="nav-text">go并行 每个数各算各的</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-text">题解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#pell%E6%96%B9%E7%A8%8B%E7%9A%84%E8%A7%A3"><span class="nav-text">pell方程的解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E7%9A%84%E6%80%A7%E8%B4%A8-%E5%9F%BA%E7%A1%80%E8%A7%A3"><span class="nav-text">解的性质(基础解)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B9%B3%E6%96%B9%E4%B8%80%E4%B8%AA%E8%A7%A3%E7%9B%B8%E5%85%B3%E7%9A%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%83%BD%E5%BE%97%E5%88%B0%E6%96%B0%E7%9A%84%E8%A7%A3-%E5%A4%9A%E4%BD%99"><span class="nav-text">平方一个解相关的表达式能得到新的解(多余)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E8%A7%A3%E7%9B%B8%E5%85%B3%E7%9A%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E6%95%B4%E5%B9%82%E6%AC%A1%E8%83%BD%E5%BE%97%E5%88%B0%E6%96%B0%E7%9A%84%E8%A7%A3-%E5%A4%9A%E4%BD%99"><span class="nav-text">一个解相关的表达式的整幂次能得到新的解(多余)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%BB%E6%84%8F%E4%B8%A4%E4%B8%AA%E8%A7%A3%E7%9B%B8%E5%85%B3%E7%9A%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E4%B9%98%E7%A7%AF%E8%83%BD%E5%BE%97%E5%88%B0%E6%96%B0%E7%9A%84%E8%A7%A3-%E8%AF%A5%E7%BB%93%E8%AE%BA%E5%8C%85%E5%90%AB%E4%B8%8A%E8%BF%B0%E4%B8%A4%E4%B8%AA%E7%BB%93%E8%AE%BA"><span class="nav-text">任意两个解相关的表达式的乘积能得到新的解(该结论包含上述两个结论)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%98%E5%9C%A8%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E8%A7%A3-%E6%9C%80%E5%B0%8F%E8%A7%A3-%EF%BC%8C%E6%89%80%E6%9C%89%E8%A7%A3%E9%83%BD%E6%98%AF%E7%94%B1%E5%9F%BA%E7%A1%80%E8%A7%A3%E7%94%9F%E6%88%90%E7%9A%84"><span class="nav-text">存在一个基础解(最小解)，所有解都是由基础解生成的</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E7%9A%84%E5%AD%98%E5%9C%A8%E6%80%A7%E8%AF%81%E6%98%8E"><span class="nav-text">解的存在性证明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E7%90%861%EF%BC%8C%E6%97%A0%E7%A9%B7%E5%A4%9A%E5%AF%B9%E6%95%B4%E6%95%B0%E6%BB%A1%E8%B6%B3%E7%BB%99%E5%AE%9A%E4%B8%8D%E7%AD%89%E5%BC%8F"><span class="nav-text">引理1，无穷多对整数满足给定不等式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%BC%95%E7%90%861-%E9%85%8D%E5%87%BApell%E6%96%B9%E7%A8%8B%E7%9A%84%E8%A7%A3"><span class="nav-text">基于引理1,配出pell方程的解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pell%E6%96%B9%E7%A8%8B%E6%80%A7%E8%B4%A8%E5%B0%8F%E7%BB%93"><span class="nav-text">pell方程性质小结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9E%E5%88%86%E6%95%B0"><span class="nav-text">连分数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89"><span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%A7%E8%B4%A81-%E6%89%80%E6%9C%89%E6%97%A0%E9%99%90%E8%BF%9E%E5%88%86%E6%95%B0%E9%83%BD%E6%98%AF%E6%97%A0%E7%90%86%E6%95%B0%E3%80%82"><span class="nav-text">性质1 所有无限连分数都是无理数。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%90%E8%BF%9B%E5%88%86%E6%95%B0-%E5%88%86%E5%AD%90%EF%BC%8C%E5%88%86%E6%AF%8D%E7%AD%89%E6%80%A7%E8%B4%A8"><span class="nav-text">渐进分数(分子，分母等性质)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%AD%90%E5%88%86%E6%AF%8D%E9%80%92%E6%8E%A8%E5%BC%8F"><span class="nav-text">分子分母递推式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%AD%90%E5%88%86%E6%AF%8D-%E7%9B%B8%E5%85%B3%E7%AD%89%E5%BC%8F"><span class="nav-text">分子分母 相关等式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E6%97%A0%E7%90%86%E6%95%B0%E4%B8%8E%E6%B8%90%E8%BF%9B%E6%95%B0%E7%9A%84%E5%B7%AE%E5%80%BC%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-text">原无理数与渐进数的差值表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E6%97%A0%E7%90%86%E6%95%B0%E4%B8%8E%E6%B8%90%E8%BF%9B%E6%95%B0%E7%9A%84%E5%B7%AE%E5%80%BC%E7%BB%9D%E5%AF%B9%E5%80%BC%E5%8D%95%E8%B0%83%E9%80%92%E5%87%8F"><span class="nav-text">原无理数与渐进数的差值绝对值单调递减</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%92%8C%E6%B8%90%E8%BF%9B%E6%95%B0%E5%90%8C%E5%88%86%E6%AF%8D%E7%9A%84%E6%89%80%E6%9C%89%E5%88%86%E6%95%B0%E4%B8%AD%EF%BC%8C%E6%B8%90%E8%BF%9B%E6%95%B0%E6%9C%80%E6%8E%A5%E8%BF%91%E5%8E%9F%E6%97%A0%E7%90%86%E6%95%B0"><span class="nav-text">和渐进数同分母的所有分数中，渐进数最接近原无理数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%AF%8D%E5%B0%8F%E4%BA%8E%E7%AD%89%E4%BA%8E%E6%B8%90%E8%BF%9B%E6%95%B0%E7%9A%84%E5%88%86%E6%AF%8D%E7%9A%84%E6%89%80%E6%9C%89%E5%88%86%E6%95%B0%E4%B8%AD%EF%BC%8C%E6%B8%90%E8%BF%9B%E6%95%B0%E8%83%BD%E4%BD%BF-%E5%88%86%E5%AD%90x%E5%8E%9F%E6%97%A0%E7%90%86%E6%95%B0-%E5%88%86%E6%AF%8D-%E5%8F%96%E6%9C%80%E5%B0%8F%E5%80%BC"><span class="nav-text">分母小于等于渐进数的分母的所有分数中，渐进数能使|分子x原无理数-分母|取最小值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E7%BB%AD%E7%9A%84%E4%B8%A4%E4%B8%AA%E6%B8%90%E8%BF%9B%E6%95%B0%E4%B8%AD%E8%87%B3%E5%B0%91%E6%9C%89%E4%B8%80%E4%B8%AA%E6%BB%A1%E8%B6%B3pell%E6%96%B9%E7%A8%8B%E5%BF%85%E8%A6%81%E7%9A%84%E4%B8%8D%E7%AD%89%E5%BC%8F"><span class="nav-text">连续的两个渐进数中至少有一个满足pell方程必要的不等式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%BB%E4%BD%95%E6%9C%80%E7%AE%80%E5%88%86%E6%95%B0%E5%A6%82%E6%9E%9C%E6%BB%A1%E8%B6%B3pell%E6%96%B9%E7%A8%8B%E5%BF%85%E8%A6%81%E7%9A%84%E4%B8%8D%E7%AD%89%E5%BC%8F%EF%BC%8C%E9%82%A3%E4%B9%88%E5%AE%83%E6%98%AF%E4%B8%80%E4%B8%AA%E6%B8%90%E8%BF%9B%E5%88%86%E6%95%B0"><span class="nav-text">任何最简分数如果满足pell方程必要的不等式，那么它是一个渐进分数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Lagrange%E2%80%99s-Theorem-%E4%BA%8C%E6%AC%A1%E6%97%A0%E7%90%86%E6%95%B0%E4%B8%8E%E6%9C%89%E5%BE%AA%E7%8E%AF%E8%8A%82%E7%9A%84%E8%BF%9E%E5%88%86%E6%95%B0"><span class="nav-text">Lagrange’s Theorem 二次无理数与有循环节的连分数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E8%BF%9E%E5%88%86%E6%95%B0%E4%B8%80%E5%AE%9A%E6%98%AF%E4%BA%8C%E6%AC%A1%E6%97%A0%E7%90%86%E6%95%B0"><span class="nav-text">循环连分数一定是二次无理数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E6%97%A0%E7%90%86%E6%95%B0%E4%B8%80%E5%AE%9A%E6%98%AF%E5%BE%AA%E7%8E%AF%E8%BF%9E%E5%88%86%E6%95%B0"><span class="nav-text">二次无理数一定是循环连分数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Galois%E2%80%99-Theorem-%E7%BA%AF%E5%BE%AA%E7%8E%AF%E8%BF%9E%E5%88%86%E6%95%B0%E4%B8%8Ereduced%E4%BA%8C%E6%AC%A1%E6%97%A0%E7%90%86%E6%95%B0"><span class="nav-text">Galois’ Theorem 纯循环连分数与reduced二次无理数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#reduced%E4%BA%8C%E6%AC%A1%E6%97%A0%E7%90%86%E6%95%B0-%E6%98%AF-%E7%BA%AF%E5%BE%AA%E7%8E%AF%E8%BF%9E%E5%88%86%E6%95%B0"><span class="nav-text">reduced二次无理数 是 纯循环连分数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BA%AF%E5%BE%AA%E7%8E%AF%E8%BF%9E%E5%88%86%E6%95%B0-%E6%98%AF-reduced"><span class="nav-text">纯循环连分数 是 reduced</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#reduced%E4%BA%8C%E6%AC%A1%E6%97%A0%E7%90%86%E6%95%B0-%E7%BA%AF%E5%BE%AA%E7%8E%AF%E8%BF%9E%E5%88%86%E6%95%B0%E7%9A%84-%E5%8E%9F%E6%97%A0%E7%90%86%E6%95%B0%E4%B8%8E%E5%AE%83%E7%9A%84%E5%85%B1%E8%BD%AD%E7%9B%B8%E5%8F%8D%E5%80%92%E6%95%B0%E7%9A%84%E8%BF%9E%E5%88%86%E6%95%B0%E6%95%B0%E5%80%BC%E5%85%B3%E7%B3%BB"><span class="nav-text">reduced二次无理数 纯循环连分数的 原无理数与它的共轭相反倒数的连分数数值关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E5%8F%B7n-%E7%9A%84-%E8%BF%9E%E5%88%86%E6%95%B0%E6%80%A7%E8%B4%A8"><span class="nav-text">根号n 的 连分数性质</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Solution-to-Pell%E2%80%99s-Equation"><span class="nav-text">Solution to Pell’s Equation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B9%E5%8F%B7n%E7%9A%84%E8%BF%9E%E5%88%86%E6%95%B0%E6%B8%90%E8%BF%9B%E5%88%86%E6%95%B0%E7%9A%84%E6%80%A7%E8%B4%A8"><span class="nav-text">根号n的连分数渐进分数的性质</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E5%BC%95%E7%90%86"><span class="nav-text">一个引理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B4%E6%8C%87pell%E6%96%B9%E7%A8%8B%E5%B7%A6%E4%BE%A7%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-text">直指pell方程左侧表达式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E5%90%8E%E4%B8%80%E6%AD%A5-%E8%BF%9E%E5%88%86%E6%95%B0%E5%92%8Cpell%E6%96%B9%E7%A8%8B%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-text">最后一步 连分数和pell方程的关系</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%B1%BB%E8%AE%A8%E8%AE%BA-Q-x3D-1"><span class="nav-text">分类讨论 Q &#x3D; -1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%B1%BB%E8%AE%A8%E8%AE%BA-Q-x3D-1-1"><span class="nav-text">分类讨论 Q &#x3D; 1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%8C%E7%BB%93"><span class="nav-text">完结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9E%E9%A1%BE%E5%8E%86%E7%A8%8B"><span class="nav-text">回顾历程</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-text">代码</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-text">参考</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-amp-%E6%84%9F%E5%8F%97"><span class="nav-text">总结&amp;感受</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Xiao Ye"
      src="https://avatars.githubusercontent.com/u/7298239?v=4">
  <p class="site-author-name" itemprop="name">Xiao Ye</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/Blog/archives/">
          <span class="site-state-item-count">255</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/Blog/categories/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/Blog/tags/">
        <span class="site-state-item-count">248</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yexiaorain" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yexiaorain" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yexiaorain@gmail.com" title="E-Mail → mailto:yexiaorain@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://atcoder.jp/users/cromarmot" title="https:&#x2F;&#x2F;atcoder.jp&#x2F;users&#x2F;cromarmot" rel="noopener" target="_blank">AtCoder</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://codeforces.com/profile/YeXiaoRain" title="https:&#x2F;&#x2F;codeforces.com&#x2F;profile&#x2F;YeXiaoRain" rel="noopener" target="_blank">Codeforces</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/pe/066/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="project euler 066 diophantine equation | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          project euler 066 diophantine equation
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-05-29 10:37:14" itemprop="dateCreated datePublished" datetime="2020-05-29T10:37:14+08:00">2020-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2023-05-28 22:26:27" itemprop="dateModified" datetime="2023-05-28T22:26:27+08:00">2023-05-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Project-Euler/" itemprop="url" rel="index"><span itemprop="name">Project Euler</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/pe/066/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="pe/066/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>10k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>34 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="叹气"><a href="#叹气" class="headerlink" title="叹气"></a>叹气</h1><p>从2020 02 09 挖的坑，中间很长一段时间鸽了，终于在05 29写完了.</p>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a target="_blank" rel="noopener" href="https://projecteuler.net/problem=66">https://projecteuler.net/problem=66</a></p>
<h1 id="大意"><a href="#大意" class="headerlink" title="大意"></a>大意</h1><p>d &#x3D; 1-&gt;1000，d是非平方数</p>
<p>对于每个d 求最小的正整数<code>x</code>使得$x^2-dy^2&#x3D;1$，其中x,y都是正整数,</p>
<p>最后对所有这些x求最大的x</p>
<h1 id="读懂本文你可能需要的前置知识"><a href="#读懂本文你可能需要的前置知识" class="headerlink" title="读懂本文你可能需要的前置知识"></a>读懂本文你可能需要的前置知识</h1><p>抽屉原理</p>
<p>二元一次方程</p>
<p>绝对值</p>
<p>有理数&#x2F;无理数</p>
<p>模运算</p>
<p>矩阵运算</p>
<p>数列&#x2F;递推数列</p>
<p>二项式展开</p>
<p>反证法</p>
<p>归纳法</p>
<p>不等式(缩放，三角不等式)</p>
<p>共轭实数(不太知道怎么翻译比较好，还是对偶实数？ 描述的就是$a+b\sqrt{m}$与$a-b\sqrt{m}$</p>
<h1 id="自闭尝试"><a href="#自闭尝试" class="headerlink" title="自闭尝试"></a>自闭尝试</h1><h2 id="一些自己的数学推论"><a href="#一些自己的数学推论" class="headerlink" title="一些自己的数学推论"></a>一些自己的数学推论</h2><p>如果质数p是d的因子，那么$x^2 &#x3D; 1 (\bmod p)$,由此$x &#x3D; 1 (\bmod p)$ 或者$x&#x3D;p-1(\bmod p)$</p>
<p>所以我们可以按d的最大质因子的倍数 加减1去搜，能快个常数倍</p>
<hr>
<p>显然有$(x-1)(x+1) &#x3D; dy^2$</p>
<p>令$d&#x3D;d_1 \cdot d_2$</p>
<p>令$y&#x3D;y_1 \cdot y_2$</p>
<p>根据对称性必然有 $d_1 \cdot {y_1}^2 - d_2 \cdot {y_2}^2 &#x3D; (x+1) - (x-1) &#x3D; 2$</p>
<p>一定程度上能减少搜索量，优化最多也就最大质数常数倍，也是最多100倍的优化</p>
<blockquote>
<p>另外就是MOD 4的性质，用处不大，2倍左右常数优化</p>
</blockquote>
<blockquote>
<p>然后就是1-100内的尝试是d&#x3D;61最大1766319049</p>
</blockquote>
<blockquote>
<p>如果d0能找到x0，那么d0和y0因子平方的组合最多是x0,也是优化不大</p>
</blockquote>
<h2 id="python3写了个-按x递增搜索"><a href="#python3写了个-按x递增搜索" class="headerlink" title="python3写了个 按x递增搜索"></a>python3写了个 按x递增搜索</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">1000</span></span><br><span class="line">arr = <span class="built_in">set</span>()</span><br><span class="line">Q = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,N+<span class="number">1</span>):</span><br><span class="line">    arr.add(d)</span><br><span class="line"></span><br><span class="line">x = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(arr) != <span class="number">0</span>:</span><br><span class="line">    Q.add(x**<span class="number">2</span>)</span><br><span class="line">    delarr = []</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> arr:</span><br><span class="line">        <span class="keyword">if</span> x**<span class="number">2</span> - <span class="number">1</span> &gt; <span class="number">0</span> <span class="keyword">and</span> (x**<span class="number">2</span>-<span class="number">1</span>)%d == <span class="number">0</span> <span class="keyword">and</span> (x**<span class="number">2</span>-<span class="number">1</span>)//d <span class="keyword">in</span> Q:</span><br><span class="line">            <span class="built_in">print</span>(x,<span class="string">&quot;^2-&quot;</span>,d,<span class="string">&quot;*&quot;</span>,(x**<span class="number">2</span>-<span class="number">1</span>)//d,<span class="string">&quot;=1,leftcnt=&quot;</span>,<span class="built_in">len</span>(arr))</span><br><span class="line">            delarr.append(d)</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> delarr:</span><br><span class="line">        arr.remove(d)</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">2 ^2- 3 * 1 =1,leftcnt= 1000</span></span><br><span class="line"><span class="string">3 ^2- 2 * 4 =1,leftcnt= 999</span></span><br><span class="line"><span class="string">3 ^2- 8 * 1 =1,leftcnt= 999</span></span><br><span class="line"><span class="string">4 ^2- 15 * 1 =1,leftcnt= 997</span></span><br><span class="line"><span class="string">5 ^2- 6 * 4 =1,leftcnt= 996</span></span><br><span class="line"><span class="string">5 ^2- 24 * 1 =1,leftcnt= 996</span></span><br><span class="line"><span class="string">6 ^2- 35 * 1 =1,leftcnt= 994</span></span><br><span class="line"><span class="string">7 ^2- 12 * 4 =1,leftcnt= 993</span></span><br><span class="line"><span class="string">7 ^2- 48 * 1 =1,leftcnt= 993</span></span><br><span class="line"><span class="string">8 ^2- 7 * 9 =1,leftcnt= 991</span></span><br><span class="line"><span class="string">8 ^2- 63 * 1 =1,leftcnt= 991</span></span><br><span class="line"><span class="string">9 ^2- 5 * 16 =1,leftcnt= 989</span></span><br><span class="line"><span class="string">9 ^2- 20 * 4 =1,leftcnt= 989</span></span><br><span class="line"><span class="string">9 ^2- 80 * 1 =1,leftcnt= 989</span></span><br><span class="line"><span class="string">10 ^2- 11 * 9 =1,leftcnt= 986</span></span><br><span class="line"><span class="string">10 ^2- 99 * 1 =1,leftcnt= 986</span></span><br><span class="line"><span class="string">11 ^2- 30 * 4 =1,leftcnt= 984</span></span><br><span class="line"><span class="string">11 ^2- 120 * 1 =1,leftcnt= 984</span></span><br><span class="line"><span class="string">12 ^2- 143 * 1 =1,leftcnt= 982</span></span><br><span class="line"><span class="string">13 ^2- 42 * 4 =1,leftcnt= 981</span></span><br><span class="line"><span class="string">.....</span></span><br><span class="line"><span class="string">23915529 ^2- 365 * 1566993225616 =1,leftcnt= 291</span></span><br><span class="line"><span class="string">24220799 ^2- 284 * 2065658817600 =1,leftcnt= 290</span></span><br><span class="line"><span class="string">24220799 ^2- 639 * 918070585600 =1,leftcnt= 290</span></span><br><span class="line"><span class="string">24248647 ^2- 172 * 3418586519364 =1,leftcnt= 288</span></span><br><span class="line"><span class="string">24248647 ^2- 688 * 854646629841 =1,leftcnt= 288</span></span><br><span class="line"><span class="string">27365201 ^2- 666 * 1124405744400 =1,leftcnt= 286</span></span><br><span class="line"><span class="string">30580901 ^2- 550 * 1700348192676 =1,leftcnt= 285</span></span><br><span class="line"><span class="string">32080051 ^2- 106 * 9708770492100 =1,leftcnt= 284</span></span><br><span class="line"><span class="string">32080051 ^2- 424 * 2427192623025 =1,leftcnt= 284</span></span><br><span class="line"><span class="string">32080051 ^2- 954 * 1078752276900 =1,leftcnt= 284</span></span><br><span class="line"><span class="string">^CTraceback (most recent call last):</span></span><br><span class="line"><span class="string">  File &quot;./p066.py&quot;, line 13, in &lt;module&gt;</span></span><br><span class="line"><span class="string">    if x**2 - 1 &gt; 0 and (x**2-1)%d == 0 and (x**2-1)//d in Q:</span></span><br><span class="line"><span class="string">KeyboardInterrupt</span></span><br><span class="line"><span class="string">^C</span></span><br><span class="line"><span class="string">real	135m43.883s</span></span><br><span class="line"><span class="string">user	133m30.473s</span></span><br><span class="line"><span class="string">sys	0m20.102s</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>我给它掐断了,跑了两小时，虽然是单核的，但是还有284个数没算出来</p>
<h2 id="go并行-每个数各算各的"><a href="#go并行-每个数各算各的" class="headerlink" title="go并行 每个数各算各的"></a>go并行 每个数各算各的</h2><p>值过大,需要big&#x2F;int</p>
<p>写了一个可分段，可并行，可”断点”计算的</p>
<p>第一遍把1到1000直接跑，每次找到值都会输出剩余表</p>
<p>没统计计算时间，反正很久，每次运算的结果可以去替换slowv和ans</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// x*x-d*y*y=1</span></span><br><span class="line"><span class="comment">// 如果d包含质因子p</span></span><br><span class="line"><span class="comment">// x*x mod p = 1</span></span><br><span class="line"><span class="comment">// 所以 x mod p = 1 or p-1</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;math/big&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Xd <span class="keyword">struct</span> &#123;</span><br><span class="line">  X big.Int</span><br><span class="line">  d <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> prime [<span class="number">1010</span>]<span class="type">bool</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> offset = <span class="number">0</span></span><br><span class="line"><span class="keyword">const</span> VCNT = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> slowv = []<span class="type">int</span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否平方数 返回 &#123;开根,true&#125;或者&#123;0,false&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSqrt</span><span class="params">(x *big.Int)</span></span> (*big.Int, <span class="type">bool</span>) &#123;</span><br><span class="line">  xsqrt := big.NewInt(<span class="number">0</span>).Sqrt(x)</span><br><span class="line">  <span class="keyword">var</span> xx big.Int</span><br><span class="line">  xx.Mul(xsqrt, xsqrt)</span><br><span class="line">  <span class="keyword">if</span> xx.Cmp(x) == <span class="number">0</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> xsqrt, <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> big.NewInt(<span class="number">0</span>), <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对每个d尝试</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findx</span><span class="params">(d <span class="type">int</span>, ch <span class="keyword">chan</span> Xd)</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> _, ok := getSqrt(big.NewInt(<span class="type">int64</span>(d))); ok &#123;</span><br><span class="line">    ch &lt;- Xd&#123;*big.NewInt(<span class="number">0</span>), d&#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// d的最大质因子</span></span><br><span class="line">  maxp := <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= d; i++ &#123;</span><br><span class="line">    <span class="keyword">if</span> prime[i] &#123;</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> d%i == <span class="number">0</span> &amp;&amp; i &gt; maxp &#123;</span><br><span class="line">      maxp = i</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i := big.NewInt(<span class="number">1</span>); ; i.Add(i, big.NewInt(<span class="number">1</span>)) &#123;</span><br><span class="line">    imaxp := big.NewInt(<span class="number">0</span>).Mul(i, big.NewInt(<span class="type">int64</span>(maxp)))</span><br><span class="line">    sub1 := big.NewInt(<span class="number">0</span>).Sub(imaxp, big.NewInt(<span class="number">1</span>))</span><br><span class="line">    add1 := big.NewInt(<span class="number">0</span>).Add(imaxp, big.NewInt(<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">for</span> _, x := <span class="keyword">range</span> []*big.Int&#123;sub1, add1&#125; &#123;</span><br><span class="line">      <span class="comment">// x^2-1</span></span><br><span class="line">      x2s1 := big.NewInt(<span class="number">0</span>).Sub(big.NewInt(<span class="number">0</span>).Mul(x, x), big.NewInt(<span class="number">1</span>))</span><br><span class="line">      x2s1mod := big.NewInt(<span class="number">0</span>).Mod(x2s1, big.NewInt(<span class="type">int64</span>(d)))</span><br><span class="line">      <span class="keyword">if</span> x2s1mod.Cmp(big.NewInt(<span class="number">0</span>)) != <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">      &#125;</span><br><span class="line">      x2s1div := big.NewInt(<span class="number">0</span>).Div(x2s1, big.NewInt(<span class="type">int64</span>(d)))</span><br><span class="line">      <span class="keyword">if</span> _, ok := getSqrt(x2s1div); ok &#123;</span><br><span class="line">        ch &lt;- Xd&#123;*x, d&#125;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 结果处理</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">waitAns</span><span class="params">(ch <span class="keyword">chan</span> Xd, ans *Xd, wg *sync.WaitGroup)</span></span> &#123;</span><br><span class="line">  s := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]<span class="type">int</span>)</span><br><span class="line">  <span class="keyword">for</span> _,v := <span class="keyword">range</span> slowv&#123;</span><br><span class="line">    s[v]=<span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  cnt := <span class="number">0</span></span><br><span class="line">  fmt.Println(s, *ans, <span class="built_in">len</span>(s))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> v := <span class="keyword">range</span> ch &#123;</span><br><span class="line">    cnt++</span><br><span class="line">    <span class="built_in">delete</span>(s,v.d)</span><br><span class="line">    fmt.Println(s, *ans, <span class="built_in">len</span>(s))</span><br><span class="line">    <span class="keyword">if</span> v.X.Cmp(&amp;ans.X) == <span class="number">1</span> &#123;</span><br><span class="line">      *ans = v</span><br><span class="line">      <span class="comment">// fmt.Println(&quot;new&quot;,*ans, cnt)</span></span><br><span class="line">    &#125;</span><br><span class="line">    wg.Done()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">2</span>; i &lt; <span class="number">100</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">if</span> prime[i] &#123;</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> j := i * i; j &lt;= <span class="number">1000</span>; j += i &#123;</span><br><span class="line">      prime[j] = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ans := Xd&#123;*big.NewInt(<span class="number">0</span>), <span class="number">1</span>&#125;</span><br><span class="line">  <span class="comment">// 取消下面两行注释 从计算结果继续</span></span><br><span class="line">  <span class="comment">// slowv = []int&#123;739, 367, 547, 835, 457, 797, 766, 508, 931, 166, 937, 556, 989, 517, 926, 554, 834, 253, 796, 331, 976, 953, 883, 394, 977, 511, 199, 449, 661, 919, 571, 581, 814, 271, 805, 862, 277, 526, 653, 981, 664, 829, 749, 382, 956, 821, 412, 913, 596, 911, 871, 268, 941, 859, 967, 809, 214, 317, 298, 622, 974, 565, 997, 607, 649, 991, 751, 823, 358, 487, 679, 921, 501, 716, 826, 929, 853, 478, 586, 863, 309, 947, 569, 946, 778, 849, 481, 157, 553, 673, 301, 681, 244, 509, 523, 865, 754, 844, 433, 773, 634, 869, 753, 643, 669, 589, 790, 721, 614, 857, 685, 334, 521, 149, 709, 856, 694, 491, 971, 789, 549, 281, 757, 893, 907, 964, 313, 746, 454, 724, 463, 617, 109, 886, 337, 477, 489, 922, 637, 641, 877, 597, 211, 881, 409, 493, 631, 593, 599, 397, 889, 838, 610, 970, 801, 949, 628, 928, 436, 181, 719, 811, 613, 538, 604, 421, 958, 619, 972, 379, 772, 241, 769, 541, 193, 686, 601, 691, 764, 988, 652, 353, 461, 61, 787, 718,&#125;</span></span><br><span class="line">  <span class="comment">// ans := Xd&#123;*big.NewInt(3832352837), 502&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line">  ch := <span class="built_in">make</span>(<span class="keyword">chan</span> Xd)</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(slowv) == <span class="number">0</span>&#123;</span><br><span class="line">    <span class="comment">// 第一遍的时候 lowv 为空 用这个代码</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>+offset; i &lt;= VCNT+offset; i++ &#123;</span><br><span class="line">      slowv = <span class="built_in">append</span>(slowv, i)</span><br><span class="line">      wg.Add(<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">go</span> findx(i, ch)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> _,v := <span class="keyword">range</span> slowv&#123;</span><br><span class="line">      wg.Add(<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">go</span> findx(v,ch)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">go</span> waitAns(ch, &amp;ans, &amp;wg)</span><br><span class="line">  wg.Wait()</span><br><span class="line">  fmt.Println(ans)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>这时就体现出当数学家可以推出结论，而计算机拥有的只是“蛮力”。</p>
<h2 id="pell方程的解"><a href="#pell方程的解" class="headerlink" title="pell方程的解"></a>pell方程的解</h2><h3 id="解的性质-基础解"><a href="#解的性质-基础解" class="headerlink" title="解的性质(基础解)"></a>解的性质(基础解)</h3><h4 id="平方一个解相关的表达式能得到新的解-多余"><a href="#平方一个解相关的表达式能得到新的解-多余" class="headerlink" title="平方一个解相关的表达式能得到新的解(多余)"></a>平方一个解相关的表达式能得到新的解(多余)</h4><p>如果$x^2-d \cdot y^2&#x3D;1$ 平方得 $x^4+d^2 \cdot y^4-2dx^2y^2&#x3D;1$</p>
<p>$x^4+2dx^2y^2+d^2 \cdot y^4-d \cdot 4x^2y^2&#x3D;1$</p>
<p>$(x^2+dy^2)^2 - d \cdot (2xy)^2&#x3D;1$</p>
<p>即当我们有一个解时，通过平方能得到新的解</p>
<h4 id="一个解相关的表达式的整幂次能得到新的解-多余"><a href="#一个解相关的表达式的整幂次能得到新的解-多余" class="headerlink" title="一个解相关的表达式的整幂次能得到新的解(多余)"></a>一个解相关的表达式的整幂次能得到新的解(多余)</h4><p>又$(x+\sqrt{d} \cdot y)\cdot (x-\sqrt{d} \cdot y)&#x3D;1$</p>
<p>可得$((x+\sqrt{d} \cdot y)\cdot (x-\sqrt{d} \cdot y))^n&#x3D;1$</p>
<p>$(x+\sqrt{d} \cdot y)^n\cdot (x-\sqrt{d} \cdot y)^n&#x3D;1$</p>
<p>根据二项式展开有</p>
<p>若 $(x+\sqrt{d} \cdot y)^n &#x3D; A + B\cdot{d}$</p>
<p>则 $(x-\sqrt{d} \cdot y)^n &#x3D; A - B\cdot{d}$ 即是 $A^2-d \cdot B^2&#x3D;1$</p>
<p>也就是它的n次方展开的系数也是一组解</p>
<h4 id="任意两个解相关的表达式的乘积能得到新的解-该结论包含上述两个结论"><a href="#任意两个解相关的表达式的乘积能得到新的解-该结论包含上述两个结论" class="headerlink" title="任意两个解相关的表达式的乘积能得到新的解(该结论包含上述两个结论)"></a>任意两个解相关的表达式的乘积能得到新的解(该结论包含上述两个结论)</h4><blockquote>
<p>同样,假设有两组解：(x1,y1)和(x2,y2)的，它们也可以通过上述乘积方法，合成一组新的解</p>
</blockquote>
<h4 id="存在一个基础解-最小解-，所有解都是由基础解生成的"><a href="#存在一个基础解-最小解-，所有解都是由基础解生成的" class="headerlink" title="存在一个基础解(最小解)，所有解都是由基础解生成的"></a>存在一个基础解(最小解)，所有解都是由基础解生成的</h4><p><strong>下面证明所有解都是最小解生成的</strong></p>
<p>因为y越大x越大,设$(x_1,y_1)$为最小解,$(x_k,y_k)$不是由最小解上述幂次方法生成的一个解</p>
<p>根据y越大x越大的性质，则存在一个整数n</p>
<p>$(x_1+y_1 \cdot \sqrt{d})^n &lt; (x_k+y_k \cdot \sqrt{d}) &lt; (x_1+y_1 \cdot \sqrt{d})^{n+1} $</p>
<p>同时乘$(x_1-y_1 \cdot \sqrt{d})^n$有</p>
<p>$1 &lt; (x_k+y_k \cdot \sqrt{d}) \cdot (x_1-y_1 \cdot \sqrt{d})^n &lt; (x_1+y_1 \cdot \sqrt{d}) $</p>
<p>注意到中间的表达式 也是满足参数形式的 也是一组解(并且因为$\frac{x_1}{y_1} &#x3D; \sqrt{\frac{1}{y_1^2}+d} &gt; \sqrt{\frac{1}{y_k^2}+d} &#x3D; \frac{x_k}{y_k}$,所以参数均为正数 )</p>
<p>这与最小解定义冲突，所以所有解都是最小解生成的</p>
<h3 id="解的存在性证明"><a href="#解的存在性证明" class="headerlink" title="解的存在性证明"></a>解的存在性证明</h3><h4 id="引理1，无穷多对整数满足给定不等式"><a href="#引理1，无穷多对整数满足给定不等式" class="headerlink" title="引理1，无穷多对整数满足给定不等式"></a>引理1，无穷多对整数满足给定不等式</h4><p>存在无穷多对整数(x,y)满足 $|x-y\sqrt{d}|&lt;\frac 1y$</p>
<p>取正整数$q_0 &gt; 1$</p>
<p>取$t&#x3D;1,…,q_0+1$ 共计$q_0+1$个</p>
<p>把区间$[0,1)$等分为$q_0$部分，则每部分长度为$\frac 1{q_0}$,考虑 $t \sqrt{d}$的小数部分(t为整数)，必定有两个落在同一区间 所以存在$0\leq i&lt;j\leq q_0$使得 $| \{t_i \sqrt{d}\} - \{t_j \sqrt{d}\} | &lt;\frac 1{q_0}$</p>
<p>即$|x-(t_j-t_i)\sqrt{d}| &#x3D;  | \{t_i \sqrt{d}\} - \{ t_j \sqrt{d}\} | &lt; \frac 1{q_0} \leq  \frac 1{t_j-t_i}$</p>
<p>这里要注意的是我们知道i&lt;j,和它们的小数部分落在同一个区间，所以这里应该是它们的小数部分相减的绝对值，而不是相减的绝对值的小数部分，例如q取2, 一个取0.4,一个1.3,它们都在[0,0.5)的区间里，但是如果$|1.3-0.4|$ 再取绝对值的小数部分，得到的是0.9而不是0.1,对于x来说，只要增减1就能在最终的值上切换成功.</p>
<p>把$t_j-t_i$ 看作y得到一个解</p>
<p>取$\frac 1{q_1} &lt; |x-(t_j-t_i)\sqrt{d}|$</p>
<p>可以得到新的解(因为同一个y最多有两种 $|x-y\sqrt{d}|$的小数部分，反复如此可生成无限个解</p>
<p>取$|x_3-y_3\sqrt{d}| &lt;\frac 1{q_3} &lt; |x_2-y_2 \sqrt{d}| &lt; \frac 1{q_2} &lt; |x_1-y_1\sqrt{d}| &lt;\frac 1{q_1} &lt; |x_0-y_0 \sqrt{d}| &lt; \frac 1{q_0} $</p>
<h4 id="基于引理1-配出pell方程的解"><a href="#基于引理1-配出pell方程的解" class="headerlink" title="基于引理1,配出pell方程的解"></a>基于引理1,配出pell方程的解</h4><p>对于这无限个解</p>
<p>0 &lt; $\left|x^2-dy^2\right|&#x3D;\left|x+y\sqrt{d}\right|\cdot\left|x-y\sqrt{d}\right|&#x3D;\left|x-y\sqrt{d}+2y\sqrt{d}\right|\cdot\left|x-y\sqrt{d}\right|\leq (\left|x-y\sqrt{d}\right|+\left|2y\sqrt{d}\right|)\cdot\left|x-y\sqrt{d}\right|&lt;\left(2y\sqrt{d}+\frac{1}{y}\right)\cdot\frac{1}{y}\le 2\sqrt{d}+\frac 1{y^2}$</p>
<p>说明这无限个(x,y)的取值,对$|x^2-dy^2|$的计算结果是有限范围内的整数</p>
<p>再一次根据抽屉原理，存在正整数k,使得$|x^2-dy^2|&#x3D;k$的解有无限个</p>
<p>考虑这些解$(x \bmod k,y \bmod k)$ , 可以的方案数$\leq k^2$,也是有限的，</p>
<p>再根据抽屉原理，存在$(M_x,M_y)$，使得无限个i， $s.t. (x_i \bmod k, y_i \bmod k) &#x3D; (M_x,M_y)$,在这无限组中取两组$(x_1,y_1),(x_2,y_2)$</p>
<p>令 $X&#x3D;|\frac{x_1x_2-y_1y_2d}{k}|,Y&#x3D;|\frac{x_2y_1-x_1y_2}{k}|$</p>
<p>有 $X^2-d \cdot Y^2 &#x3D; \frac{(x_1^2-d \cdot y_1^2)(x_2^2-d \cdot y_2^2)}{k^2} &#x3D; 1$</p>
<p>因为 $(x_2y_1-x_1y_2)\bmod k &#x3D; (x_1y_1-x_1y_1) \bmod k &#x3D; 0 \bmod k &#x3D; 0$,所以Y是整数</p>
<p>因为$X$是有理数且满足pell方程，所以它是整数</p>
<p>显然$X &#x3D; \sqrt{1+dY^2}$ 不为0</p>
<p>注意到 $x^2-dy^2$ 的取值范围为 $\pm k$ (有限个 ，2个)，但可取的$(x,y)$有无限对，再一次抽屉原理,因此存在$(x_i,y_i)\neq(x_j,y_j)$使得 $x_i^2-dy_i^2&#x3D;x_j^2-dy_j^2$ 这时 $\frac{x_i}{y_i} \neq \frac{x_j}{y_j}$ (否则代入前式子得到$x_i&#x3D;x_j$), 即Y不为0,Y为正整数</p>
<p>综上，一定存在解</p>
<h4 id="pell方程性质小结"><a href="#pell方程性质小结" class="headerlink" title="pell方程性质小结"></a>pell方程性质小结</h4><p>关于 pell方程 ，我们现在有了 一定存在解，且存在一个最小解的基础解，两个结论，下面开始看看连分数。</p>
<h2 id="连分数"><a href="#连分数" class="headerlink" title="连分数"></a>连分数</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>形如</p>
<p>$\alpha &#x3D; a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \cfrac{1}{\ddots,}}}} $</p>
<p>例如 </p>
<p>$ \sqrt{2} &#x3D; 1 + \frac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \ddots}}}}}} $</p>
<p>展开的剩余部分是在<code>[0,1)</code>之间</p>
<h3 id="性质1-所有无限连分数都是无理数。"><a href="#性质1-所有无限连分数都是无理数。" class="headerlink" title="性质1 所有无限连分数都是无理数。"></a>性质1 所有无限连分数都是无理数。</h3><p>证明：如果一个数是有理数，把它写成分数的形式，再按照连分数的方式展开，你会发现这过程就是辗转相除，分子分母单调递减 所以一定有限，它的逆否命题就是要证明的性质</p>
<h3 id="渐进分数-分子，分母等性质"><a href="#渐进分数-分子，分母等性质" class="headerlink" title="渐进分数(分子，分母等性质)"></a>渐进分数(分子，分母等性质)</h3><h4 id="分子分母递推式"><a href="#分子分母递推式" class="headerlink" title="分子分母递推式"></a>分子分母递推式</h4><p>渐进分数，把上述表示无理数$\alpha$的连分数部分截断所得到的分数</p>
<p>假设h,k分别为渐进分数的分子和分母,根据简化为分数的过程</p>
<p>$\begin{bmatrix} h_n &amp; k_n \end{bmatrix} &#x3D; \begin{bmatrix} 1 &amp; 0 \end{bmatrix} \cdot \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdots \begin{bmatrix} a_0 &amp; 1 \\ 1 &amp; 0 \end{bmatrix} $</p>
<p>然而这不好建立递推关系,稍做变形</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ ? &amp; ? \end{bmatrix} &#x3D; \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix} \cdot \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdots \begin{bmatrix} a_0 &amp; 1 \\ 1 &amp; 0 \end{bmatrix} $</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ ? &amp; ? \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdots \begin{bmatrix} a_0 &amp; 1 \\ 1 &amp; 0 \end{bmatrix} $</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ ? &amp; ? \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} &amp; k_{n-1} \\ ? &amp; ? \end{bmatrix} $</p>
<p>显然左式的底部可以确定</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ h_{n-1} &amp; k_{n-1} \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} &amp; k_{n-1} \\ ? &amp; ? \end{bmatrix} $</p>
<p>又因为递推关系，右边式子相当于左式带入n-1</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ h_{n-1} &amp; k_{n-1} \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} &amp; k_{n-1} \\ h_{n-2} &amp; k_{n-2} \end{bmatrix} $</p>
<p>综上</p>
<p>$h_n &#x3D; a_n \cdot h_{n-1} + h_{n-2}$<br>$k_n &#x3D; a_n \cdot k_{n-1} + k_{n-2}$</p>
<p>渐进值 $\frac{h_n}{k_n} &#x3D; \frac{a_n \cdot h_{n-1} + h_{n-2}}{a_n \cdot k_{n-1} + k_{n-2}}$</p>
<p>且根据计算过程，可知 $h_n,k_n$互质</p>
<h4 id="分子分母-相关等式"><a href="#分子分母-相关等式" class="headerlink" title="分子分母 相关等式"></a>分子分母 相关等式</h4><p>由上面的递推关系再递推有</p>
<p>$k_nh_{n-1}-k_{n-1}h_n&#x3D;-(k_{n-1}h_{n-2}-k_{n-2}h_{n-1})&#x3D;(-1)^n $, </p>
<p>$k_nh_{n-2}-k_{n-2}h_n&#x3D;a_n(k_{n-1}h_{n-2}-k_{n-2}h_{n-1})&#x3D;a_n(-1)^{n-1} $, </p>
<p>设无理数$\alpha$ 的精确表示为$[a_0,a_1,…,a_n,x_{n+1}]$,即是最后$a_{n+1}$替换为精确的非整数值$x_{n+1}$,有$1\leq a_{n+1}&lt;x_{n+1}&lt;a_{n+1}+1,(n&gt;&#x3D;1)$</p>
<h4 id="原无理数与渐进数的差值表达式"><a href="#原无理数与渐进数的差值表达式" class="headerlink" title="原无理数与渐进数的差值表达式"></a>原无理数与渐进数的差值表达式</h4><p>根据上方计算渐进值得到的公式，同理递推式有</p>
<p>$\alpha &#x3D;\frac{x_{n+1}h_n+h_{n-1}}{x_{n+1}k_n+k_{n-1}}  $</p>
<p>$\alpha - \frac{h_n}{k_n} &#x3D;\frac{x_{n+1}h_n+h_{n-1}}{x_{n+1}k_n+k_{n-1}} -\frac{h_n}{k_n} $</p>
<p>$&#x3D;\frac{h_{n-1}k_{n}-h_nk_{n-1}}{k_n(x_{n+1}k_n+k_{n-1})}$</p>
<p>$&#x3D;\frac{(-1)^n}{k_n(x_{n+1}k_n+k_{n-1})}$</p>
<p>$|\alpha -\frac{h_n}{k_n}| &#x3D;\frac{1}{k_n(x_{n+1}k_n+k_{n-1})} &lt; \frac{1}{k_n(a_{n+1}k_n+k_{n-1})} &#x3D; \frac{1}{k_nk_{n+1}}$</p>
<p>注意到k的递推式，容易发现它是单调递增的正整数,所以渐进分数真的是趋近(n趋于无限大，渐进分数趋进原无理数)</p>
<h4 id="原无理数与渐进数的差值绝对值单调递减"><a href="#原无理数与渐进数的差值绝对值单调递减" class="headerlink" title="原无理数与渐进数的差值绝对值单调递减"></a>原无理数与渐进数的差值绝对值单调递减</h4><p>$|k_n\alpha - h_n|$单调递减。</p>
<p>证明:</p>
<p>$|k_n\alpha - h_n| - |k_{n-1}\alpha - h_{n-1}|$</p>
<p>$ &#x3D; |k_n(\alpha - \frac{h_n}{k_n})| - |k_{n-1}(\alpha - \frac{h_{n-1}}{k_{n-1}})|$</p>
<p>$ &#x3D; \frac 1{x_{n+1}k_n+k_{n-1}} - \frac 1{x_{n}k_{n-1}+k_{n-2}} $</p>
<p>$ &#x3D; \frac {(x_{n}k_{n-1}+k_{n-2})-(x_{n+1}k_n+k_{n-1})}{(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {((a_n+\frac 1{x_{n+1}})k_{n-1}+k_{n-2})-(x_{n+1}k_n+k_{n-1})}{(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {(x_{n+1}(a_nk_{n-1}+k_{n-2})+k_{n-1})-x_{n+1}(x_{n+1}k_n+k_{n-1})}{x_{n+1}(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {(x_{n+1}k_n+k_{n-1})-x_{n+1}(x_{n+1}k_n+k_{n-1})}{x_{n+1}(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {(1-x_{n+1})(x_{n+1}k_n+k_{n-1})}{x_{n+1}(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})} &lt; 0$</p>
<hr>
<p>由此也可知$|\alpha - \frac{h_n}{k_n}|$单调递减</p>
<p>$|\alpha - \frac{h_n}{k_n}|-|\alpha -\frac{h_{n-1}}{k_{n-1}}|$</p>
<p>$&#x3D;\frac {|{k_n}\alpha-{h_n}|-\frac {k_n}{k_{n-1}}|{k_{n-1}}\alpha-{h_{n-1}}|}{k_n}$</p>
<p>$&lt;\frac {|{k_n}\alpha-{h_n}|-|{k_{n-1}}\alpha-{h_{n-1}}|}{k_n} &lt; 0$</p>
<p>&#x2F;&#x2F; 或者因为$k_n$单调递增</p>
<h4 id="和渐进数同分母的所有分数中，渐进数最接近原无理数"><a href="#和渐进数同分母的所有分数中，渐进数最接近原无理数" class="headerlink" title="和渐进数同分母的所有分数中，渐进数最接近原无理数"></a>和渐进数同分母的所有分数中，渐进数最接近原无理数</h4><p>若$(h_n,k_n)$是一个渐进分数，则对于分母$k_n$,分子取$h_n$时，整个分数最接近原无理数</p>
<p>取任意$h\neq h_n$,根据三角不等式</p>
<p>$|\alpha -\frac{h}{k_n}| \geq |\frac{h-h_n}{k_n}| - |\alpha - \frac{h_n}{k_n}|$</p>
<p>$&gt;\frac 1{k_n} - \frac 1{k_nk_{n+1}} $,因为n足够大 $k_{n+1}&gt;&#x3D;3$有</p>
<p>$&gt; \frac 1{k_n} - \frac 1{2k_n} $</p>
<p>$&#x3D;\frac 1{2k_n} $</p>
<p>$&gt;  \frac 1{k_nk_{n+1}} &gt; |\alpha -\frac{h_n}{k_n}|$</p>
<p>证明了$h_n$是最接近的分子</p>
<p>即 $|k_n\alpha - h|$在 $h&#x3D;h_n$时取最小值</p>
<h4 id="分母小于等于渐进数的分母的所有分数中，渐进数能使-分子x原无理数-分母-取最小值"><a href="#分母小于等于渐进数的分母的所有分数中，渐进数能使-分子x原无理数-分母-取最小值" class="headerlink" title="分母小于等于渐进数的分母的所有分数中，渐进数能使|分子x原无理数-分母|取最小值"></a>分母小于等于渐进数的分母的所有分数中，渐进数能使|分子x原无理数-分母|取最小值</h4><p>下面证明在$(0&lt;k\leq k_n)$中，对于所有$(h,k)$，有$|k_n\alpha -  h_n|$为最小值</p>
<p>考虑任意$(h,k),(0&lt;k&lt;k_n)$，且$\frac hk$的最简分数不是渐进数，（因为已经证明了渐进数随着n增大$|k\alpha - h|$单调递减，且渐进数分子分母互质，所以如果最简分数是渐进数则对应渐进数的该表达式 更大，又是分子分母是渐进数的倍数，则该表达式的结果还要乘上倍数会更大）</p>
<p>&#x2F;&#x2F; 同时它是最简分数，因为上表达式 带入分数和其最简分数得到的值刚好是其分子和其最简分数的分子的比值的倍数</p>
<p>设二元一次方程组</p>
<p>$h_nx+h_{n-1}y&#x3D;h$</p>
<p>$k_nx+k_{n-1}y&#x3D;k$</p>
<p>则有$(x,y)&#x3D;(\frac {hk_{n-1}-kh_{n-1}}{h_nk_{n-1}-h_{n-1}k_n},\frac {hk_{n}-kh_{n}}{h_nk_{n-1}-h_{n-1}k_n}) &#x3D; ((-1)^{n-1}(hk_{n-1}-kh_{n-1}),(-1)^{n-1}(hk_{n}-kh_{n}))$</p>
<p>因为$\frac hk$不是渐进分数，所以$x,y$都是非零整数，又因为$k&lt;k_n$和$k_nx+k_{n-1}y&#x3D;k$有:$x,y$异号</p>
<p>因为$\alpha - \frac {h_n}{k_n}$的分子为$(-1)^n$,分母为正数,</p>
<p>因此$\alpha - \frac {h_n}{k_n}$和$\alpha - \frac {h_{n-1}}{k_{n-1}}$异号</p>
<p>$k_n\alpha - {h_n}$和$k_{n-1}\alpha - {h_{n-1}}$异号</p>
<p>$x(k_n\alpha - {h_n})$和$y(k_{n-1}\alpha - {h_{n-1}})$同号</p>
<p>$|k\alpha -h| &#x3D; |(k_nx+k_{n-1}y)\alpha - (h_nx+h_{n-1}y)|$</p>
<p>$&#x3D; |x(k_n\alpha - {h_n}) + y(k_{n-1}\alpha - {h_{n-1}})|$,因为同号：</p>
<p>$&#x3D; |x(k_n\alpha - {h_n})|+|y(k_{n-1}\alpha - {h_{n-1}})|$，因为$x,y$非零整数:</p>
<p>$|k\alpha - h| &gt; |k_n\alpha - {h_n}|$且$|k\alpha -h|&gt;|k_{n-1}\alpha - {h_{n-1}}|$</p>
<p>内容得证</p>
<h4 id="连续的两个渐进数中至少有一个满足pell方程必要的不等式"><a href="#连续的两个渐进数中至少有一个满足pell方程必要的不等式" class="headerlink" title="连续的两个渐进数中至少有一个满足pell方程必要的不等式"></a>连续的两个渐进数中至少有一个满足pell方程必要的不等式</h4><p>至于为什么是这个标题 见后面的部分</p>
<p>连续的两个渐进数中至少有一个满足，$|\alpha - \frac hk|&lt;\frac 1{2k^2}$</p>
<p>证明:</p>
<p>假设都不满足，有</p>
<p>$0 \leq |\alpha-\frac{h_{n+1}}{k_{n+1}}| - \frac{1}{2k_{n+1}^2} + |\alpha-\frac{h_{n}}{k_{n}}|-\frac{1}{2k_{n}^2}$, 因为$\alpha - \frac{h_{n}}{k_{n}}$正负交替,所以</p>
<p>$ &#x3D; |\frac{h_{n+1}}{k_{n+1}}-\frac{h_{n}}{k_{n}}|-\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; |\frac{h_{n+1}k_{n}-h_{n}k_{n+1}}{k_{n+1}k_{n}}|-\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; \frac 1{k_nk_{n+1}} -\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; \frac 1{k_nk_{n+1}} -\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; \frac {-(k_n-k_{n+1})^2}{2k_{n}^2k_{n+1}^2} &lt; 0$</p>
<p>矛盾</p>
<p>因此至少有一个大于满足 得证</p>
<h4 id="任何最简分数如果满足pell方程必要的不等式，那么它是一个渐进分数"><a href="#任何最简分数如果满足pell方程必要的不等式，那么它是一个渐进分数" class="headerlink" title="任何最简分数如果满足pell方程必要的不等式，那么它是一个渐进分数"></a>任何最简分数如果满足pell方程必要的不等式，那么它是一个渐进分数</h4><p>任何最简分数如果满足$|\alpha - \frac hk|&lt;\frac 1{2k^2}$，那么它是个渐进分数</p>
<p>证明</p>
<p>设$\frac hk$满足不等式$|\alpha - \frac hk|&lt;\frac 1{2k^2}$，则存在n使得渐进数分母满足 $k_{n+2}&gt;k&gt;&#x3D;k_n $且$\frac {h_n}{k_n}$满足$|\alpha - \frac hk|&lt;\frac 1{2k^2}$(因为相邻渐进数必有一个满足,这里是取n和n+2之间)，根据上面的不等式 有$|k_n\alpha- h_n| &lt; |k\alpha - h|$，若$\frac hk \neq \frac{h_n}{k_n}$,即$k_n &lt; k$</p>
<p>$0 \leq \frac{|hk_n-h_nk|-1}{kk_n}$</p>
<p>$&#x3D; |\frac{h}{k}-\frac{h_n}{k_n}|-\frac{1}{kk_n}$,因为三角不等式，有</p>
<p>$\leq |\alpha -\frac{h}{k}|+|\alpha -\frac{h_n}{k_n}|-\frac{1}{kk_n}$, 因为假设满足的不等式</p>
<p>$&lt; \frac 1{2k^2} + \frac 1{k_n}|k_n\alpha - h_n|-\frac{1}{kk_n}$,因为上面的最小接近</p>
<p>$&lt; \frac 1{2k^2} + \frac 1{k_n}|k\alpha - h|-\frac{1}{kk_n}$</p>
<p>$&#x3D; \frac 1{2k^2} + \frac {k}{k_n}|\alpha - \frac hk|-\frac{1}{kk_n}$因为假设满足的不等式</p>
<p>$&lt; \frac 1{2k^2} + \frac {k}{k_n}\cdot \frac 1{2k^2}-\frac{1}{kk_n}$</p>
<p>$&#x3D; \frac {k_n-k}{2k^2k_n} &lt; 0$</p>
<p>矛盾，因此$\frac hk$和某个渐进数相等</p>
<p><strong>注记：最开始该文的版本，的渐进分数的部分直接使用的是pell方程中$\sqrt{d}$,其中d是非平方正整数，但为了写100需要的证明，需要把它扩充到实数，（当然也是成立的），所以这部分改写了一次</strong></p>
<h3 id="Lagrange’s-Theorem-二次无理数与有循环节的连分数"><a href="#Lagrange’s-Theorem-二次无理数与有循环节的连分数" class="headerlink" title="Lagrange’s Theorem 二次无理数与有循环节的连分数"></a>Lagrange’s Theorem 二次无理数与有循环节的连分数</h3><p>quadratic irrational(二次无理数) : 二次整式多项式的根 $\frac{-b\pm \sqrt{b^2-4ac}}{2a}$ 或者形如$\frac{P+\sqrt{D}}{Q}$</p>
<p> An irrational number is quadratic irrational if and only if its continued fraction is periodic.</p>
<h4 id="循环连分数一定是二次无理数"><a href="#循环连分数一定是二次无理数" class="headerlink" title="循环连分数一定是二次无理数"></a>循环连分数一定是二次无理数</h4><blockquote>
<p>先证明简单的一侧，循环连分数一定是二次根式的根。</p>
</blockquote>
<p>按照连分数的写法，将循环节设为t</p>
<p>显然还原为分数,有$x&#x3D;\frac{a t + b}{c t +d},t &#x3D; \frac{et+f}{gt+h}$ 变换左表达式t是x的函数，带入右侧表达式得到$\frac{ix+j}{kx+l} &#x3D; \frac{mx+n}{ox+p}$,其中字母$a-p$均为整数，且注意到x为无理数，所以化简后一定是二次方程</p>
<h4 id="二次无理数一定是循环连分数"><a href="#二次无理数一定是循环连分数" class="headerlink" title="二次无理数一定是循环连分数"></a>二次无理数一定是循环连分数</h4><blockquote>
<p>再证明二次根式的根一定能表达为有循环节的连分数</p>
</blockquote>
<p>定义,u对于无理数x</p>
<p>$f(x) &#x3D; x-1 (x&gt;1)$</p>
<p>$f(x) &#x3D; \frac{1}{\frac{1}{x}-1} , (x&lt;1)$</p>
<p>对应到连分展开，即是将首个数字减少1,(x&gt;1时就是a0减去1,x&lt;1时就是a1减去1)</p>
<p>令$x1&#x3D;x,x_{n+1}&#x3D;f(x_n)$,可以知道 这是一个无限数列</p>
<p>如果x满足$ax^2+bx+c&#x3D;0$,写作$x\in[a,b,c]$</p>
<p>那么x-1 满足$a(x-1)^2+(2a+b)(x-1)+(a+b+c) &#x3D; ax^2+b+c&#x3D;0$</p>
<p>那么$\frac{x}{1-x}$ 满足$(a+b+c)(\frac{x}{1-x})^2+(b+2c)\frac{x}{1-x}+c &#x3D; 0$</p>
<p>所以f(x)满足 $f(x)\in [a,2a+b,a+b+c]$ 或 $f(x)\in [a+b+c,b+2c,c]$</p>
<p>不失一般性，写作$x_n\in[s_n,t_n,u_n]$,有 $s_n &gt; 0$, 否则把三元组同时换号</p>
<p>注意到上式 $(2a+b)^2-4a(a+b+c)&#x3D;b^2-4ac&#x3D;(b+2c)^2-4(a+b+c)c$</p>
<p>说明了 $t_n^2-4s_nu_n$是和n无关的值</p>
<p>如果只有有限个$u&lt;0$,那么从某一处开始，$s&gt;0,u&gt;0$且$t&lt;0$(因为 x &gt; 0)</p>
<p>那么意味着 $-t$ 严格单调递减并且非负，(因为 t的变化关系是 t&#x3D;2s+t或者 t&#x3D;t+2u),矛盾</p>
<p>所以有无限个$s_nu_n&lt;0$</p>
<p>注意到 $t_n^2-4s_nu_n$是常数，所以 至少有一个三元组$[s_n,t_n,u_n]$ 出现了三次,一个二次方程有两个解，所以有满足的$x_n&#x3D;x_m,m&gt;n$</p>
<p>得证 连分数展开有循环</p>
<p>Theorem 1. If x is a positive quadratic irrational then its continued fraction is eventually periodic.</p>
<h3 id="Galois’-Theorem-纯循环连分数与reduced二次无理数"><a href="#Galois’-Theorem-纯循环连分数与reduced二次无理数" class="headerlink" title="Galois’ Theorem 纯循环连分数与reduced二次无理数"></a>Galois’ Theorem 纯循环连分数与reduced二次无理数</h3><p>Definition 1.24. x 是二次无理数的根，$\overline{x}$ 是另一个根，那么如果 x &gt; 1 且 $-1 &lt; \overline{x} &lt; 0$.那么称 x 为 reduced</p>
<p>Theorem 1.25. (Galois’ Theorem) 无理数a. a是纯循环连分数（从a0开始的循环节），当且仅当 x is reduced. If $x &#x3D; [\overline{a_0, a_1, a_2, . . . , a_{l−1}}]$ and $\overline{x}$ 是它共轭实数, then $-\frac{1}{x} &#x3D; [\overline{a_{l−1}, . . . , a_2, a_1}].$</p>
<h4 id="reduced二次无理数-是-纯循环连分数"><a href="#reduced二次无理数-是-纯循环连分数" class="headerlink" title="reduced二次无理数 是 纯循环连分数"></a>reduced二次无理数 是 纯循环连分数</h4><p>设二次无理数$x&#x3D;[a_0,a_1,…,a_n], x&gt;1,-1&lt;\overline{x}&lt;0$</p>
<p>那么有 $x_{n+1}&#x3D;\frac{1}{x_n-a_n}$ &#x2F;&#x2F; 表示 按照展开从n处向后取值</p>
<p>$\overline{x_{n+1}} &#x3D; \frac{1}{\overline{x_n-a_n}} &#x3D; \frac{1}{\overline{x_n}-a_n}$,(因为 两个形如$A+B\sqrt{C}$的无理数相乘为有理数，说明相乘后的无理数的系数为0,所以更改其中一个无理数的系数的正负，另一个无理数系数的正负更改即可)</p>
<p>注意到$x_1 \ge 1$有$a_0 \ge 1$,所以 $a_n \ge 1$</p>
<p>下面归纳证明 $-1 &lt; \overline{x_n} &lt; 0 $</p>
<p>若 $-1 &lt; \overline{x_n} &lt; 0$</p>
<p>有 $\frac{1}{\overline{x_{n+1}}} &#x3D; \overline{x_n} - a_n &lt; -1$</p>
<p>即 $-1 &lt; \overline{x_{n+1}} &lt; 0$，得证</p>
<p>$-1 &lt; \overline{x_n} &#x3D; \frac{1}{\overline{x_{n+1}}}+a_n &lt; 0$</p>
<p>$ 1 &gt; -\frac{1}{\overline{x_{n+1}}}-a_n &gt; 0$</p>
<p>$ a_n &#x3D; [ -\frac{1}{\overline{x_{n+1}}} ] $ &#x2F;&#x2F; 也就是$a_n$等于分式的整数部分</p>
<p>因为上面已经证明 如果是二次无理数，那么必定有循环节，所以存在$x_i &#x3D; x_j,(i &lt; j )$</p>
<p>即$\overline{x_i}&#x3D;\overline{x_j}$</p>
<p>即$a_{i-1}&#x3D;[-\frac{1}{\overline{x_i}}]&#x3D;[-\frac{1}{\overline{x_j}}] &#x3D; a_{j-1}$</p>
<p>即$x_{i-1}&#x3D;a_{i-1}+\frac{1}{x_i} &#x3D; a_{j-1}+\frac{1}{x_j} &#x3D; x_{j-1}$, 意义就是如果两个后缀相等，那么它们各向前一个 也相等，综上逐步迭代$a_0 &#x3D;a_{j-i}$ </p>
<p>因此证明了 如果一个二次无理数是 reduced，那么它是个纯循环连分数</p>
<h4 id="纯循环连分数-是-reduced"><a href="#纯循环连分数-是-reduced" class="headerlink" title="纯循环连分数 是 reduced"></a>纯循环连分数 是 reduced</h4><p>首先有循环节的连分数一定是二次无理数（上面证过了)</p>
<p>因为是纯循环，所以$a_0 \ge 1$,所以$a_n \ge 1$,有$x &gt; 1$</p>
<p>假设周期为n, 有 $x_n &#x3D; x &#x3D; [\overline{a_0,a_1,…,a_{n-1}}]$</p>
<p>根据上面推过的递推式 $x &#x3D; \frac{x_nh_{n-1}+h_{n-2}}{x_nk_{n-1}+k_{n-2}} &#x3D; \frac{xh_{n-1}+h_{n-2}}{xk_{n-1}+k_{n-2}}$</p>
<p>化简 $k_{n-1}x^2+(k_{n-2}-h_{n-1})x-h_{n-2}&#x3D;0$</p>
<p>也就是证明这个方程除了x (我们已经有 $x&gt;1$了)的另一个根$\overline{x}$满足$-1 &lt; \overline{x} &lt; 0$</p>
<p>$x &#x3D; 0$时 原式子 $&#x3D;-h_{n-2} &lt; 0$</p>
<p>$x &#x3D; 1$时 原式子 </p>
<p>$&#x3D; k_{n-1}+(h_{n-1}-k_{n-2})-h_{n-2}$</p>
<p>$&#x3D; (a_{n-1}k_{n-2}+k_{n-3}) + (a_{n-1}h_{n-2}+h_{n-3}) -k_{n-2}-h_{n-2}$</p>
<p>$&#x3D; (a_{n-1}-1)(h_{n-2}+k_{n-2}) + (h_{n-3}+k_{n-3}) $</p>
<p>$ &gt; 0 $</p>
<p>说明了另一个根$-1 &lt; \overline{x} &lt; 0$</p>
<p>至此我们证明了 reduced 和 纯循环之间的 充要</p>
<h4 id="reduced二次无理数-纯循环连分数的-原无理数与它的共轭相反倒数的连分数数值关系"><a href="#reduced二次无理数-纯循环连分数的-原无理数与它的共轭相反倒数的连分数数值关系" class="headerlink" title="reduced二次无理数 纯循环连分数的 原无理数与它的共轭相反倒数的连分数数值关系"></a>reduced二次无理数 纯循环连分数的 原无理数与它的共轭相反倒数的连分数数值关系</h4><p>最后证明 If $x &#x3D; [\overline{a_0, a_1, a_2, . . . , a_{l−1}}]$ and $\overline{x}$ 是它共轭实数, then $-\frac{1}{x} &#x3D; [\overline{a_{l−1}, . . . , a_2, a_1,a_0}].$</p>
<p>Step 1</p>
<p>考虑有限的连分数 $x &#x3D; [a_0,a_1,…,a_n], y&#x3D;[a_n,a_{n-1},…,a_0] , a_i &gt; 0$</p>
<p>$h_n,k_n$为x的分子分母，$h_n’,k_n’$为y的分子分母</p>
<p>要证明 $\frac{h_n}{h_{n-1}} &#x3D; \frac{h_n’}{k_n’}$ 且 $\frac{k_n}{k_{n-1}} &#x3D; \frac{h_{n-1}’}{k_{n-1}’}, n \ge 1$ 且分子分母对应相等(因为是最简分数，所以只要证明了分数相等就有对应相等了)</p>
<p>注意到上面 $h_n &#x3D; a_n \cdot h_{n-1} + h_{n-2}$,同时除以 $h_{n-1}$</p>
<p>$\frac{h_n}{h_{n-1}} &#x3D; a_n + \frac{1}{\frac{h_{n-1}}{h_{n-2}}}$</p>
<p>递归展开 可以得到 $\frac{h_n}{h_{n-1}} &#x3D; [a_n,a_{n-1},…,a_0]$,</p>
<p>注意到 $k_n &#x3D; a_n \cdot k_{n-1} + k_{n-2}$,同理 $\frac{k_n}{k_{n-1}} &#x3D; [a_n,a_{n-1},…,a_1] $(注意是$a_1$不是$a_0$)</p>
<p>根据上面的<code>递归展开的结论</code> 和 <code>y的分子分母定义</code>有</p>
<p>$\frac{h_{n+1}}{h_n} &#x3D; [a_{n+1},a_n,…,a_0] &#x3D; \frac{h_{n+1}’}{k_{n+1}’}$</p>
<p>$\frac{k_{n+1}}{h_n} &#x3D; [a_{n+1},a_n,…,a_1] &#x3D; \frac{h_{n}’}{k_{n}’}$</p>
<p>且分子分母对应相等</p>
<p>Step 2</p>
<p>若x 是纯循环连分数数(即reduced 二次无理数)，那么显然$-\frac{1}{\overline{x}}$也是 reduced的二次无理数，那么它也是纯循环</p>
<p>假设直接取 n+1 &#x3D; 两个循环节长度的最小公倍数</p>
<p>$k_{n}x^2+(k_{n-1}-h_{n})x-h_{n-1}&#x3D;0$</p>
<p>令</p>
<p>$y &#x3D; [\overline{a_n,a_{n-1},…,a_0}] &#x3D; [a_n,a_{n-1},…,a_0,y]$</p>
<p>$y &#x3D; \frac{h_n’y+h_{n-1}’}{k_n’y+k_{n-1}’}$</p>
<p>因为Step 1 我们证明了对应相等$h_n&#x3D;h_n’,k_{n-1}&#x3D;k_{n-1}’, h_{n-1}&#x3D;k_{n}’,h_{n-1}’&#x3D;k_n$</p>
<p>所以做对应替换,$y &#x3D; \frac{h_ny+k_{n}}{h_{n-1}y+k_{n-1}}$</p>
<p>$k_{n}{(-\frac{1}{y})}^2+(k_{n-1}-h_{n})(-\frac{1}{y})-h_{n-1}&#x3D;0$</p>
<p>$-\frac{1}{y} &#x3D; \overline{x}$ 得证(y为正 所以 不可能等于x)</p>
<p>至此 Theorem 1.25. (Galois’ Theorem) 无理数a. a是纯循环连分数（从a0开始的循环节），当且仅当 x is reduced. If $x &#x3D; [\overline{a_0, a_1, a_2, . . . , a_{l−1}}]$ and $\overline{x}$ 是它共轭实数, then $-\frac{1}{\overline{x}} &#x3D; [\overline{a_{l−1}, . . . , a_2, a_1}].$ 得证</p>
<h4 id="根号n-的-连分数性质"><a href="#根号n-的-连分数性质" class="headerlink" title="根号n 的 连分数性质"></a>根号n 的 连分数性质</h4><p>Theorem 1.26 d是非平方数,那么$\sqrt{d} &#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,…,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</p>
<p>也就是 是从第二位开始循环节，且循环节最后一个是它的整部的2倍，且剩余部分是回文</p>
<p>令$x&#x3D;\lfloor \sqrt{d} \rfloor + \sqrt{d}$ 则$\overline{x} &#x3D; \lfloor \sqrt{d} \rfloor - \sqrt{d}$</p>
<p>注意它们的取值范围发现x是reduced 二次无理数</p>
<p>因此 $ x &#x3D; \lfloor \sqrt{d} \rfloor + \sqrt{d} &#x3D; [\overline{2\lfloor \sqrt{d} \rfloor,a_1,a_2,…,a_{l-1}}]$</p>
<p>$ &#x3D; [2\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,…,a_{l-1},2\lfloor \sqrt{d} \rfloor}]$</p>
<p>$ \sqrt{d}&#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,…,a_{l-1},2\lfloor \sqrt{d} \rfloor}]$</p>
<p>根据Galois’ Theorem我们有</p>
<p>$\frac{1}{\sqrt{d}-\lfloor \sqrt{d} \rfloor} &#x3D; -\frac{1}{\overline{x}} &#x3D; [\overline{a_{l-1},…,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</p>
<p>也就是$\sqrt{d} &#x3D; [\lfloor \sqrt{d} \rfloor,\frac{1}{\sqrt{d}-\lfloor \sqrt{d} \rfloor}]$</p>
<p>$ &#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_{l-1},…,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</p>
<p>因此得证 循环内容和 回文性质</p>
<h2 id="Solution-to-Pell’s-Equation"><a href="#Solution-to-Pell’s-Equation" class="headerlink" title="Solution to Pell’s Equation"></a>Solution to Pell’s Equation</h2><p>因为平方带来的对称性，只考虑(x&gt;0,y&gt;0)的解</p>
<h3 id="根号n的连分数渐进分数的性质"><a href="#根号n的连分数渐进分数的性质" class="headerlink" title="根号n的连分数渐进分数的性质"></a>根号n的连分数渐进分数的性质</h3><h4 id="一个引理"><a href="#一个引理" class="headerlink" title="一个引理"></a>一个引理</h4><p>若d为非平方数，$x&#x3D;\sqrt{d}$,</p>
<p>则对于任意n，存在整数$Q_n,P_n$满足$ x_n&#x3D;\frac{P_n+\sqrt{d}}{Q_n}$和$d-P_n^2 &#x3D; 0 (\bmod Q_n)$</p>
<p>显然n&#x3D;0时$(P_0,Q_0) &#x3D; (0,1)$满足,然后归纳法，若 n时能满足上述两点性质，则</p>
<p>$x_{n+1} &#x3D; \frac{1}{x_n-a_n}$</p>
<p>$&#x3D;\frac{1}{\frac{P_n+\sqrt{d}}{Q_n}-a_n}$</p>
<p>$&#x3D;\frac{Q_n}{P_n+\sqrt{d}-a_n{Q_n}}$ (通过分母有理化:</p>
<p>$&#x3D;\frac{Q_n(P_n-a_nQ_n-\sqrt{d})}{(P_n-a_nQ_n)^2-d}$</p>
<p>$&#x3D;\frac{a_nQ_n-P_n+\sqrt{d}}{\frac{d-(P_n-a_nQ_n)^2}{Q_n}}$</p>
<p>$(Q_{n+1},P_{n+1}) &#x3D; (\frac{d-(P_n-a_nQ_n)^2}{Q_n},a_nQ_n-P_n)$</p>
<p>现在要证明的就是 它是满足$\frac{P_{n+1}+\sqrt{d}}{Q_{n+1}}$的形式,并且满足上面的取模</p>
<p>也就是要证明$P_{n+1}$是整数(显然) 和 $Q_{n+1}$是整数</p>
<p>$Q_{n+1} &#x3D; \frac{d-P_n^2}{Q_n}+2a_nP_n-a_n^2Q_n$</p>
<p>因为n时有 $d-P_n^2 &#x3D; 0 (\bmod Q_n)$所以 $Q_{n+1}$是整数</p>
<p>又因为$Q_nQ_{n+1}&#x3D;d-P_{n+1}^2$ 所以  $d-P_{n+1}^2 &#x3D; 0 (\bmod Q_{n+1})$ 得证</p>
<h4 id="直指pell方程左侧表达式"><a href="#直指pell方程左侧表达式" class="headerlink" title="直指pell方程左侧表达式"></a>直指pell方程左侧表达式</h4><p>对于$n \ge 2$ 要证明 $h_{n-1}^2-d k_{n-1}^2&#x3D;(-1)^n Q_n$</p>
<p>证明:</p>
<p>$\sqrt{d} &#x3D; \frac{x_n h_{n-1}+h_{n-2}}{x_nk_{n-1}+k_{n-2}}$</p>
<p>把$ x_n &#x3D; \frac{P_n+\sqrt{d}}{Q_n}$带入并通分化简</p>
<p>$(P_nk_{n-1}+Q_nk_{n-2}-h_{n-1})\sqrt{d} &#x3D; P_nh_{n-1}+h_{n-2}Q_n-k_{n-1}d$</p>
<p>即 $P_nk_{n-1}+Q_nk_{n-2}&#x3D;h_{n-1}$ 且 $P_nh_{n-1}+h_{n-2}Q_n&#x3D;k_{n-1}d$</p>
<p>所以有 $h_{n-1}^2-dk_{n-1}^2 &#x3D; h_{n-1}(P_nk_{n-1}+Q_nk_{n-2})-k_{n-1}(P_nh_{n-1}+h_{n-2}Q_n)$</p>
<p>$&#x3D; Q_n(h_{n-1}k_{n-2}-h_{n-2}k_{n-1})$</p>
<p>$&#x3D; (-1)^nQ_n$</p>
<h3 id="最后一步-连分数和pell方程的关系"><a href="#最后一步-连分数和pell方程的关系" class="headerlink" title="最后一步 连分数和pell方程的关系"></a>最后一步 连分数和pell方程的关系</h3><p>首先假设 (x,y)是 pell方程$x^2-dy^2&#x3D;1$的解$(d&gt;1,x&gt;y&gt;0)$，所以</p>
<p>$|\sqrt{d} - \frac{x}{y}| &#x3D; |\frac{dy^2-x}{y^2(\sqrt{d}+\frac{x}{y})}| &lt; \frac{1}{2y^2}$ (从一定程度上说明了 为什么前面要去证明 小于$\frac{1}{2y^2}$</p>
<p>根据前面推的 我们知道满足这个表达式的一定是 渐进值</p>
<p>(Yang.pdf那个paper下面的部分蛮多笔误的 不过能看懂证明思路)</p>
<p>因为我们上面有 $h_{n-1}^2-dk_{n-1}^2&#x3D;(-1)^nQ_n$ 也就是如果要满足pell方程 那么$|Q_n|&#x3D;1$，分类讨论$Q_n$</p>
<p>假设 $\sqrt{d}$的 最小周期长度为l</p>
<h4 id="分类讨论-Q-x3D-1"><a href="#分类讨论-Q-x3D-1" class="headerlink" title="分类讨论 Q &#x3D; -1"></a>分类讨论 Q &#x3D; -1</h4><p>$Q_n \neq -1, n &gt; 0$</p>
<p>证明</p>
<p>注意到上面根据$\sqrt{d}$的表达式 证明了$n&gt;0$时，$x_n$是纯循环连分数，也就是reduced</p>
<p>如果$Q_n &#x3D; -1$ 因为$x_n&#x3D;\frac{P_n+\sqrt{d}}{Q_n}$,所以有 $x_n&#x3D;-P_n-\sqrt{d} &gt; 1$,有$-1&lt;-P_n+\sqrt{d} &lt; 0$ (Galois)</p>
<p>有 $\sqrt{d} &lt; P_n &lt; -\sqrt{d} - 1$ 矛盾 所以$Q_n \neq -1$, 对于$Q_0 &#x3D; 1$也满足,得证</p>
<h4 id="分类讨论-Q-x3D-1-1"><a href="#分类讨论-Q-x3D-1-1" class="headerlink" title="分类讨论 Q &#x3D; 1"></a>分类讨论 Q &#x3D; 1</h4><p>$Q_n &#x3D; 1$当且仅当n为循环节长度的倍数才有</p>
<p>证明</p>
<p>若于$n&gt;1$若$Q_n&#x3D;1$那么有$x_n&#x3D;P_n+\sqrt{d}$，它的共轭 $-1 &lt; P_n-\sqrt{d} &lt; 0$ 即 $P_n&#x3D;\lfloor \sqrt{d} \rfloor$所以 $x_n &#x3D; \lfloor \sqrt{d} \rfloor + \sqrt{d}$</p>
<p>$ \lfloor \sqrt{d} \rfloor +\sqrt{d} &#x3D; x_n &#x3D; 2\lfloor\sqrt{d}\rfloor + \frac{1}{\frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}} $ 即 $ x_{n+1} &#x3D; \frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}$</p>
<p>$ \sqrt{d} &#x3D; x_0 &#x3D; \lfloor \sqrt{d} \rfloor + \frac{1}{\frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}}$ 即 $x_1 &#x3D; \frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}$</p>
<p>说明了 它的下一个数$x_{n+1} $和$x_1$相等, 这说明如果$Q_n &#x3D; 1$ 那么n是当且仅当循环节长度的倍数(如果为1则循环节长度)</p>
<p>如果n是循环节倍数 有</p>
<p>$\frac{P_{kl}+\sqrt{d}}{Q_{kl}} &#x3D; x_{kl} &#x3D; [\overline{2\lfloor \sqrt{d} \rfloor,a_1,a_2,…,a_{l-1}}] &#x3D; \sqrt{d}+\lfloor\sqrt{d}\rfloor,(k&gt;0)$</p>
<p>$(P_{kl},Q_{kl}) &#x3D; (\lfloor\sqrt{d}\rfloor,1)$</p>
<p>对于n&#x3D;0也满足，充要得证</p>
<h4 id="完结"><a href="#完结" class="headerlink" title="完结"></a>完结</h4><p>最后回到这里 $h_{n-1}^2-dk_{n-1}^2&#x3D;(-1)^nQ_n &#x3D; (-1)^n $ 也就是再看个奇偶，最后得到了pell方程和连分数比较紧密的结论</p>
<p>假设 $\sqrt{d}$的 最小周期长度为l</p>
<p>那么对应pell 方程的最小解</p>
<p>$(x,y) &#x3D; {h_{l-1},k_{l-1}}$ 长度为偶数</p>
<p>$(x,y) &#x3D; {h_{2l-1},k_{2l-1}}$ 长度为奇数</p>
<h2 id="回顾历程"><a href="#回顾历程" class="headerlink" title="回顾历程"></a>回顾历程</h2><ol>
<li>pell方程基础解</li>
<li>pell方程解存在性</li>
<li>连分数分子分母递推式</li>
<li>连分数，分子分母相关性质(分子分母互质性,原无理数与渐进数差值表达式，差值绝对值单调递减性，连分数是最给定分母以及更小分母中最接近原无理数，任何满足“某不等式”的数字是渐进数（这个不等式是pell方程 的必要条件）)</li>
<li>Lagrange’s Theorem 二次无理数与有循环节的连分数</li>
<li>Galois’ Theorem 纯循环连分数与reduced二次无理数</li>
<li>根号n的连分数性质（精确的$\frac{P_n+\sqrt{d}}{Q_n}$表示 和 形如pell方程 与$Q_n$的等式）</li>
<li>分类讨论$Q_n$与n的取值最后的结论</li>
</ol>
<p>方法涉及</p>
<ol>
<li>二项式展开，不等式，唯一最小(有术语吗)，无理数，反证法</li>
<li>反复抽屉原理，绝对值，无理数，模运算</li>
<li>矩阵乘法，归纳法&#x2F;递推关系</li>
<li>归纳法&#x2F;递推，互质，不等式放缩，三角不等式，反证法，二元一次方程组，巧妙正负值+不等式。 很多方法都是多次</li>
<li>归纳，反证，单调+整数离散+有限，二次函数</li>
<li>共轭实数，反向推，归纳法</li>
<li>归纳法,上面的分子分母等式性质</li>
<li>-1的幂次,分类讨论，Lagrange,Galois</li>
</ol>
<p>然后还有很多整数的离散性质</p>
<p>证明过程感受</p>
<ol>
<li>如果有证明方向，看上去还挺自然的思路</li>
<li>正过来倒过去看，不明白为什么能想到去先找那个不等式,以及中间的X,Y和取值是怎样的思想</li>
<li>挺自然</li>
<li>其实这里都是 为了那个pell方程的必要条件，但是怎么想到这一条路径。另外就是这里面二元一次方程组感觉是不是和上面X,Y是同样的思路，但是我都没有理解到思想根源，怎么能在证明之前，先去做一个分式最后证明这个分式是整数。另外就是这些反复用于后面证明的一些分子分母等式性质。还有一个我不太会的就是多级放缩，到底是原作者自己多次调整最后得出的过程，还是说有什么思路能做到多次放缩来完成目标不等式证明(或反证)</li>
<li>这里的充分和必要完全不是一个难度，这个三元组的设计还是很能简化描述, 我想的方向是去做精确表达式，再做范围，如果证到有限范围即可，总之自己没证明到</li>
<li>reduced的性质在这里我不知道怎么用，也不知道为什么要，结果是后面证明需要结论</li>
<li>假设给我要证明的目标，这里可能如果我自己来证明会有一个基本去做的归纳目标，但是证明过程中会衍生出额外的证明目标</li>
<li>难点在说要怎么想到去找$h_{n-1}^2-dk_{n-1}^2&#x3D;(-1)^nQ_n$这个方向去证，而后面的分类讨论就比较自然</li>
</ol>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><p>似乎还不足以写代码?，下面的问题是 如何得到根号n的连分数呢？ 手工三元组(分母整数，有理分子整数，无理分子的系数整数)是一个办法，有没有更好的办法呢。</p>
<p>但我们至少说能证明了这个结论</p>
<p>python3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> gcd(b, a % b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">i, p</span>):</span><br><span class="line">    sq = <span class="built_in">int</span>(i**(<span class="number">0.5</span>))</span><br><span class="line">    <span class="keyword">if</span> sq * sq == i:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    hk = ((<span class="number">1</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">    <span class="comment"># a, b, c =&gt; (a+b*sqrt&#123;d&#125;)/c</span></span><br><span class="line">    cur = (<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> cur[<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">or</span> hk[<span class="number">0</span>][<span class="number">0</span>]*hk[<span class="number">0</span>][<span class="number">0</span>] - i*hk[<span class="number">0</span>][<span class="number">1</span>]*hk[<span class="number">0</span>][<span class="number">1</span>] != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> p:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;x_&quot;</span>, idx, <span class="string">&quot; = &quot;</span>, cur)</span><br><span class="line">        z = <span class="built_in">int</span>((cur[<span class="number">0</span>] + cur[<span class="number">1</span>] * (i**(<span class="number">0.5</span>)))/cur[<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">if</span> p:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;a_&quot;</span>, idx, <span class="string">&quot; = &quot;</span>,  z)</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">        <span class="comment"># z 1</span></span><br><span class="line">        <span class="comment"># 1 0</span></span><br><span class="line">        <span class="comment">#    hk 00 01</span></span><br><span class="line">        <span class="comment">#       10 11</span></span><br><span class="line">        newhk = (</span><br><span class="line">            ((hk[<span class="number">0</span>])[<span class="number">0</span>]*z+(hk[<span class="number">1</span>])[<span class="number">0</span>], (hk[<span class="number">0</span>])[<span class="number">1</span>]*z+(hk[<span class="number">1</span>])[<span class="number">1</span>]),</span><br><span class="line">            ((hk[<span class="number">0</span>])[<span class="number">0</span>], (hk[<span class="number">0</span>])[<span class="number">1</span>])</span><br><span class="line">        )</span><br><span class="line">        hk = newhk</span><br><span class="line">        <span class="keyword">if</span> p:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;hk = &quot;</span>, hk)</span><br><span class="line">        a = cur[<span class="number">0</span>]</span><br><span class="line">        b = cur[<span class="number">1</span>]</span><br><span class="line">        c = cur[<span class="number">2</span>]</span><br><span class="line">        <span class="comment"># c/(a+b*sqrt&#123;i&#125;-c*z)</span></span><br><span class="line">        <span class="comment"># c*(a-b*sqrt&#123;i&#125;-cz)/((a-cz)^2-b^2*i)</span></span><br><span class="line">        nv = (c*(a-c*z), -c*b, (a-c*z)*(a-c*z)-b*b*i)</span><br><span class="line">        cm = gcd(<span class="built_in">abs</span>(nv[<span class="number">0</span>]), <span class="built_in">abs</span>(nv[<span class="number">1</span>]))</span><br><span class="line">        cm = gcd(cm, <span class="built_in">abs</span>(nv[<span class="number">2</span>]))</span><br><span class="line">        nv = (nv[<span class="number">0</span>]/cm, nv[<span class="number">1</span>]/cm, nv[<span class="number">2</span>]/cm)</span><br><span class="line">        <span class="keyword">if</span> nv[<span class="number">2</span>] &lt; <span class="number">0</span>:</span><br><span class="line">            nv = (-nv[<span class="number">0</span>], -nv[<span class="number">1</span>], -nv[<span class="number">2</span>])</span><br><span class="line">        cur = nv</span><br><span class="line">    <span class="keyword">return</span> hk[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    ans = (<span class="number">0</span>, (<span class="number">1</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">1001</span>):</span><br><span class="line">        newans = calc(i, <span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">if</span> newans[<span class="number">0</span>] &gt; ans[<span class="number">1</span>][<span class="number">0</span>]:</span><br><span class="line">            ans = (i, newans[:])</span><br><span class="line">        <span class="built_in">print</span>(i, <span class="string">&quot; -&gt; &quot;</span>, newans)</span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到x的值会达到十进制的38位，暴力不可取!即使用了上面分析出的一些晓得性质最多优化661倍 依然是能有10的35次方的数量级。</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Continued_fraction">Continued fraction</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pell%27s_equation">Pell equation</a></p>
<p><a target="_blank" rel="noopener" href="https://www.math.uchicago.edu/~may/VIGRE/VIGRE2008/REUPapers/Yang.pdf">Yang.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://crypto.stanford.edu/pbc/notes/contfrac/pell.html">stanford crypto pell</a></p>
<p><a target="_blank" rel="noopener" href="http://sites.millersville.edu/bikenaga/number-theory/periodic-continued-fractions/periodic-continued-fractions.html">millersville periodic-continued-fractions</a></p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=E51GKQ1qorE">YouTube:Number Theory:Pell’s Equation part 1</a></p>
<p><a target="_blank" rel="noopener" href="https://dspace.sunyconnect.suny.edu/bitstream/handle/1951/69917/fulltext.pdf?sequence=1&isAllowed=y">A short proof and generalization of Lagrange’s theorem on continued fractions</a></p>
<p><a target="_blank" rel="noopener" href="http://sites.millersville.edu/bikenaga/number-theory/purely-periodic-continued-fractions/purely-periodic-continued-fractions.html">purely periodic continued fractions</a></p>
<h1 id="总结-amp-感受"><a href="#总结-amp-感受" class="headerlink" title="总结&amp;感受"></a>总结&amp;感受</h1><p>有些结论在证明过程中其实是缩小了范围，有些结论其实放大定义域之类也是成立的，但我们在证明过程中却只使用了我们所需要的部分。这类的从定义域和对应的要证明的逻辑不是“完美对应”的，但是足够，不知道是好还是不好。</p>
<p>证明的结论之间引用过程，感觉画成网状或者树状关系图会更好？</p>
<p>看youtube了上的讲解视频，会发现有一种写代码的抽取函数感觉，和我上面完全拆开证明不一样，抽函数的感觉其实在数学里大概是叫做“令”+“引理”，感觉和完全展开比较，的确能减少很多心智负担啊！如果你也能打开youtube建议去看看</p>
<p>另外比如有些 强结论要用的时候，即使你证出了相对弱的结论，但没有证明出强结论，其实相当于“没有用”，比如上面 基础解，的平方，的n次方，和任意另一组解能产生新的解的证明。当然如果能证明出，那些就是过程了，但不是步骤（虽然我上面有写进文中，因为要简洁整理的话，直接强结论证明，即可其它的弱的可以直接省略</p>
<p>虽然视频看的时候的确感觉到老师和同学的口算不如国内，但自从自己思考过十进制的意义以后，感觉数值计算都不再重要，有的是计算机，不需要人类来算。</p>
<p>youtuber james cook 有证明一个 同系数二元二次方程 之间的关系，可以用它来 从 不是解的东西里生成解(感觉好像不是特别行，因为一个等式的 四个值仅仅由两个变量控制而不是3个？)！(Quadradic Forms) Q(u+v)+Q(u-v)&#x3D;2(Q(u)+Q(v)),然后以此建立树，考虑其中的“正负交替路线”river</p>
<p>多核没智力还是搞不动数学啊,</p>
<p>这篇文章整理了很多篇其它资料，所以在符号使用上还不够统一，之后看有空整理一下</p>
<p>在我快写完这一篇文章的时候发现了 一个<a target="_blank" rel="noopener" href="https://chaoli.club/index.php/2756/0">超理论坛-连分数入门</a> 注册需要一点点水平XD，这篇是带着例子讲解写的！(大自看了一下 感觉很棒 推荐), 又 有些性质证明方式不止一种，例如我本篇文章所抄来的证明 二次无理数和有循环节的充要 会感觉更漂亮一些</p>
<p>有些paper写到后面还是很多笔误，不过看通了也是能理解具体过程</p>
<p>有一个想法是 哪些结论是关键或者说证明的难点，其实可以这样想，现在，把文章中一些部分换成填空，你还能不能补全整个文章，不需要完全一样，只要能证明就行。这样想的话，就会知道所谓的难点是在哪。</p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>作者： </strong>Xiao Ye
  </li>
  <li class="post-copyright-link">
      <strong>文章連結：</strong>
      <a href="https://yexiaorain.github.io/Blog/pe/066/" title="project euler 066 diophantine equation">https://yexiaorain.github.io/Blog/pe/066/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版權聲明： </strong>本網誌所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 許可協議。轉載請註明出處！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/Blog/tags/%E6%95%B0%E5%AD%A6/" rel="tag"><i class="fa fa-tag"></i> 数学</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/Blog/2020-04-27-tencent042C/" rel="prev" title="tencent 04 26 C 状压DP入门">
                  <i class="fa fa-chevron-left"></i> tencent 04 26 C 状压DP入门
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/Blog/pe/075/" rel="next" title="project euler 075 Singular integer right triangles">
                  project euler 075 Singular integer right triangles <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiao Ye</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">443k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">24:37</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="回到頂端">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/Blog/js/comments.js"></script><script src="/Blog/js/utils.js"></script><script src="/Blog/js/schemes/muse.js"></script><script src="/Blog/js/next-boot.js"></script><script src="/Blog/js/bookmark.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/Blog/js/third-party/search/local-search.js"></script>






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/Blog/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":false,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://yexiaorain.github.io/Blog/pe/066/"}</script>
  <script src="/Blog/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"yexiaorain","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/Blog/js/third-party/comments/disqus.js"></script>

</body>
</html>
