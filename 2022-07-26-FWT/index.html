<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.0 -->
    <script>
        window.materialVersion = "1.5.0"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">














    <!-- Title -->
    
    <title>
        
            从FFT 到 FWHT 快速沃尔什-阿达玛转换(Walsh Hadamard transform) | 
        
        Blog
    </title>

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Xiao Ye">
    <meta name="description" itemprop="description" content>
    <meta name="keywords" content=",fft,FWHT">

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(window.oldVersion){var remove=window.oldVersion.reduce(function(p,c){return p||data.indexOf("/*"+c+"*/")!==-1},false);if(remove){lsloader.removeLS(key)}}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload,isJs){if(typeof cssonload==="boolean"){isJs=cssonload;cssonload=undefined}isJs=isJs||false;cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}code=code.split(versionString)[1];if(isJs){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload,isJs)}};lsloader.requestResource=function(name,path,cssonload,isJs){var that=this;if(isJs){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else{this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/Blog/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/Blog/img/favicon.png">
    <link rel="apple-touch-icon" href="/Blog/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Blog">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    
        
            <link rel="alternate" type="application/atom+xml" href="atom.xml">
        
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/Blog/css/material.min.css?rdUU9RcgLCpXgn+BEpYF7Q==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/Blog/css/style.min.css?4ixU3PVzPicZm76KlybVwQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/Blog/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/Blog/css/prettify/github-v2.min.css?AfzKxt++K+/lhZBlSjnxwg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/Blog/img/ns.jpg);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icon -->

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/Blog/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yexiaorain.github.io/Blog">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="从FFT 到 FWHT 快速沃尔什-阿达玛转换(Walsh Hadamard transform) | Blog">
    <meta property="og:image" content="http://yexiaorain.github.io/Blog/img/favicon.png">
    <meta property="og:description" content>
    <meta property="og:article:tag" content="fft"> <meta property="og:article:tag" content="FWHT"> 

    
        <meta property="article:published_time" content="Tue Jul 26 2022 22:24:00 GMT+0800">
        <meta property="article:modified_time" content="Mon Aug 08 2022 00:54:42 GMT+0000">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="从FFT 到 FWHT 快速沃尔什-阿达玛转换(Walsh Hadamard transform) | Blog">
    <meta name="twitter:description" content>
    <meta name="twitter:image" content="http://yexiaorain.github.io/Blog/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="http://yexiaorain.github.io/Blog">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://yexiaorain.github.io/Blog/Blog/2022-07-26-FWT/index.html">
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://yexiaorain.github.io/Blog/Blog/2022-07-26-FWT/index.html",
    "headline": "从FFT 到 FWHT 快速沃尔什-阿达玛转换(Walsh Hadamard transform)",
    "datePublished": "Tue Jul 26 2022 22:24:00 GMT+0800",
    "dateModified": "Mon Aug 08 2022 00:54:42 GMT+0000",
    "author": {
        "@type": "Person",
        "name": "Xiao Ye",
        "image": {
            "@type": "ImageObject",
            "url": "/img/satan.jpg"
        },
        "description": "阳光只洒在金碧辉煌的高楼上"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Blog",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",fft,FWHT",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#FWHT"><span class="post-toc-number">1.</span> <span class="post-toc-text">FWHT</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#解决什么问题"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">解决什么问题</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#回顾离散傅立叶与卷积"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">回顾离散傅立叶与卷积</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Or-版本-FORT-Fast-or-transform"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">Or 版本 FORT(Fast or transform)</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Or卷积-与-ForT"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">Or卷积 与 ForT</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#快速变换"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">快速变换</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#逆变换"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">逆变换</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#And-卷积-Fast-and-transform"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">And 卷积(Fast and transform)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Xor卷积-与-FWHT-Fast-Walsh-Hadamard-transform"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">Xor卷积 与 FWHT(Fast Walsh-Hadamard transform)</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#定义FWHT"><span class="post-toc-number">1.5.1.</span> <span class="post-toc-text">定义FWHT</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Walsh-matrix-and-Hadamard-transform"><span class="post-toc-number">1.5.2.</span> <span class="post-toc-text">Walsh matrix and Hadamard transform</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#快速变换-1"><span class="post-toc-number">1.5.3.</span> <span class="post-toc-text">快速变换</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#模板"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">模板</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#洛谷P4717"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">洛谷P4717</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Ref"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">Ref</span></a></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 4 + 1);

    $('.post_thumbnail-random').attr('data-original', '/Blog/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                从FFT 到 FWHT 快速沃尔什-阿达玛转换(Walsh Hadamard transform)
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/Blog/img/satan.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Xiao Ye</strong>
        <span>7月 26, 2022</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/Blog/tags/FWHT/">FWHT</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/Blog/tags/fft/">fft</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=从FFT 到 FWHT 快速沃尔什-阿达玛转换(Walsh Hadamard transform)&url=http://yexiaorain.github.io/Blog/Blog/2022-07-26-FWT/index.html&pic=http://yexiaorain.github.io/Blog/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=从FFT 到 FWHT 快速沃尔什-阿达玛转换(Walsh Hadamard transform)&url=http://yexiaorain.github.io/Blog/Blog/2022-07-26-FWT/index.html&via=Xiao Ye" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://yexiaorain.github.io/Blog/Blog/2022-07-26-FWT/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Blog&title=从FFT 到 FWHT 快速沃尔什-阿达玛转换(Walsh Hadamard transform)&summary=&pics=http://yexiaorain.github.io/Blog/img/favicon.png&url=http://yexiaorain.github.io/Blog/Blog/2022-07-26-FWT/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
        <a class="post_share-link" href="https://telegram.me/share/url?url=http://yexiaorain.github.io/Blog/Blog/2022-07-26-FWT/index.html&text=从FFT 到 FWHT 快速沃尔什-阿达玛转换(Walsh Hadamard transform)" target="_blank">
            <li class="mdl-menu__item">
                分享到 Telegram
            </li>
        </a>
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="FWHT"><a href="#FWHT" class="headerlink" title="FWHT"></a>FWHT</h1><p>快速沃尔什-阿达玛转换(Fast Walsh-Hadamard transform), 一种广义傅立叶变换(FWHT)</p>
<h2 id="解决什么问题"><a href="#解决什么问题" class="headerlink" title="解决什么问题"></a>解决什么问题</h2><p>FWHT 是用于解决对下标进行位运算卷积问题的方法</p>
<p>$c_{i} = \sum_{i=j \bigoplus k}a_{j} b_{k}$</p>
<p>并且没有fft中会涉及到double</p>
<hr>
<p>前置知识 FFT(DFT)</p>
<p>DFT:</p>
<p>${\displaystyle {\begin{bmatrix}f_{0}\\f_{1}\\\vdots \\f_{n-1}\end{bmatrix}}={\begin{bmatrix}1&amp;1&amp;1&amp;\cdots &amp;1\\1&amp;\alpha &amp;\alpha ^{2}&amp;\cdots &amp;\alpha ^{n-1}\\1&amp;\alpha ^{2}&amp;\alpha ^{4}&amp;\cdots &amp;\alpha ^{2(n-1)}\\\vdots &amp;\vdots &amp;\vdots &amp;&amp;\vdots \\1&amp;\alpha ^{n-1}&amp;\alpha ^{2(n-1)}&amp;\cdots &amp;\alpha ^{(n-1)(n-1)}\\\end{bmatrix}}{\begin{bmatrix}v_{0}\\v_{1}\\\vdots \\v_{n-1}\end{bmatrix}}.}$</p>
<h2 id="回顾离散傅立叶与卷积"><a href="#回顾离散傅立叶与卷积" class="headerlink" title="回顾离散傅立叶与卷积"></a>回顾离散傅立叶与卷积</h2><p>核心等式</p>
<p>$\operatorname{FFT}(a * b) = \operatorname{FFT}(a) \cdot \operatorname{FFT}(b)$</p>
<p>快速变换, $x$原向量,$N$大小, $idx$ 下标</p>
<p>$idx \le \frac{N}{2}$</p>
<p>$f(x,N,idx) = f(even(x),\frac{N}{2},idx) + w^k \cdot f(odd(x),\frac{N}{2},idx)$</p>
<p>$f(x,N,idx+\frac{N}{2}) = f(even(x),\frac{N}{2},idx) - w^k \cdot f(odd(x),\frac{N}{2},idx)$</p>
<h2 id="Or-版本-FORT-Fast-or-transform"><a href="#Or-版本-FORT-Fast-or-transform" class="headerlink" title="Or 版本 FORT(Fast or transform)"></a>Or 版本 FORT(Fast or transform)</h2><h3 id="Or卷积-与-ForT"><a href="#Or卷积-与-ForT" class="headerlink" title="Or卷积 与 ForT"></a>Or卷积 与 ForT</h3><p>$c_{i} = \sum_{i = j | k}a_{j} b_{k}$, 这里$|$ 是按位或不是整除</p>
<p>令$fort[C]_ i = \sum_{i = j|i} A_j$</p>
<p>$\begin{aligned}<br>fort[a]_ i \cdot fort[b]_ i &amp;= (\sum_{j|i=i} a_j) \cdot (\sum_{k|i=i} b_k) \\<br>&amp;= \sum_{j|i=i} \sum_{k|i=i} a_jb_k \\<br>&amp;= \sum_{(j|k)|i = i} a_jb_k \\<br>&amp;= fort[c]_ i<br>\end{aligned}$</p>
<p>这证明了 $\operatorname{ForT}(\left(\sum_{i=j | k}a_{j} b_{k}\right)) = \operatorname{ForT}(a) \cdot \operatorname{ForT}(b)$</p>
<h3 id="快速变换"><a href="#快速变换" class="headerlink" title="快速变换"></a>快速变换</h3><p>下面问题就是如何fast, 如何让快速计算fort和它的逆变换ifort</p>
<p>快速变换, $x$原向量,$N$大小, $idx$ 下标</p>
<p>$idx &lt; \frac{N}{2}$</p>
<p>$f(x,N,idx) = f(x, \frac{N}{2},idx)$</p>
<p>$f(x,N,idx+\frac{N}{2}) = f(x[0\cdots \frac{N}{2}-1]),\frac{N}{2},idx) + f(x[\frac{N}{2}\cdots N-1],\frac{N}{2},idx)$</p>
<p>因为本身$fort$的第$i$位就是所有$i$的二进制子集位置的和</p>
<p>那么对于$idx$ 它的子集一定也是在前半数组中</p>
<p>那么对于$idx + \frac{N}{2}$ 它的 其实就是最高位多了一个bit, 除了这个bit, 剩余部分和$idx$一样, 所以前半后半都按照$idx$来计算求和即可</p>
<p>至此完成fast</p>
<pre><code class="cpp">void ForT(modint *f) {
  for (int k = 1; k &lt; n; k *=2){
    for (int i = 0; i &lt; n; i += 2*k){
      for (int j = 0; j &lt; k; j++){
        // f[i+j] = f[i+j];
        f[i+j+k] += f[i+j];
      }
    }
  }
}
</code></pre>
<h3 id="逆变换"><a href="#逆变换" class="headerlink" title="逆变换"></a>逆变换</h3><p>可以直接参考fast的过程, 每个位置表示它所有bit子集的和, 那么按照反过来, 可以先减去未包含最低的其它子集和bit的值,未包含了低2位bit的其她子集和,…</p>
<p>显然对于的向量的$v$首个值有 $fort(v)_ 0 = v_0$</p>
<p>所以 $a_0 = fort(a)_ 0$</p>
<p>因为 $fort(a)_ 1 = fort(a_0) + fort(a_1)$</p>
<p>所以 $a_1 = fort(a_1) = fort(a)_ 1 - fort(a_0)$</p>
<p>同理$idx &lt; \frac{N}{2}$</p>
<p>$f(x,N,idx) = f(x, \frac{N}{2},idx)$</p>
<p>$f(x,N,idx+\frac{N}{2}) = f(x[0\cdots \frac{N}{2}-1]),\frac{N}{2},idx) - f(x[\frac{N}{2}\cdots N-1],\frac{N}{2},idx)$</p>
<pre><code class="cpp">void IForT(modint *f) {
  for (int k = 1; k &lt; n; k *=2){
    for (int i = 0; i &lt; n; i += 2*k){
      for (int j = 0; j &lt; k; j++){
        f[i+j+k] -= f[i+j];
      }
    }
  }
}
</code></pre>
<hr>
<p>合并</p>
<pre><code class="cpp">// Or卷积
void ForT(vector&lt;modint&gt; &amp;f,int flag = 1/* 1:正变换,-1:逆变换 */) {
  int n = f.size();
  for (int k = 1; k &lt; n; k *=2){
    for (int i = 0; i &lt; n; i += 2*k){
      for (int j = 0; j &lt; k; j++){
        f[i+j+k] += flag * f[i+j];
      }
    }
  }
}
</code></pre>
<h2 id="And-卷积-Fast-and-transform"><a href="#And-卷积-Fast-and-transform" class="headerlink" title="And 卷积(Fast and transform)"></a>And 卷积(Fast and transform)</h2><p>$c_{i} = \sum_{i = j \&amp; k}a_{j} b_{k}$</p>
<p>和Or的部分同理</p>
<ol>
<li>定义变换$fandt(a)_ i = \sum_{i|j = j} a_j$</li>
<li>证明 $fandt(a) \odot fandt(b) = fandt(\left(\sum_{i = j \&amp; k}a_{j} b_{k}\right))$</li>
<li>利用分块关系,实现fast</li>
</ol>
<p>最终代码</p>
<pre><code class="cpp">void FandT(vector&lt;modint&gt; &amp;f, int flag = 1/* 1:正变换,-1:逆变换 */) {
  int n = f.size();
  for (int k = 1; k &lt; n; k *=2){
    for (int i = 0; i &lt; n; i += 2*k){
      for (int j = 0; j &lt; k; j++){
        f[i+j] += f[i+j+k] * flag;
      }
    }
  }
}
</code></pre>
<h2 id="Xor卷积-与-FWHT-Fast-Walsh-Hadamard-transform"><a href="#Xor卷积-与-FWHT-Fast-Walsh-Hadamard-transform" class="headerlink" title="Xor卷积 与 FWHT(Fast Walsh-Hadamard transform)"></a>Xor卷积 与 FWHT(Fast Walsh-Hadamard transform)</h2><p>$\operatorname{FWHT}(\left(\sum_{i=j \bigoplus k}a_{j} b_{k}\right)) = \operatorname{FWHT}(a) \cdot \operatorname{FWHT}(b)$</p>
<h3 id="定义FWHT"><a href="#定义FWHT" class="headerlink" title="定义FWHT"></a>定义FWHT</h3><p>其实和上面一样,依然是三步,定义转换,证明等式,实现fast</p>
<p>定义符号 $x\otimes y=\text{popcount}(x \&amp; y) \bmod 2$, 即 $x$位与$y$后的二进制表示的$1$的个数再$\bmod 2$</p>
<p>有性质$(i \otimes j) \oplus (i \otimes k) = i \otimes (j \oplus k)$</p>
<p>证明: 对于给定的一位, 如果i中0, 则都贡献0, 如果i中是1, $j,k$对应的是1 则贡献是0 则不贡献, 得证</p>
<p>定义: $fwht[a]_ i = \sum_{i\otimes j = 0}a_j - \sum_{i\otimes j = 1}a_j$</p>
<p>那么有:</p>
<p>$fwht[a]_ i \cdot fwht[b]_ i$</p>
<p>$\begin{aligned}<br>&amp;= (\sum_{i\otimes j = 0} a_j - \sum_{i\otimes j = 1} a_j)\cdot (\sum_{i\otimes k = 0} b_k - \sum_{i\otimes k = 1} b_k) \\<br>&amp;=\left((\sum_{i\otimes j=0}a_j)(\sum_{i\otimes k=0}b_k)+(\sum_{i\otimes j=1}a_j)(\sum_{i\otimes k=1}b_k) \right)-\left((\sum_{i\otimes j=0}a_j)(\sum_{i\otimes k=1}b_k)-(\sum_{i\otimes j=1}a_j)(\sum_{i\otimes kj=0}b_k)\right)\\<br>&amp;=\sum_{i\otimes(j \oplus k)=0}a_jb_k-\sum_{i\otimes(j\oplus k)=1}a_jb_k \\<br>&amp;=\sum_{i\otimes l = 0}\sum_{l = j \oplus k}a_jb_k-\sum_{i\otimes l = 1}\sum_{l = j\oplus k}a_jb_k \\<br>&amp;= fwht[\left(\sum_{i=j \bigoplus k}a_{j} b_{k}\right)]_ i<br>\end{aligned}$</p>
<h3 id="Walsh-matrix-and-Hadamard-transform"><a href="#Walsh-matrix-and-Hadamard-transform" class="headerlink" title="Walsh matrix and Hadamard transform"></a>Walsh matrix and Hadamard transform</h3><p>可以看看Walsh矩阵的样子</p>
<p>${\displaystyle H_{m}={\frac {1}{\sqrt {2}}}{\begin{pmatrix}H_{m-1}&amp;H_{m-1}\\H_{m-1}&amp;-H_{m-1}\end{pmatrix}}}$</p>
<p>${\begin{aligned}H_{0}&amp;=+{\begin{pmatrix}1\end{pmatrix}}\\H_{1}&amp;={\frac {1}{\sqrt {2}}}\left({\begin{array}{rr}1&amp;1\\1&amp;-1\end{array}}\right)\\H_{2}&amp;={\frac {1}{2}}\left({\begin{array}{rrrr}1&amp;1&amp;1&amp;1\\1&amp;-1&amp;1&amp;-1\\1&amp;1&amp;-1&amp;-1\\1&amp;-1&amp;-1&amp;1\end{array}}\right)\\H_{3}&amp;={\frac {1}{2^{3/2}}}\left({\begin{array}{rrrrrrrr}1&amp;1&amp;1&amp;1&amp;1&amp;1&amp;1&amp;1\\1&amp;-1&amp;1&amp;-1&amp;1&amp;-1&amp;1&amp;-1\\1&amp;1&amp;-1&amp;-1&amp;1&amp;1&amp;-1&amp;-1\\1&amp;-1&amp;-1&amp;1&amp;1&amp;-1&amp;-1&amp;1\\1&amp;1&amp;1&amp;1&amp;-1&amp;-1&amp;-1&amp;-1\\1&amp;-1&amp;1&amp;-1&amp;-1&amp;1&amp;-1&amp;1\\1&amp;1&amp;-1&amp;-1&amp;-1&amp;-1&amp;1&amp;1\\1&amp;-1&amp;-1&amp;1&amp;-1&amp;1&amp;1&amp;-1\end{array}}\right)\\(H_{n})_{i,j}&amp;={\frac {1}{2^{n/2}}}(-1)^{i\cdot j}\end{aligned}}$</p>
<p>对于 $(1,0,1,0,0,1,1,0)$</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/aa/1010_0110_Walsh_spectrum_%28single_row%29.svg/300px-1010_0110_Walsh_spectrum_%28single_row%29.svg.png" alt="The product of a Boolean function and a Walsh matrix"></p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/58/1010_0110_Walsh_spectrum_%28fast_WHT%29.svg/300px-1010_0110_Walsh_spectrum_%28fast_WHT%29.svg.png" alt="Fast Walsh–Hadamard transform, a faster way to calculate the Walsh spectrum"></p>
<h3 id="快速变换-1"><a href="#快速变换-1" class="headerlink" title="快速变换"></a>快速变换</h3><p>其实看到了矩阵之间的递推关系 这个表达式就很显然了</p>
<p>$idx &lt; \frac{N}{2}$</p>
<p>$f(x,N,idx) = f(x[0,\frac{N}{2}), \frac{N}{2},idx) + f(x[\frac{N}{2},N), \frac{N}{2}, idx)$</p>
<p>$f(x,N,idx+\frac{N}{2}) = f(x[0,\frac{N}{2}), \frac{N}{2},idx) - f(x[\frac{N}{2},N), \frac{N}{2}, idx)$</p>
<pre><code class="cpp">void FWHT(vector&lt;modint&gt; &amp;f, int flag = 1 /* 1: 正变换, 1/2: 逆变换*/) {
  int n = f.size();
  for (int k = 1; k &lt; n; k *=2){
    for (int i = 0; i &lt; n; i += 2*k){
      for (int j = 0; j &lt; k; j++){
        auto U = f[i+j];
        auto T = f[i+j+k];
        f[i+j]   = U + T;
        f[i+j+k] = U - T;
        f[i+j] *= flag;
        f[i+j+k] *= flag;
      }
    }
  }
}
</code></pre>
<h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><pre><code class="cpp">#include &lt;bits/stdc++.h&gt;
#include &quot;./modint.cpp&quot;
using namespace std;

typedef long long ll;
#define rep(i,a,n) for (ll i=a;i&lt;n;i++)
#define per(i,a,n) for (ll i=n;i--&gt;(ll)a;)
#define pb push_back

using MODINT::modint;

namespace FWT{
  void ForT(vector&lt;modint&gt; &amp;f,int flag = 1/* 1:正变换,-1:逆变换 */) {
    int n = f.size();
    for (int k = 1; k &lt; n; k *=2){
      for (int i = 0; i &lt; n; i += 2*k){
        for (int j = 0; j &lt; k; j++){
          f[i+j+k] += f[i+j] * flag;
        }
      }
    }
  }

  void IForT(vector&lt;modint&gt; &amp;f) {ForT(f, -1);}

  vector&lt;modint&gt; or_convolution(vector&lt;modint&gt; &amp;v0, vector&lt;modint&gt; &amp;v1){
    const int sz = v0.size();
    ForT(v0);
    ForT(v1);
    vector&lt;modint&gt; v2(sz,0);
    rep(i,0,sz) v2[i] = v0[i] * v1[i];
    IForT(v2);
    return v2;
  }

  void FandT(vector&lt;modint&gt; &amp;f, int flag = 1/* 1:正变换,-1:逆变换 */) {
    int n = f.size();
    for (int k = 1; k &lt; n; k *=2){
      for (int i = 0; i &lt; n; i += 2*k){
        for (int j = 0; j &lt; k; j++){
          f[i+j] += f[i+j+k] * flag;
        }
      }
    }
  }
  void IFandT(vector&lt;modint&gt; &amp;f) {FandT(f, -1);}

  vector&lt;modint&gt; and_convolution(vector&lt;modint&gt; &amp;v0, vector&lt;modint&gt; &amp;v1){
    const int sz = v0.size();
    FandT(v0);
    FandT(v1);
    vector&lt;modint&gt; v2(sz,0);
    rep(i,0,sz) v2[i] = v0[i] * v1[i];
    IFandT(v2);
    return v2;
  }

  modint inv2 = modint(2).inv();
  void FWHT(vector&lt;modint&gt; &amp;f, modint flag = 1 /* 1: 正变换, 1/2: 逆变换*/) {
    int n = f.size();
    for (int k = 1; k &lt; n; k *=2){
      for (int i = 0; i &lt; n; i += 2*k){
        for (int j = 0; j &lt; k; j++){
          auto U = f[i+j];
          auto T = f[i+j+k];
          f[i+j]   = U + T;
          f[i+j+k] = U - T;
          f[i+j] *= flag;
          f[i+j+k] *= flag;
        }
      }
    }
  }
  void IFWHT(vector&lt;modint&gt; &amp;f) {FWHT(f, inv2);}
  void FxorT(vector&lt;modint&gt; &amp;f,int flag = 1) {FWHT(f, flag);}
  void IFxorT(vector&lt;modint&gt; &amp;f) {IFWHT(f);}

  vector&lt;modint&gt; xor_convolution(vector&lt;modint&gt; &amp;v0, vector&lt;modint&gt; &amp;v1){
    const int sz = v0.size();
    FxorT(v0);
    FxorT(v1);
    vector&lt;modint&gt; v2(sz,0);
    rep(i,0,sz) v2[i] = v0[i] * v1[i];
    IFxorT(v2);
    return v2;
  }
};

void print(vector&lt;modint&gt; &amp;arr){
  for(auto &amp;v:arr) printf(&quot;%d &quot;, v.val());
  printf(&quot;\n&quot;);
}

int main(){
  // 长度2的幂次
  const vector&lt;modint&gt; A0 = {1,2,3,0};
  const vector&lt;modint&gt; B0 = {4,5,6,0};

  // --- or ---
  {
    auto A = A0;
    auto B = B0;
    auto C = FWT::or_convolution(A,B);
    print(C);
  }
  // --- and ---
  {
    auto A = A0;
    auto B = B0;
    auto C = FWT::and_convolution(A,B);
    print(C);
  }
  // --- xor ---
  {
    auto A = A0;
    auto B = B0;
    auto C = FWT::xor_convolution(A,B);
    print(C);
  }
  return 0;
}
</code></pre>
<h2 id="洛谷P4717"><a href="#洛谷P4717" class="headerlink" title="洛谷P4717"></a>洛谷P4717</h2><p><a href="https://www.luogu.com.cn/record/81332363" target="_blank" rel="noopener">https://www.luogu.com.cn/record/81332363</a></p>
<pre><code class="cpp">#include &lt;bits/stdc++.h&gt;
using namespace std;

typedef long long ll;
#define rep(i,a,n) for (ll i=a;i&lt;n;i++)

ll read(){ll r;scanf(&quot;%lld&quot;,&amp;r);return r;} // read

// ----------- modint -----------
namespace MODINT{
  const int _mod = 998244353;
  class modint{
    private:
      ll _v;
    public:
      modint() :_v(0) {  }
      modint(ll _a) {
        _v = (_a &lt; 0)? _mod - ((-_a) % _mod) : (_a % _mod);
      }

      int val()const { return _v; }
      modint operator+()const { return *this; }
      modint operator-()const { return { _mod - _v }; }
      modint operator+(const modint&amp; rhs) const { return modint(*this) += rhs; }
      modint operator-(const modint&amp; rhs) const { return modint(*this) -= rhs; }
      modint operator*(const modint&amp; rhs) const { return modint(*this) *= rhs; }
      modint operator/(const modint&amp; rhs) const { return modint(*this) /= rhs; }

      bool operator==(const modint&amp; rhs)const { return _v == rhs._v; }
      bool operator!=(const modint&amp; rhs)const { return _v != rhs._v; }
      bool operator&gt; (const modint&amp; rhs)const { return _v &gt;  rhs._v; }
      bool operator&gt;=(const modint&amp; rhs)const { return _v &gt;= rhs._v; }
      bool operator&lt;=(const modint&amp; rhs)const { return _v &lt;= rhs._v; }
      bool operator&lt; (const modint&amp; rhs)const { return _v &lt;  rhs._v; }

      modint&amp; operator+=(const modint&amp; rhs) {
        (_v += rhs._v) %= _mod;
        return *this;
      }
      modint&amp; operator-=(const modint&amp; rhs) {
        (_v += _mod - rhs._v) %= _mod;
        return *this;
      }
      modint&amp; operator*=(const modint&amp; rhs) {
        _v = _v * rhs.val() % _mod;
        return *this;
      }
      modint&amp; operator/=(const modint&amp; rhs) { // 费马小定理
        _v = _v * rhs.inv().val() % _mod ;
        return *this;
      }
      modint pow(ll pwr) const {
        ll res(1);
        ll _b(_v);
        while (pwr) {
          if (pwr &amp; 1) (res *= _b) %= _mod;
          (_b *= _b) %= _mod;
          pwr /= 2;
        }
        return res;
      }
      modint inv() const {
        assert(_v != 0);
        return pow(_mod - 2);
      }
  };
};
// ----------- modint -----------


// ----------- fwt -----------
using MODINT::modint;

namespace FWT{
  void ForT(vector&lt;modint&gt; &amp;f,int flag = 1/* 1:正变换,-1:逆变换 */) {
    int n = f.size();
    for (int k = 1; k &lt; n; k *=2){
      for (int i = 0; i &lt; n; i += 2*k){
        for (int j = 0; j &lt; k; j++){
          f[i+j+k] += f[i+j] * flag;
        }
      }
    }
  }

  void IForT(vector&lt;modint&gt; &amp;f) {ForT(f, -1);}

  vector&lt;modint&gt; or_convolution(vector&lt;modint&gt; &amp;v0, vector&lt;modint&gt; &amp;v1){
    const int sz = v0.size();
    ForT(v0);
    ForT(v1);
    vector&lt;modint&gt; v2(sz,0);
    rep(i,0,sz) v2[i] = v0[i] * v1[i];
    IForT(v2);
    return v2;
  }

  void FandT(vector&lt;modint&gt; &amp;f, int flag = 1/* 1:正变换,-1:逆变换 */) {
    int n = f.size();
    for (int k = 1; k &lt; n; k *=2){
      for (int i = 0; i &lt; n; i += 2*k){
        for (int j = 0; j &lt; k; j++){
          f[i+j] += f[i+j+k] * flag;
        }
      }
    }
  }
  void IFandT(vector&lt;modint&gt; &amp;f) {FandT(f, -1);}

  vector&lt;modint&gt; and_convolution(vector&lt;modint&gt; &amp;v0, vector&lt;modint&gt; &amp;v1){
    const int sz = v0.size();
    FandT(v0);
    FandT(v1);
    vector&lt;modint&gt; v2(sz,0);
    rep(i,0,sz) v2[i] = v0[i] * v1[i];
    IFandT(v2);
    return v2;
  }

  modint inv2 = modint(2).inv();
  void FWHT(vector&lt;modint&gt; &amp;f, modint flag = 1 /* 1: 正变换, 1/2: 逆变换*/) {
    int n = f.size();
    for (int k = 1; k &lt; n; k *=2){
      for (int i = 0; i &lt; n; i += 2*k){
        for (int j = 0; j &lt; k; j++){
          auto U = f[i+j];
          auto T = f[i+j+k];
          f[i+j]   = U + T;
          f[i+j+k] = U - T;
          f[i+j] *= flag;
          f[i+j+k] *= flag;
        }
      }
    }
  }
  void IFWHT(vector&lt;modint&gt; &amp;f) {FWHT(f, inv2);}
  void FxorT(vector&lt;modint&gt; &amp;f,int flag = 1) {FWHT(f, flag);}
  void IFxorT(vector&lt;modint&gt; &amp;f) {IFWHT(f);}

  vector&lt;modint&gt; xor_convolution(vector&lt;modint&gt; &amp;v0, vector&lt;modint&gt; &amp;v1){
    const int sz = v0.size();
    FxorT(v0);
    FxorT(v1);
    vector&lt;modint&gt; v2(sz,0);
    rep(i,0,sz) v2[i] = v0[i] * v1[i];
    IFxorT(v2);
    return v2;
  }
};
// ----------- fwt -----------

void print(vector&lt;modint&gt; &amp;arr){
  for(auto &amp;v:arr) printf(&quot;%d &quot;, v.val());
  printf(&quot;\n&quot;);
}

int main(){
  const int n = read();
  const int SIZE = 1&lt;&lt;n;
  // 长度2的幂次
  auto A0 = vector&lt;modint&gt;(SIZE,0);
  auto B0 = vector&lt;modint&gt;(SIZE,0);
  rep(i,0,SIZE) A0[i] = read();
  rep(i,0,SIZE) B0[i] = read();

  // --- or ---
  {
    auto A = A0;
    auto B = B0;
    auto C = FWT::or_convolution(A,B);
    print(C);
  }
  // --- and ---
  {
    auto A = A0;
    auto B = B0;
    auto C = FWT::and_convolution(A,B);
    print(C);
  }
  // --- xor ---
  {
    auto A = A0;
    auto B = B0;
    auto C = FWT::xor_convolution(A,B);
    print(C);
  }
  return 0;
}

</code></pre>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a href="http://yexiaorain.github.io/Blog/2019-01-02-fftmul/">我的FFT笔记</a></p>
<p><a href="https://en.wikipedia.org/wiki/Fast_Walsh%E2%80%93Hadamard_transform" target="_blank" rel="noopener">wikipedia Fast Walsh-Hadamard transform</a></p>
<p><a href="https://en.wikipedia.org/wiki/Hadamard_transform" target="_blank" rel="noopener">Hadamard transform</a></p>
<p><a href="https://en.wikipedia.org/wiki/Walsh_matrix" target="_blank" rel="noopener">Walsh matrix</a></p>
<p><a href="https://codeforces.com/blog/entry/71899" target="_blank" rel="noopener">Codeforces FWHT inner working</a></p>
<p><a href="https://blog.csdn.net/a_forever_dream/article/details/105110089" target="_blank" rel="noopener">CSDN 快速沃尔什变换（FWT）详详详解</a></p>
<p><a href="https://www.luogu.com.cn/problem/solution/P4717" target="_blank" rel="noopener">luogu 模板练习</a></p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            This blog is under a <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh" target="_blank">CC BY-NC-SA 3.0 Unported License</a>
                        </strong>
                        <br>
                        <strong>本文鏈接：</strong><a href="http://yexiaorain.github.io/Blog/2022-07-26-FWT/">http://yexiaorain.github.io/Blog/2022-07-26-FWT/</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 DISQUS -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://yexiaorain.github.io/Blog/2022-07-26-FWT/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://yexiaorain.github.io/Blog/2022-07-26-FWT/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>
<script type="text/ls-javascript" id="disqus-thread-script">
    queue.offer(function() {
            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document;
                var s = d.createElement('script');
                s.src = '//yexiaorain.disqus.com/embed.js';
                s.setAttribute('data-timestamp', + new Date());
                (d.head || d.body).appendChild(s);
            })();
        });
</script>

</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/Blog/2022-07-27-sa/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/Blog/2022-07-25-ac_abc212/" id="post_nav-older" class="next-content">
            舊篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/Blog/img/sidebar_header.jpg);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/Blog/img/satan.jpg" alt="Xiao Ye's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        yexiaorain@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: yexiaorain@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/Blog/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                首頁
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    過往
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/Blog/archives/2022/08/">八月 2022<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2022/07/">七月 2022<span class="sidebar_archives-count">16</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2022/06/">六月 2022<span class="sidebar_archives-count">17</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2022/05/">五月 2022<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2022/04/">四月 2022<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2022/03/">三月 2022<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2022/02/">二月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2021/12/">十二月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2021/11/">十一月 2021<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2021/09/">九月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2021/08/">八月 2021<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2021/07/">七月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2021/06/">六月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2021/05/">五月 2021<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2021/04/">四月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2021/02/">二月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/12/">十二月 2020<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/11/">十一月 2020<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/08/">八月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/07/">七月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/06/">六月 2020<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/05/">五月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/04/">四月 2020<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/03/">三月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/02/">二月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2020/01/">一月 2020<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/11/">十一月 2019<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/10/">十月 2019<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/09/">九月 2019<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/08/">八月 2019<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/07/">七月 2019<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/06/">六月 2019<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/05/">五月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/04/">四月 2019<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/03/">三月 2019<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/02/">二月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2019/01/">一月 2019<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2018/12/">十二月 2018<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2018/11/">十一月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2018/07/">七月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2018/06/">六月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2018/05/">五月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2018/04/">四月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/archives/2017/10/">十月 2017<span class="sidebar_archives-count">5</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分類
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/Blog/categories/Atcoder/">Atcoder<span class="sidebar_archives-count">31</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/CodeChef/">CodeChef<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/Codeforces/">Codeforces<span class="sidebar_archives-count">72</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/Machine-learning/">Machine learning<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/Math/">Math<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/NowCoder/">NowCoder<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/NowCoder/LCA/">LCA<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/Project-Euler/">Project Euler<span class="sidebar_archives-count">19</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/USACO/">USACO<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/algorithm/">algorithm<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/c/">c++<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/code/">code<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/codeforce/">codeforce<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/luogu/">luogu<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/math/">math<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/poj/">poj<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/tencent/">tencent<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/Blog/categories/算法/">算法<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://yexiaorain.github.com" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2013&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Blog
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/Blog/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/Blog/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/Blog/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>









   <!-- 使用 DISQUS js 代码 -->
<script id="dsq-count-scr" src="//yexiaorain.disqus.com/count.js" async></script>





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/Blog/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/Blog/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->

    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
