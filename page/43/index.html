<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/Blog/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/Blog/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/Blog/images/favicon-16x16.png">
  <link rel="mask-icon" href="/Blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/Blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"yexiaorain.github.io","root":"/Blog/","images":"/Blog/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"right","display":"hide","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":null,"activeClass":"disqus"},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/Blog/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/Blog/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="YeXiaoRain Blog">
<meta property="og:url" content="https://yexiaorain.github.io/Blog/page/43/index.html">
<meta property="og:site_name" content="YeXiaoRain Blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Xiao Ye">
<meta name="twitter:card" content="&lt;twitter:card&gt;">


<link rel="canonical" href="https://yexiaorain.github.io/Blog/page/43/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-TW","comments":"","permalink":"","path":"page/43/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>YeXiaoRain Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/Blog/css/noscript.css">
  </noscript>
<link rel="alternate" href="/Blog/atom.xml" title="YeXiaoRain Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/Blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">YeXiaoRain Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜尋" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/Blog/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li><li class="menu-item menu-item-archives"><a href="/Blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔<span class="badge">286</span></a></li><li class="menu-item menu-item-yearmonth"><a href="/Blog/yearmonth/" rel="section"><i class="fa fa-calendar-days fa-fw"></i>年月</a></li><li class="menu-item menu-item-categories"><a href="/Blog/categories/" rel="section"><i class="fa fa-shapes fa-fw"></i>分類<span class="badge">19</span></a></li><li class="menu-item menu-item-tags"><a href="/Blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤<span class="badge">286</span></a></li><li class="menu-item menu-item-rss"><a href="/Blog/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>rss</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Xiao Ye"
      src="https://avatars.githubusercontent.com/u/7298239?v=4">
  <p class="site-author-name" itemprop="name">Xiao Ye</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/Blog/archives/">
          <span class="site-state-item-count">286</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/Blog/categories/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/Blog/tags/">
        <span class="site-state-item-count">286</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yexiaorain" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yexiaorain" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yexiaorain@gmail.com" title="E-Mail → mailto:yexiaorain@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://atcoder.jp/users/cromarmot" title="https:&#x2F;&#x2F;atcoder.jp&#x2F;users&#x2F;cromarmot" rel="noopener" target="_blank">AtCoder</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://codeforces.com/profile/YeXiaoRain" title="https:&#x2F;&#x2F;codeforces.com&#x2F;profile&#x2F;YeXiaoRain" rel="noopener" target="_blank">Codeforces</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/pe/167/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/pe/167/" class="post-title-link" itemprop="url">project euler 167 (Ulam Number Sequence)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2021-04-22 10:37:14" itemprop="dateCreated datePublished" datetime="2021-04-22T10:37:14+08:00">2021-04-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2024-01-26 01:38:14" itemprop="dateModified" datetime="2024-01-26T01:38:14+08:00">2024-01-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Project-Euler/" itemprop="url" rel="index"><span itemprop="name">Project Euler</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/pe/167/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="pe/167/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>6.7k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>22 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Ulam-序列"><a href="#Ulam-序列" class="headerlink" title="Ulam 序列"></a>Ulam 序列</h1><p>定义</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">U(a,b,1) = a</span><br><span class="line">U(a,b,2) = b</span><br><span class="line">U(a,b,k &gt; 2) = 大于U(a,b,k-1) 且能唯一表示为 U(a,b,i) + U(a,b,j), i != j</span><br></pre></td></tr></table></figure>

<p>例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">U(1,2,1) = 1</span><br><span class="line">U(1,2,2) = 2</span><br><span class="line">U(1,2,3) = 1+2 = 3</span><br><span class="line">U(1,2,4) = 1+3 = 4</span><br><span class="line">U(1,2,5) = 2+4 = 6 (5有两种表示方法)</span><br><span class="line">U(1,2,6) = 2+6 = 8 (6有两种表示方法)</span><br><span class="line">U(1,2,7) = 3+8 = 11 (9,10都有多种表示方法)</span><br></pre></td></tr></table></figure>

<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">U(2,5,10**11)</span><br><span class="line">+U(2,7,10**11)</span><br><span class="line">+U(2,9,10**11)</span><br><span class="line">+U(2,11,10**11)</span><br><span class="line">+U(2,13,10**11)</span><br><span class="line">+U(2,15,10**11)</span><br><span class="line">+U(2,17,10**11)</span><br><span class="line">+U(2,19,10**11)</span><br><span class="line">+U(2,21,10**11)</span><br></pre></td></tr></table></figure>

<h1 id="想法"><a href="#想法" class="headerlink" title="想法"></a>想法</h1><p>列举了几个，发现无能为力</p>
<p>能想到的就是 set+枚举</p>
<p>那至少是 K方的空间时间复杂度, 连k都没法搞，更别说k方了</p>
<p>果断google XD</p>
<h1 id="搜索到"><a href="#搜索到" class="headerlink" title="搜索到"></a>搜索到</h1><p>Schmerl and Spiegel (1994) proved that Ulam sequences (2,v) for odd v&gt;&#x3D;5 have exactly two even terms. Ulam sequences with only finitely many even terms eventually must have periodic successive differences (Finch 1991, 1992abc). Cassaigne and Finch (1995) proved that the Ulam sequences (4,v) for 5&lt;&#x3D;v&#x3D;1 (mod 4) have exactly three even terms.</p>
<p>The Ulam sequence can be generalized by the s-additive sequence.</p>
<p>还有cos性质，不过这题可能用不到</p>
<p>当然如果直接用性质，也不需要写啥文章了，就像pe66，我还是从零整理了整个 pell方程和连分数关系的证明过程。</p>
<h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><ol start="0">
<li>有无限多个。显然做pe到176了，这还是很明显，最大两个的和一定唯一表示，所以至少有一个大于且唯一表示的，所以得证</li>
<li>除了第3个，其它的都不是上两个的和, $U_{n-2}+U_{n}$ 是唯一的计算方案，所以，$U_{n-2}+U_{n} \ge U_{n+1}$, 得证</li>
<li>n大于2时，相邻3个能构成3角形, $U_{n-1}+U_{n} &gt; U_{n-2}+U_{n} \ge U_{n+1}$,得证</li>
<li>(1,2) 的Ulam sequence 是 Complete sequence，也就是任何正整数可以序列中每个数字最多用一次的和表示。直接用集合最小法，假设有集合的数，都是该序列不可表示的，那么取最小的不可表示的数,记为$x_0$，显然它没有出现在序列中，且它大于4, 取最大一个小于它的序列中的数 $0 \leq x_1&#x3D;x_0-U_n &lt; U_n$, 则也不可表示, 和最小性质矛盾</li>
<li>任意n, $[n,2n)$之间至少有一个 数属于序列, 无限多个和$U_{n+1} \leq 2*U_n$ 得证</li>
<li>(1,2)的序列，i&gt;4, $i,i+1,i+2,i+3,i+4$,至多两个属于序列，首先可以看作在整数中取连续的5个数，那么根据贪心，直接取到$i$是序列中的数，否则我们做平移到i是序列中的数，只会更多。如果$i+1$也是，显然$i+2 &#x3D; (i)+(2)&#x3D;(i+1)+(1),i+3&#x3D;(i)+(3)&#x3D;(i+1)+(2),i+4&#x3D;(i)+(4)&#x3D;(i+1)+(3)$都有多种表示法。如果$i+2$也是，$i+3&#x3D;(i+2)+(1) &#x3D; (i)+(3), i+4&#x3D;(i+2)+(2)&#x3D;(i)+(4)$。如果$i+3$也是，$i+4&#x3D;(i+3)+(1)&#x3D;(i)+(4)$,得证</li>
</ol>
<p><code>(u, v)-Ulam 序列</code> is regular 如果序列的差分，是最终周期性的(也就是除去一定的非周期序列前缀后，剩余部分是周期序列)</p>
<h1 id="paper"><a href="#paper" class="headerlink" title="paper"></a>paper</h1><p>法文令人抠头XD, 这个老哥是 诗人作家，业余数学家!?还是重名?</p>
<p>英文还稍微能看，法文只剩公式靠猜为主，用了一下google的pdf翻译功能XD</p>
<h2 id="s-additive-sequences"><a href="#s-additive-sequences" class="headerlink" title="s-additive sequences"></a>s-additive sequences</h2><p>s-additive 如果除了开始2个以外的数，正好能表示成s种前面的数之和，因此 Ulam numbers and the (u, v)-Ulam numbers are 1-additive sequences</p>
<p>正整数，单增</p>
<p>给定前2s项，作为基础</p>
<p>对于n&gt;2s, $U_n$ 是大于 $U_{n-1}$的最小整数，满足 $U_{n} &#x3D; U_i+U_j (u_i\neq u_j,i \neq j)$, 的最小的且正好有s个解</p>
<h2 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h2><p>显然, 是必要给出2s项，否则直接中断（因为要s种表示方式）</p>
<p>并且前s+1项 决定了 整个2s项，因为这样才能有2s+1项(有s种表示方式) $U_{2s+1} &#x3D; U_{1}+U_{2s} &#x3D; U_{2}+U_{2s-1} &#x3D;U_{3}+U_{2s-2} &#x3D; \cdots &#x3D;U_{s}+U_{s+1}$</p>
<p>因此$U_{s+2}$可取值是$U_{s+1}+U_{1}$  或 $U_{s+1}+U_{2}$，且满足一串等式类似上面，但是并不保证 下标和为s的函数, 对于可行和来说，只有s+1种，其实就是连等式中不会出现的数只会在前s+1个中</p>
<p>补充定义$U_0&#x3D;0$</p>
<p>所以说我们有两串连等式</p>
<p>$U_{2s+1} &#x3D; U_0+U_{2s+1} &#x3D; U_{1}+U_{2s} &#x3D; U_{2}+U_{2s-1} &#x3D;U_{3}+U_{2s-2} &#x3D; \cdots &#x3D;U_{s-1}+U_{s+2}$</p>
<p>$U_{2s+2} &#x3D; U_{1 or 2} + U_{2s+1} &#x3D; U_{2 or 3}+U_{2s} &#x3D; U_{2 or 3}+U_{2s-1} &#x3D;U_{3 or 4}+U_{2s-2} &#x3D; \cdots &#x3D;U_{(s) or (s+1)}+U_{s+2}$</p>
<p>上下相减</p>
<p>$U_0 - U_{1 or 2} &#x3D; U_1 - U_{2 or 3} &#x3D; U_2 - U_{3 or 4} &#x3D; \cdots &#x3D; U_{s-1} - U_{(s) or (s+1)} &#x3D; 常量$</p>
<p>对于给定具体的一个初始序列这个值是确定的，所以是常量</p>
<p>很明显 这里有s个等差，注意在 $x 或 x+1$ 的取值是在一个确定位置的左侧全部取x，右侧全部取x+1  的，所以最多发生一次 不连续的差，而这个等差序列最大跨度为2个下标差</p>
<p>所以可能的序列有</p>
<p>$A$(前s项以及$U_0$完全等差): $u,2u,3u,\cdots,(s-1)u,su,v,v + u,\cdots,v+(s-2)u,v+(s-1)u$</p>
<blockquote>
<p>这个相当于上面常量的表达式在or的选择全部取左侧</p>
</blockquote>
<p>$B_1$(前s-1以及$U_0$完全等差): $u,2u,3u,\cdots,(s-1)u,v,su,v + u,\cdots,v+(s-2)u,v+(s-1)u$</p>
<blockquote>
<p>看上去和上面交换了正中两项的位置,这个相当于上面常量的表达式除了最后的一项的or取右侧，其余or的选择全部取左侧。</p>
</blockquote>
<blockquote>
<p>很好的是序列的性质，因为有和($U_{2n+1}$)的控制右侧的序列并不会因为交换了中间两项而改变</p>
</blockquote>
<p>$B_2$(前s-1以及$U_0$完全等差): $u,2u,\cdots,v,(s-1)u,v+u,su,\cdots,v+(s-2)u,v+(s-1)u$</p>
<blockquote>
<p>这个相当于上面的常量表达式，除了最后两项区or右侧，其它取or左侧，也就是 $U_{s+1}-U_{s-1} &#x3D; U_{s}-U_{s-2} &#x3D; U_{s-2}-U_{s-3} &#x3D; 等差常量$ ,也就是 前s-2项 再配上$U_{s}$ 和 $U_{s+2}$ 都是等差的。</p>
</blockquote>
<blockquote>
<p>这里比较有意思的是，虽然$U_{s+1}-U_{s-1} &#x3D; U_{s}-U_{s-2}$中的s+1超过了s，但是本身差是关于 s,s+1 之间对称的，所以$U_{s+1}-U_{s-1} &#x3D; - (U_{(2s+1)-(s+1)} - U_{(2s+1)-(s-1)} ) &#x3D; U_{s+2} - U_{s}$。因此序列中依然$u,2u,\cdots,su$都存在，只是位置变了，而后面的部分依然不会变，后面的部分又因为s,s+1之间对称等差性，v，v+u到 (s-1)u 也没变，只是换了位置，然后序列就神奇得像是 交叉了一下而已</p>
</blockquote>
<p>$B_{s-1}$: $u,v,2u,v+u,3u,v+2u,\cdots,su,v+(s-1)u$</p>
<blockquote>
<p>就是两个序列完全穿插到了一起，也就是上面常量表达式除了第一项取or左侧，其余全部取or右侧</p>
</blockquote>
<p>$C$: $v,u,v+u,2u,v+2u,3u,\cdots,v+(s-1)u,su$</p>
<blockquote>
<p>就是两个序列完全穿插到了一起,然后再错过一个，也就是上面常量表达式所有项取or右侧</p>
</blockquote>
<p>(目前位置不懂为什么要分成ABC三种，因为从组成来看，就是两个序列的穿插结果)</p>
<p>因此，可以用(s,u,v)唯一表示($u\neq v$) s-additives的序列，s决定了和的要求次数，初始序列长度，其中u决定了存在的 $u,2u,3u,\cdots,su$序列,u和v,确定了$v,v+u,v+2u,\cdots,v+(s-1)u$这个序列，这两个序列从小到大排列即可</p>
<p>如果u和v不互质，$gcd(u,v) * (s,u&#x2F;gcd(u,v),v&#x2F;gcd(u,v)) &#x3D; (s,u,v)$</p>
<p>对于s&#x3D;1，只有A&#x2F;C类型的序列</p>
<p>u&#x3D;1 只有 A类型的序列</p>
<p>对于 v &#x3D; (s+1)u 的 我们称之为<code>自然 s-additive</code>, 因为上面提到的互质，考虑u&#x3D;1，显然(s,1,s+1) &#x3D; (s,2,1), 因为数列都是 1~2s</p>
<p>对于 $u\ge 3$ 且 $s&gt;1$ 有性质 取自$v+nu$序列，仅在$ku&lt;v&lt;(k+1)u$时 $U_{3s+k+1} &#x3D; 2v+(2s-1)u$</p>
<p>例如 (s&#x3D;3,u&#x3D;3,v&#x3D;10):[3,6,9,10,13,16],19,22,25,28,31,34,35(!),37,40…</p>
<p>$3u&#x3D;9&lt;v&#x3D;10&lt;(3+1)u&#x3D;12$ 所以$k&#x3D;3, i &#x3D; 3s+k+1&#x3D;14,U_i&#x3D;u_{14} &#x3D; 2v+(2s-1)u &#x3D; 35$</p>
<p>证明，首先因为序列是通过$u,2u,\cdots,su$和$v,v+u,v+2u,\cdots,v+(s-1)u$以某种穿插形式初始化的，u,v互质不等，v的系数为0或1,所以在序列生成过程中已有的是$(1<del>s)u,v+(0</del>(s-1)+)u$，可能的下一个数是au,u或v+au或2v+au,</p>
<p>首先au不可能，因为不带v的仅有s个递增的数，不可能有s种方案</p>
<p>接下来v+au,刚刚好，选一个ku，再选一个v+(a-k)u,即是连续的又是刚好s个，问题只是可能不是可选的最小</p>
<p>对于2v+au,也就是需要选 v+ku,和v+(a-k)u,这个只会发生一次，因为v+?u,?的取值范围是从0开始的连续整数，所以2v+(a+1)u的方案必定有s+1种。同时当这个2v+au产生时，并不会产生额外的新值</p>
<p>因为2v+au带来的可能是 3v+bu或4v+bu,而3&#x3D;0+3&#x3D;1+2,4&#x3D;0+4&#x3D;1+3&#x3D;2+2都不具备构成。</p>
<p>同样 对于2v+au来说，显然不对bu&#x2F;v+bu产生影响，根据a的值也不对2v+bu的构成产生影响</p>
<p>综上在算下a的具体值和对应下标的值，得证(s&gt;1,u&gt;&#x3D;3,v) 主要由 $(1~s)u,v+ku,以及一个特殊2v+(2s-1)u (如果有的话)$构成</p>
<p>因此对于s&gt;1的序列，还要研究的就是u&#x3D;1和u&#x3D;2的情况</p>
<h2 id="2-0"><a href="#2-0" class="headerlink" title="2.0"></a>2.0</h2><p>考虑 <code>u=2</code></p>
<p>文章是<code>s-additives</code>,所以用的是<code>(s,u,v)</code>,本文其实只关注<code>(1,2,&gt;=5奇数)</code></p>
<p>忽略 v 是偶数，因为性质上 <code>(s,2,2n) = 2(s,1,n)</code></p>
<h2 id="2-3"><a href="#2-3" class="headerlink" title="2.3"></a>2.3</h2><p>(1,2,v&gt;&#x3D;5奇)</p>
<p>简写作$2,v(2)2v+1,2v+2,2v+3(2),3v,3v+4(4),5v+2,5v+4,5v+10,5v+12,5v+18,5v+20,5v+26,\cdots$</p>
<p>再根据v mod 4来确定最后的模式串是$7v+2,7v+6$或$7v+4,7v+12$</p>
<p>括号数字表示，以该数字递增</p>
<p>和上面证明类似(考虑2的系数和v的系数)，达到2v+1前，只会有<code>2,v+2k</code>构成，且k是从0取到$(v+1)&#x2F;2$所有整数,换句话说，和的表示总是会选择2，因为如果不选2则至少(v)+(v+2) &#x3D; 2v+2</p>
<p>接下来2v+2是一个特例,2v不可表示，所以一定是2v+2 &#x3D; (v+a)+(v+(2-a)),只有a&#x3D;0</p>
<p>注意到v的系数为1时，加的部分是偶数，所以在$(2v+2,3v]$的范围，(2v+(偶数&gt;2))有超过一种表示例如$(2v+4&#x3D;v+(v+4)&#x3D;2+(2v+2))$,对于$(2v+2k &#x3D; v+(v+2k) &#x3D; (v+2)+(v+2k-2))$其中$k&gt;&#x3D;3$, 对于(2v+(奇数&gt;2)),有且仅有表示$2v+(2k+1) &#x3D; 2+(2v+(2k-1))$,因为如果不选2的话v的系数只能选为1的，而v的系数为1的加的部分是偶数不可能加成2k+1</p>
<p>接下来3v+4,先说为啥没有$3v+1,3v+2,3v+3$,直接上表达式$3v+1&#x3D;v+(2v+1)&#x3D;(v+2)+(v+(v-1))$(v的取值范围让 2 !&#x3D; v-1), $3v+2&#x3D;2+3v&#x3D;v+(2v+2))$,$3v+3&#x3D;v+(2v+3)&#x3D;(v+2)+(2v+1))$</p>
<p>然后是为什么$3v+4$可选,$3&#x3D;0+3&#x3D;1+2$所以如果选2的话，3v+2不存在，只能$(v+a)+(2v+(4-a))$,a只能取2,唯一表示</p>
<p>k&gt;&#x3D;1</p>
<p>$3v+(2k+1) &#x3D; v+(2v+(2k+1)) &#x3D; (v+2) + (2v+(2k-1))$, 注意到$v~3v$的等差2的序列全有</p>
<p>所以序列中取最大的4个$(3v)+(3v-6) &#x3D; (3v-2)+(3v-4)$,k取$[1,(3v-7)&#x2F;2]$时$3v+(2k+1)$都是有多个表示方法的，需要注意的是这里的增加部分和上面表示略有不同，这里即使增加的部分即使超过了v，也是没有做改写,所以也涵盖了$[4v,5v]$的部分</p>
<p>$3v+(4k+2)$和$3v+4k$注意到这两个都是奇数，而奇数&#x3D;奇数+偶数，而偶数少得可怜，只有2和2v+2,相反v直到到3v的奇数是没有遗漏的被选择了，所以$3v+4k$是唯一表示$(2v+2)+(v+(4k-2))$而$3v+(4k+2)$则有含上面两个偶数的表示都存在。范围k，$4k-2&#x3D;2v$即$k&#x3D;(v+1)&#x2F;2$都可以也就是$5v+2$</p>
<p>接下来越来越复杂，先看看我们序列有什么</p>
<p>$2$,$v<del>2v+1$的等差2的奇数序列,$2v+2$,$2v+3</del>3v$等差2的奇数序列,$3v~5v+2$的等差4的奇数序列</p>
<p>然后我暂时不想再往5v和7v去证明了</p>
<h2 id="定理1"><a href="#定理1" class="headerlink" title="定理1"></a>定理1</h2><p>如果 v是大于3的奇数， (2,v)-Ulam序列,仅有两个偶数项</p>
<p>$U_1&#x3D;2$ and $U_{(v+7)&#x2F;2} &#x3D; 2v + 2$</p>
<p>本文仅需要 前½(3v + 11) terms，上面两个是唯一的偶数项（上面列举时已经证明）, 其实上面已经在列举的时候观察到了这两项，但是没有证明仅这两项是偶数</p>
<h2 id="引理2"><a href="#引理2" class="headerlink" title="引理2"></a>引理2</h2><p>考虑前(3v+11)&#x2F;2项</p>
<p>$2,v,(2),2v+1,2v+2,2v+3,(2),3v,(4),5v+2,5v+4,5v+10$</p>
<p>我们上面还剩下 5v+4 和 5v+10没证</p>
<p>$5v+3&#x3D;(3v)+(2v+3)&#x3D;(3v+4)+(2v-1)$多解</p>
<p>$5v+4&#x3D;2+(5v+2)$单解,$3v+2$不存在不能用$(2v+2)+(3v+2)$</p>
<p>$5v+5&#x3D;(3v)+(2v+5)&#x3D;(3v+4)+(2v+1)$多解</p>
<p>$5v+6&#x3D;2+(5v+4)&#x3D;(2v+2)+(3v+4)$多解</p>
<p>$5v+7&#x3D;(3v)+(2v+7)&#x3D;(3v+4)+(2v+3)$多解</p>
<p>$5v+8$ 没有表示方案</p>
<p>$5v+9&#x3D;(3v)+(2v+9)&#x3D;(3v+4)+(2v+5)$多解</p>
<p>$5v+10&#x3D;(2v+2)+(3v+8)$单解</p>
<p>因此说明了 在&lt;&#x3D;8v+8中 不存在别的偶解，因为如果存在则取存在的最小的且大于2v+2的，则它不能表示成两个偶数之和，否则它表示成a(小于4v+4)+b(大于4v+4),存在更小解b矛盾，</p>
<p>要么表示成奇数之和，注意到在$(8v+8) &#x3D; (5v+10)+(3v-2)$,也就是$(5v+10)+(v<del>3v-2)$能表示$6v+10</del>8v+8$的所有偶数,同样选取$5v+2$和$5v+4$可知从$6v+4~8v+8$都有不只一种表示方法</p>
<p>也就是如果选取的数唯一表示的 取值中有大于$(5v+10)$的，那剩余的部分一定小于$(3v-2)$,设存在的最小大于5v+10的偶数为$5v+2 &lt; v &#x3D; i(&gt; 5v+10) + j(&lt;3v - 2) &lt;&#x3D; 8v+8$</p>
<p>那我们关心的还剩下$(5v+10,6v+4)$之间是否还村在唯一表示的偶数</p>
<p>$5v+(2k+1) &#x3D; (3v+4j) + (2v+(2k+1-4j))$</p>
<p>$4j \in [0,2v-2]$ 的所有4的倍数</p>
<p>$(2k+1-4j) \in [-v,v]$ 的所有奇数</p>
<p>$(2k+1) \in [-v+2,3v-4]$ 的所有奇数都至少有一个以上的表示方式 (这里重复会怎么样？还是只要非端点，内部重复少一次，还是能大于1,毕竟如此的表示方案次数的规律是 从1开始先增后减最后是1 )</p>
<p>所以$5v+(2k+1) \in [4v+2,8v-4]$都是有至少两种表示方法的了</p>
<p>因此证明了8v+8内，有且只有两个偶数项</p>
<h2 id="引理3"><a href="#引理3" class="headerlink" title="引理3"></a>引理3</h2><p>x是最小的大于2v+2的偶数，那么取任意奇数r,满足$1\leq r &lt; x-2v$,那么必有i满足$0\leq i \leq v$ and $r+2i\in S$,也就是有比它小的任意奇数加某个2i后 在序列中</p>
<p>反证，如果上述不成立，那么r取满足$r&lt;x-2v$和${r+2i:0\leq i \leq v} 交 S &#x3D; 空$的最小正奇数(r&gt;&#x3D;3)，也就是一个r让上述的值都不属于S</p>
<p>也就有$r+2v,r+2v-2$都不属于S</p>
<p>注意到$r+2v &#x3D; (r-2)+(2v+2) &#x3D; (r+2v-2)+2$所以$(r-2)$也不属于S，否则$r+2v$唯一表示</p>
<p>因此有${(r-2)+2i:0\leq i \leq v} 交 S &#x3D; 空$，说明了(r-2)才是最小（这里应该是r不能取大于等于3的, r 取1单独讨论也是满足）</p>
<p>r&#x3D;1时，显然i取v，$1+2v\in S$ ，所以证毕。 </p>
<blockquote>
<p>任意 奇数r 满足 $1 \leq r &lt; x - 2v$. 存在i，满足 $0 \leq i \leq v$ and $r + 2i \in S$.</p>
</blockquote>
<hr>
<p>如果$x&gt;8v+8$, $a&lt;b$( 且 a和b是S中的奇数,因为偶数就那两个,不可能了)满足 x&#x3D;a+b,令r&#x3D;x-3v,根据引理3,我们存在$0\leq i \leq v$并且$(x-3v)+2i \in S$,</p>
<p>再由引理2的序列，知$\{3v-2i:0\leq i \leq v\} \subseteq S $，就是v到3v之间所有偶数都可以取到，</p>
<p>因此的到a和b的具体值(如果x能表示)$(a,b) &#x3D; (3v-2i, x-3v+2i)$</p>
<p>对于$0\leq j\leq v, j\neq i$,有$x-3v+2j \notin S$ 因为如果属于，则也能找到对应的$a,b$，那么x的表示方法就不唯一了，因此0~v之间有且仅有唯一的$i$可选来得到a和b的值,</p>
<blockquote>
<p>$[x-3v, x-3v+2v &#x3D; x-v]$之间所有奇数有且只有一个属于S</p>
</blockquote>
<hr>
<p>然后考虑$[x-5v-2,x-5v-2 + 2v &#x3D; x-3v-2]$ 之间所有奇数的状况</p>
<p>$x-3v+2j &#x3D;((x-5v-2)+(2j))+(2v+2) &#x3D;  (x-3v+2j-2)+2$</p>
<p>说明如果$x-5v-2+2j \in S$</p>
<p>那么$x-3v+2j$和$x-3v+2j-2$至多只有一个存在,(否则$x−3v+2j$有多种表示方法</p>
<p>同时如果$x-3v+2j-2$不存在，那么$x-3v+2j$唯一表示，所以至少一个存在，</p>
<blockquote>
<p>综上，$x-5v-2+2j \in S, 0\leq j \leq v$当前仅当$x-3v+2j$和$x-3v+2j-2$其中一个存在于S</p>
</blockquote>
<hr>
<p>对于$[x-3v, x-v]$之间唯一可能存在的$x-3v+2i$</p>
<p>考虑$i$的取值</p>
<p>如果$0 \leq i &lt; v$, 当且仅当 $x-3v+2i - (2v+2) \in S$ 或 $x-3v+2(i+1) - (2v+2) \in S$,直接由上面的当且仅当得到</p>
<p>如果$i &#x3D; v$, 和上面不同，这里不取不到$2(i+1)$,首先因为上面证明了 $x-3v+2v &#x3D; x - v$和$x-3v$不会同时属于S,也因为$x-3v$这个值也不在$[x-5v-2, x-3v-2]$范围中，</p>
<p>其实对于 $0 &lt; j \leq v$, $x-3v+2j &#x3D; 2+(x-3v+2j-2)&#x3D;(2v+2)+(x-3v+2j-(2v+2)) \in S$，又$[x-3v,x-v]$仅能有一个奇数出现,第一个等式必不成立</p>
<blockquote>
<p>$0 &lt; j \leq v$有$x-3v+2j\in S$ 当且仅当$x-3v+2j-(2v+2)\in S$</p>
</blockquote>
<p>所以对于$0&lt;j&lt;v$,$x−3v+2j \in S$得到 $x-3v+2j - (2v+2) \in S, x-3v+2j+2 - (2v+2) \in S, $, 而又由上得到 $x-3v+2j - (2v+2)+(2v+2) \in S, x-3v+2j+2 - (2v+2)+(2v+2) \in S$,和$x-3v+2j+2 \notin S$ 矛盾</p>
<blockquote>
<p>所以$i$的可能取值只有$0$和$v$</p>
</blockquote>
<hr>
<p>$i&#x3D;0$,$(a,b)&#x3D;(3v,x-3v)$,$x-3v-(2v+2) \in S$ 或$x-3v-(2v+2)+2 \in S $</p>
<p>$x-3v-(2v+2) \in S$, 因为x唯一表示, 所以关于x的补也不属于S:$3v+(2v+2) \notin S$ 和枚举$5v+2 \in S$的矛盾,(依靠x的范围保证了这是两种不同的表示)</p>
<p>所以有 $x-3v \in S$ 当且仅当 $x-5v \in S$ &#x3D;&gt; $x-5v+(2v+2) \in S$ 矛盾,因为$[x-3v,x-v]$仅有一个属于S</p>
<hr>
<p>$i&#x3D;v$,$(a,b)&#x3D;(v,x-v)$,$x-v-(2v+2) \in S$ 或$x-v-(2v+2)+2 \in S $</p>
<p>因为x唯一表示, 所以关于x的补也不属于S:$v+(2v+2) \notin S$ 或 $v+(2v+2)-2 \notin S$ 和枚举的矛盾,(依靠x的范围保证了这是两种不同的表示)</p>
<hr>
<p>综上 不存在大于8v+8的偶数</p>
<h2 id="周期"><a href="#周期" class="headerlink" title="周期"></a>周期</h2><p>是最终周期性的，（就是从某项开始，差分是周期的）</p>
<p>最小的$N(v)$记为 差分的周期,</p>
<p>对于大的n差分循环为$D(v) &#x3D; S_{N(v)-n}-S_n$ 叫做Fundamental difference</p>
<p>密度$d(v) &#x3D; N(v)&#x2F;D(v)$</p>
<p>On the Regularity of Certain 1 -Additive Sequences 这篇论文还给了一个这三个取值的table, 当然对我们来说做题，其实足够了，但是我还是希望证明1.周期存在，2.如何判断进入周期了</p>
<blockquote>
<p>定义 如果一个1-additive序列的差分是最终周期性的，称它为regular的</p>
</blockquote>
<h2 id="定理2"><a href="#定理2" class="headerlink" title="定理2"></a>定理2</h2><p>如果一个1-additive 序列只有有限个偶数项，那么它是regular的</p>
<p>题目虽然是任意个，我们这里只证明仅有2和2v+2为偶数项的,有限项同理，核心是抽屉原理</p>
<p>令f(x) &#x3D; 1 当x在序列中，f(x) &#x3D; 0 当x不在序列中</p>
<p>有 $f(x) &#x3D; f(x-2) xor f(x-2v-2)$</p>
<p>$g(x) &#x3D; 向量 (f(x) f(x+2) … f(x+4v-2))$</p>
<p>$g(x+4v) &#x3D; 向量 (f(x+4v) f(x+4v+2) … f(x+4v-2))$</p>
<p>所以g(x) 由与x无关的函数唯一决定 g(x+4v)</p>
<p>g(x) 的状态数为 2v 有限，因此g(x+4v)也是有限的</p>
<p>所以 g(x+4kv) 必定循环</p>
<p>循环证必</p>
<blockquote>
<p>注意这里取4v有点大，实际上可以缩小到一定范围都行，比如有paper是按照更小的来取的，这里主要是能制造一个靠固定公式递推的向量即可，足够大，可以完全不考虑其具体大小得到“循环”这个性质</p>
</blockquote>
<h2 id="找循环节"><a href="#找循环节" class="headerlink" title="找循环节"></a>找循环节</h2><p>直接按照上面的方法能找到一个，然后根据约数缩减即可</p>
<p>仔细一想，因为是从小到大尝试是否是循环节，那么这个值就一定是起始值和循环节，因此不需要约数</p>
<h2 id="继续"><a href="#继续" class="headerlink" title="继续"></a>继续</h2><p>我以为证明了有循环节就可以编码了，</p>
<p>然后写完以后，跑得很慢，看了一下论文的table上面的数据，在(2,17),(2,19),(2,21)时，循环节很大，滑窗搜索写得就有太慢了？也许是我写的问题？感觉我写的 (2v+1)k^2起 ，k是循环节，而在21时，循环节已经2e6了，感觉我内存炸掉比结果先来到</p>
<p>差分循环节长度$N$</p>
<p>循环节的差 $D &#x3D; a_{N+n} - a_n$ </p>
<p>比如对于(2,5) 有<code>(N,D) = (32,126)</code></p>
<p>令$b_n $表示 $2n+1$ 的方案数</p>
<p>对于足够大的n, 因为有且只有两个偶数其实我们就得到 $b_n &#x3D; b_{n-1} xor b_{n-v-1}$,实际上就是由2或2v+2组成</p>
<p>这里paper提到了ring，&#x2F;&#x2F; 奈何我暂无相关知识(查了一下 两种运算(加法和乘法)闭合集) XD, 虽然可以抑或，但缺点是抑或没有组合性质，那就加法模2</p>
<p>$b_n &#x3D; b_{n-1} xor b_{n-v-1} (mod 2)$,$b_n$取值范围在$0,1$中</p>
<p>其实我们把它们变成矩阵和矩阵乘法</p>
<p>初始矩阵，令</p>
<p>$\beta_{(v+1)&#x2F;2} &#x3D; (b_{-(v+1)&#x2F;2} b_{-(v-1)&#x2F;2} \cdots b_{(v-3)&#x2F;2} b_{(v-1)&#x2F;2})^T &#x3D; (0 0 \cdots 0 1)^T$</p>
<p>也就是注意到$b_{(v-1)&#x2F;2}$表示的是v可以表达，前面的都是小于v的奇数不论正负，都不能表达，从而产生奇数的序列。</p>
<p>转换矩阵是</p>
<p>$\mathbf{A}_{(v+1)\times (v+1)} &#x3D; \begin{bmatrix}<br>0 &amp; 1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\<br>0 &amp; 0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\<br>0 &amp; 0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 \\<br>\cdots &amp; \cdots &amp; \cdots &amp; \cdots &amp; \cdots &amp; \cdots &amp; \cdots \\<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 &amp; 0 \\<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 \\<br>1 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 \end{bmatrix}$</p>
<p>除了最后一行是递推，上面的都是平移</p>
<p>这里我们注意到，转换矩阵是模非零，说明矩阵存在，所以循环一定能循环到初始矩阵</p>
<p>我们令$p &#x3D; (v+1)&#x2F;2$假设$q, q &gt; p$首次让$\beta_q &#x3D; \beta_p$</p>
<p>那么</p>
<p>$ N &#x3D; \sum_{k&#x3D;p-1}^{q-2} b_k$, 其实就是$\beta$的下标和向量内最大的b的下标差1,然后 统计这之间所有等于1的$b_k$</p>
<p>$D&#x3D;2(q-p)$,直接就是值的差</p>
<p>特征多项式 $f(x) &#x3D; det(xI + A) &#x3D; x^{v+1}+x^v+1， f(-A) &#x3D; 0$, v的奇数决定了矩阵的长宽是偶数, 用途是加速矩阵高幂次运算</p>
<p>我们之前有递推 $\beta_{n+1} &#x3D; A \beta_n$,有这两个工具即使枚举就可以很快得到答案了</p>
<hr>
<p>推到这，我才突然回想，既然在证明循环时，已经有了递推表达式，那就不需要模拟，也不需要上面这样去算</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,a,n) for (ll i=a;i&lt;n;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"></span><br><span class="line">ll v ; <span class="comment">// (2,v)</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; arr; <span class="comment">// [0]v,[1]v+2,[2]v+4</span></span><br><span class="line">vector&lt;ll&gt; vals; <span class="comment">// [0]v,[1]v+2,[2]v+4</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getidx</span><span class="params">(<span class="type">int</span> idx)</span></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(idx &lt; v)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> arr[(idx-v)/<span class="number">2</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">work</span><span class="params">(ll val,ll query)</span></span>&#123;</span><br><span class="line">  arr.<span class="built_in">clear</span>();</span><br><span class="line">  vals.<span class="built_in">clear</span>();</span><br><span class="line">  v = val;</span><br><span class="line">  arr.<span class="built_in">pb</span>(<span class="number">1</span>);</span><br><span class="line">  vals.<span class="built_in">pb</span>(v);</span><br><span class="line">  ll idx = v+<span class="number">2</span>;</span><br><span class="line">  <span class="comment">// zero cnt // 初始状态 v个0 1个1</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> zCnt = <span class="number">0</span>;;idx+=<span class="number">2</span>)&#123;</span><br><span class="line">    <span class="keyword">auto</span> zo = <span class="built_in">getidx</span>(idx<span class="number">-2</span>) ^ <span class="built_in">getidx</span>(idx<span class="number">-2</span>*v<span class="number">-2</span>);</span><br><span class="line">    arr.<span class="built_in">pb</span>(zo);</span><br><span class="line">    <span class="keyword">if</span>(!zo)&#123;</span><br><span class="line">      zCnt++;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; <span class="comment">// zo == 1</span></span><br><span class="line">      <span class="keyword">if</span>(zCnt == v)&#123;</span><br><span class="line">        <span class="comment">// query is enough large</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld:%zu %lld\n&quot;</span>,v, vals.<span class="built_in">size</span>(),idx-v);</span><br><span class="line">        query -= <span class="number">2</span> + <span class="number">1</span>; <span class="comment">// 2even number and 0-index</span></span><br><span class="line">        ll ans = vals[query % vals.<span class="built_in">size</span>()] + (query/vals.<span class="built_in">size</span>()) * (idx-v);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[%lld]\n&quot;</span>,ans);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        zCnt = <span class="number">0</span>;</span><br><span class="line">        vals.<span class="built_in">pb</span>(idx);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// never be here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">rep</span>(i,<span class="number">2</span>,<span class="number">11</span>)&#123;</span><br><span class="line">    ans += <span class="built_in">work</span>(<span class="number">2</span>*i+<span class="number">1</span>, <span class="number">100&#x27;000&#x27;000&#x27;000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Ans: %lld\n&quot;</span>,ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h1><p>我们虽然只想求 Ulem序列的某种特殊情况<code>sum(2,odd &gt;= 5,10**11)</code></p>
<p>但是因为资料匮乏，只能自己搜paper啃，学习了<code>s-additives</code>的定义，证明了部分性质。</p>
<p>这个带变量的大量“枚举”第一次这样思考，分类的时候很怕有特殊情况没有考虑到，感觉是不是要去学coq了</p>
<p>另外本题在证明过程中的同一个数字的不同表示法</p>
<p>证明用了不少次反证+最小矛盾的方法</p>
<p>几个引理还是挺漂亮的，利用唯一性和奇偶性和2v+2建立 充要关系</p>
<p>有些paper有点自顶向下证明</p>
<p>在证明有限偶数是这个题的核心，一旦证明了有限偶数，剩余的部分就比较容易了</p>
<p>感觉paper上除了有笔误，证明也不太对？没太懂几个隐含推出是为啥</p>
<p>上面有不少部分和题目本身无关，如s-additives在s&gt;1的情况的性质</p>
<p>这里的向量忽略掉偶数的建立方式和只包含首个v的建立方式，有点意思，简化了初始和边界问题（不过也依赖本身偶数只是穿插到奇数序列中，不影响奇数序列本身的递推公式的性质上，</p>
<p>TODO 整理表述、符号一致性和笔误修复</p>
<h1 id="Ulam-Sequence-延伸相关"><a href="#Ulam-Sequence-延伸相关" class="headerlink" title="Ulam Sequence 延伸相关"></a>Ulam Sequence 延伸相关</h1><p>例如数列密度猜想</p>
<p>cos性质</p>
<p>等等，都在这道题目以外，目前没有深究</p>
<h1 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h1><p><a target="_blank" rel="noopener" href="https://oeis.org/A002858">oeis U(a,2)</a></p>
<p><a target="_blank" rel="noopener" href="https://mathworld.wolfram.com/UlamSequence.html">mathworld:Ulam Sequence</a></p>
<p><a target="_blank" rel="noopener" href="https://www.wolframalpha.com/input/?i=ulam+sequence">WolframAlpha</a></p>
<p><a target="_blank" rel="noopener" href="https://archive.lib.msu.edu/crcmath/math/math/u/u005.htm">msu: Ulam Sequence</a></p>
<p><a target="_blank" rel="noopener" href="http://oeis.org/A100730">Fundamental difference of Ulam 1-additive sequence starting U(2,2n+1).</a></p>
<p><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/0097316572900830?via=ihub">1972, Sur les suites s-additives</a></p>
<p><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/009731659290042S">1990, On the regularity of certain 1-additive sequences</a></p>
<p><a target="_blank" rel="noopener" href="http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=A343AB3C23E3A9FD650ABB586F677247?doi=10.1.1.27.7259&rep=rep1&type=pdf">1992, Patterns in 1-Additive Sequences</a></p>
<p><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/0097316594900582?via=ihub">1994, The regularity of some 1-additive sequences</a></p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1507.00267.pdf">2016, A Hidden Signal in the Ulam sequence</a></p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1705.01883.pdf">2018, ULAM SEQUENCES AND ULAM SETS</a></p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1804.09594.pdf">2018, STRUCTURES IN ADDITIVE SEQUENCES</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/atcoder/arc/113/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/atcoder/arc/113/" class="post-title-link" itemprop="url">Atcoder arc113 E (数学+枚举+分类讨论)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2021-02-22 10:37:14" itemprop="dateCreated datePublished" datetime="2021-02-22T10:37:14+08:00">2021-02-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2024-01-26 01:38:13" itemprop="dateModified" datetime="2024-01-26T01:38:13+08:00">2024-01-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Atcoder/" itemprop="url" rel="index"><span itemprop="name">Atcoder</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Atcoder/ARC/" itemprop="url" rel="index"><span itemprop="name">ARC</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/atcoder/arc/113/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="atcoder/arc/113/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>1.6k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>5 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/arc113/tasks/arc113_e">https://atcoder.jp/contests/arc113/tasks/arc113_e</a></p>
<p>题目大意</p>
<p>给字符串,仅由a和b组成</p>
<p>操作: 任意选择两个相同的字母，把它们之间的内容 颠倒顺序，删掉这两个被选择的字母</p>
<p>你可以操作 0 到任意次</p>
<p>求字典序最大的结果</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>显然，可以把a看作0,b看作1,也就是1尽量靠前且尽量多，而在满足1尽量多的时候，让0也尽量多</p>
<p>显然 如果0有偶数个，可以不消耗任何1,让结果以1开始</p>
<p>如果以0结束，也同样可以不消耗任何1,让结果以1开始</p>
<p>…</p>
<p>那么就是如何分类是这个问题的关键，怎么尽量少的分化，覆盖所有情况。</p>
<p>比赛里做出的人不多，有些cf红名大佬都没出 XD</p>
<p>我在讨论时，从 起始字符，终止字符，字符个数，连续字符个数多个方面去分类，想也不用想，没写出来,(之讨论到了部分情况)</p>
<hr>
<p>直接看看 官方答案 怎么搞的。</p>
<h2 id="a结束"><a href="#a结束" class="headerlink" title="a结束"></a>a结束</h2><p>显然</p>
<p>如果前面的a偶数个，能不删除b变成 <code>b*a+</code>的形式</p>
<p>如果前面的a奇数个，能不删除b变成 <code>b*a*</code>的形式</p>
<p>那么我们其实要求的变成了，如何尽可能的少删除a</p>
<p>注意到因为完全不会删除b，所以不论b有多少个，它原本连接在一起就不会被拆开。</p>
<p>所以把连接在一起的b看作一个b，可以看作</p>
<p><code>(a+)b(a+)b(a+)b(a+)b(a+)b(a+)</code> 的形式</p>
<p>那么我们一次 删除a至少连接 一次b，至多连接两次b。</p>
<p>选取一个<code>b(a&#123;2,&#125;)b</code> 和 <code>b(a+)b</code>中的a进行删除 能连接一次b</p>
<p>选取两个<code>bab</code>中的a进行删除 能连接两次b</p>
<p>所以<code>长度为1的a</code>和<code>长度为1的a</code>先完成同时选择删除，最后处理剩余a</p>
<p>这样能做到总的操作次数最少 <code>= a(len=1) / 2 + a(len=1)%2 + a(len&gt;1)</code> (不包括最后的a串)</p>
<p>例如 <code>aaabababababaaaaaa</code> ,a的连续串有4个1和1个3,所以删除次数 &#x3D; 4&#x2F;2 + 0 + 1 &#x3D; 3, 剩余a的个数&#x3D;原始个数-2x3</p>
<p>至此，对于a结束的情况可以解了</p>
<h2 id="b-结束"><a href="#b-结束" class="headerlink" title="b 结束"></a>b 结束</h2><p><code>abb</code> 和 <code>aabb</code> 结果就很不一样，看着这些连局部性都没有的串，很难受</p>
<h3 id="如果a是偶数个"><a href="#如果a是偶数个" class="headerlink" title="如果a是偶数个"></a>如果a是偶数个</h3><p>那必定可以不损耗b，且损耗所有a</p>
<h3 id="a是奇数个"><a href="#a是奇数个" class="headerlink" title="a是奇数个"></a>a是奇数个</h3><p>现在的情况，奇数个a+结尾是b</p>
<p>继续讨论结尾</p>
<h4 id="ab结尾"><a href="#ab结尾" class="headerlink" title="ab结尾"></a>ab结尾</h4><p>奇数个a，显然a删不完，那么这个ab结尾的b肯定无法移动到前面</p>
<p>对于b的个数，把字符串删来剩下一个a,可以不损耗b的情况得到<code>b*ab</code></p>
<p>所以，前缀b最多是b的个数-1,也是可达到的。</p>
<p>这是可达也是最大可达的字符串，因为如果选了b，一定就变成个数-2,会比这个结果小</p>
<h4 id="abb结尾"><a href="#abb结尾" class="headerlink" title="abb结尾"></a>abb结尾</h4><p>同上</p>
<p>我们可以得到 <code>b*abb</code>, 其中不会损耗任何b，前缀b的个数&#x3D;b总个数-2</p>
<p>那 我们任何选择b的操作 都会 导致b的个数 &lt;&#x3D; 总个数-2,</p>
<p>所以，这也是最大可达</p>
<h4 id="bbb结尾"><a href="#bbb结尾" class="headerlink" title="bbb结尾"></a>bbb结尾</h4><p>（这种情况，我没有在赛内讨论到方案）</p>
<p>你看 <code>aaaaabbbbb</code>,<code>abaaaabbbb</code>, 就很不一样</p>
<h5 id="a-b"><a href="#a-b" class="headerlink" title="a+b+"></a>a+b+</h5><p>显然，其实都没了翻转只有删除，那 <code>ab+</code> 就是结果了</p>
<h5 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h5><p><code>a*b+a+b+</code></p>
<p>其中 一定有<code>ba</code></p>
<p>把它的b和末尾的b交换，一定能b少两个且以a结尾。(就是上面讨论过的情况)</p>
<p>从而 b的个数减2,以b开头是一个解</p>
<p>又字符串, 在不操作b的情况下，一定能变成 <code>b+ab+</code>，保留原始最后的a，这是能得到的最大的</p>
<p>也是比操作了b一次字典序小。（个数 小于 b的个数减2）</p>
<p>所以，一定要操作且仅操作一次b。</p>
<p>答案一定是 <code>b+a*</code> 其中b的个数少两个</p>
<p>那么这种情况又是讨论，如何留下尽可能多的a</p>
<p>首先，操作b的时候一定选的是ba的b，因为其余情况，都无法让结尾变成a，而结尾不是a的情况如上，得不到更长的b的前缀。</p>
<p>注意到对于a结尾我们已经有了答案，最后一个b前面x个长为1的a和y个长大于1的a，那么x&#x2F;2 + x%2 + y</p>
<p>我们直接定义，在处理之前的状态叫做预期答案，也定义为 x&#x2F;2 + x%2 + y。</p>
<p>那么，那一次选择两个b的操作</p>
<p><code>.*b[(a+)b.*bb]b</code> &#x3D;&gt; <code>.*[bbb.*b(a+)]</code></p>
<p>如果<code>(a+)</code> 的部分长是1， 那么根据1个数的奇偶性，可能让预期答案减1或减少0</p>
<p>如果<code>(a+)</code> 的部分长度大于1, 那么让预期的答案减1</p>
<p>又如果先操作a，再操作b。</p>
<p>操作a时，产出和剩余预期的和为常量，且a的奇偶性不变</p>
<p>综上，存在<code>b(a&#123;2,&#125;)</code> 则换它的b</p>
<p>否则换<code>ba</code>的b</p>
<p>最后和1一样计算a的个数</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>分类有点难，其实上面几种情况全都有推过，但是我在类型分化时加上了起始的 字符，这样的题解看下来，是不太需要讨论起始字符的。但是在推的过程中不知道怎么排除。</p>
<p>第二是我分类的时候，奇偶的分类顺序比结束字符的高，又导致了过多的分类分叉 QAQ</p>
<p>然后我还有想转换（从情况某某+操作转换到情况某某），这样看来这题也不太需要转换</p>
<p>另外其实对于代码上做分类，不太怕重复，毕竟如果两个非类方式有重复，进任何一种都可以，怕的是漏掉了分类。</p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><p>分类的顺序和内容做好了，还要啥代码呢</p>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/arc113/submissions/20437840">https://atcoder.jp/contests/arc113/submissions/20437840</a></p>
<h1 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h1><p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/arc113/editorial/792">https://atcoder.jp/contests/arc113/editorial/792</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/pe/137/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/pe/137/" class="post-title-link" itemprop="url">project euler 137 (pell 方程右侧为-4 )</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-12-06 10:37:14" itemprop="dateCreated datePublished" datetime="2020-12-06T10:37:14+08:00">2020-12-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2024-01-26 01:38:14" itemprop="dateModified" datetime="2024-01-26T01:38:14+08:00">2024-01-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Project-Euler/" itemprop="url" rel="index"><span itemprop="name">Project Euler</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/pe/137/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="pe/137/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>976</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>3 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>$A(x) &#x3D; 1x + 1x^2 + 2x^3+ 3x^4+5x^5+8x^6+..$</p>
<p>已知$A(x)$(整数) 求问,x为有理数时$A(x)$的取值序列</p>
<p>$xA(x) &#x3D; 1x^2 + 1x^3 + 2x^4+ 3x^5+5x^6+8x^7+..$</p>
<p>$(1-x)A(x) &#x3D; x + 1x^3 + 1x^4 + 2x^5+ 3x^6+5x^7+8x^8+..$</p>
<p>$(1-x)A(x) &#x3D; x + x^2A(x)$</p>
<p>$A(x)x^2 +(1+A(x))x - A(x) &#x3D; 0$</p>
<p>$x &#x3D; \frac{\sqrt{1+2A(x)+5A(x)^2}-1-A(x) }{2A(x)}$ (只考虑正的取值)</p>
<p>也就是找$1+2x+5x^2&#x3D;y^2$ 的解</p>
<p>在pe 100 里面我们讨论过变形</p>
<p>$5+10+25x^2&#x3D;5y^2$</p>
<p>$4+(1+5x)^2&#x3D;5y^2$</p>
<p>$(1+5x)^2-5y^2&#x3D;-4$</p>
<p>形式上是个pell方程右侧换成-4</p>
<h1 id="pell方程"><a href="#pell方程" class="headerlink" title="pell方程"></a>pell方程</h1><p>在做过66和100以后，回顾看看</p>
<p>66是pell方程，解一定是渐进分数，且一定有解，所有解能由基础解的幂次生成</p>
<p>100是pell方程右侧改为-1的方程，解一定是渐进分数，但没有证明到一定有解(d&#x3D;34时似乎真的没解)，通过连分数的递推寻找</p>
<p>这里</p>
<p>我们关心一下和佩尔方程的关系</p>
<p>在pe66，100中我们的步骤是这样的</p>
<p>$x^2-d y^2 &#x3D; \pm 1$</p>
<p>$|\sqrt{d}-\frac{x}{y}| &#x3D; |\frac{dy^2-x}{y^2(\sqrt{d}+\frac{x}{y})}| &lt; \frac{1}{2y^2}$</p>
<p>然后满足上面不等式的一定是连分数的渐进分数</p>
<p>我们假设$x^2-dy^2 &#x3D; c$</p>
<p>$\frac{x}{y} &#x3D; \sqrt{d+\frac{c}{y^2}}$</p>
<p>上面式子的放缩部分是 $|\frac{c}{\sqrt{d}+\frac{x}{y}}| &lt; \frac{1}{2}$</p>
<p>$ |\frac{4}{\sqrt{5}+\sqrt{5-\frac{4}{y^2} } }| &lt; \frac{1}{2}$</p>
<p>当c比较大时 例如 $x^2-10y^2&#x3D;9$ 有三组解答 $(7,2)…$, $(13,4)…$,$(57,18),…$</p>
<h1 id="如果为正"><a href="#如果为正" class="headerlink" title="如果为正"></a>如果为正</h1><p>考虑两组满足 $x^2-5y^2&#x3D;-4$的值</p>
<p>根据pe100的结论，$(9+4\sqrt{5})^n$ 是 其佩尔方程的基础解对应的值</p>
<p>$1&#x3D;\frac{x_0^2-dy_0^2}{x_1^2-dy_1^2} $</p>
<p>$&#x3D; \frac{x_0+y_0\sqrt{d}}{x_1+y_1\sqrt{d}} \cdot \frac{x_0-y_0\sqrt{d}}{x_1-y_1\sqrt{d}}$</p>
<p>$&#x3D; \frac{(x_0+y_0\sqrt{d})(x_1-y_1\sqrt{d})}{-4} \cdot \frac{(x_0-y_0\sqrt{d})(x_1+y_1\sqrt{d})}{-4}$</p>
<p>$&#x3D; ((\frac{x_0x_1-y_0y_1d}{4})+(\frac{x_1y_0-x_0y_1}{4})\sqrt{d})((\frac{x_0x_1-y_0y_1d}{4})-(\frac{x_1y_0-x_0y_1}{4})\sqrt{d})$</p>
<p>$&#x3D; (\frac{x_0x_1-y_0y_1d}{4})^2-(\frac{x_1y_0-x_0y_1}{4})^2 d $</p>
<p>说明两个不同的<code>-4</code>的解, 如果能让$x_1y_0-x_0y_1 &#x3D; 0 (\pmod 4)$,那么它们之间一定是通过乘一个<code>=1</code>的解得到的,(之考虑y是因为如果y为整数且等式成立，那么x必为整数),也就是它们有同样的基础解</p>
<p>如果y是偶数，$y &#x3D; 2k$,显然 x也是2的倍数，直接解 $(2x)^2-5(2y)^2&#x3D;-4$,$x^2-5y^2&#x3D;-1$ 解之即可</p>
<p>如果y是奇数, x也是奇数</p>
<p>根据mod 4进行分类</p>
<p>$(4k_0+1,4k_1+1) ,(4k_0+3,4k_1+3)$ 有同样的基础解(如果有解) </p>
<p>$(4k_0+1,4k_1+3) ,(4k_0+3,4k_1+1)$ 有同样的基础解(如果有解)</p>
<p>所以最后分为3类</p>
<p>注意到基础解的幂次可乘性, 考虑<code>(x,y)</code>为最小全正解，$x&gt;0,y&gt;0$</p>
<p>$(x+y\sqrt{5})(9+4\sqrt{5})^{-1} &#x3D; (x+y\sqrt{5})(9-4\sqrt{5})$</p>
<p>$ &#x3D; ((9x-20y)+(9y-4x)\sqrt{5})$ , 因为是最小正解，所以再次乘积后 $9x-20y &lt; 0$ 或 $9y-4x&lt;0$</p>
<p>$ \frac{x}{y} &lt; \frac{20}{9} 或  \frac{x}{y} &gt; \frac{9}{4}$ </p>
<p>$ \sqrt{5-\frac{4}{y^2}} &lt; \frac{20}{9} 或  \sqrt{5-\frac{4}{y^2}} &gt; \frac{9}{4}$ </p>
<p>$\frac{2}{\sqrt{5}} \le y &lt; \frac{18}{\sqrt{5}} 约 8.049844718999243 $</p>
<p>要尝试的y有限</p>
<p>综上原题可解</p>
<h1 id="Code-1"><a href="#Code-1" class="headerlink" title="Code 1"></a>Code 1</h1><p>尝试8以内</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">isSquare</span>(<span class="params">v</span>):</span><br><span class="line">    <span class="keyword">if</span> v == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    l = <span class="number">1</span></span><br><span class="line">    r = v</span><br><span class="line">    <span class="keyword">while</span> l+<span class="number">1</span> &lt; r:</span><br><span class="line">        m = (l+r)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> m*m == v:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> m*m &gt; v:</span><br><span class="line">            r = m</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = m</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">9</span>):</span><br><span class="line">        <span class="keyword">if</span> isSquare(<span class="number">5</span>*i*i-<span class="number">4</span>):</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<p>运行得到基础解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 1</span><br><span class="line">4 2</span><br><span class="line">11 5</span><br></pre></td></tr></table></figure>

<h1 id="Code2"><a href="#Code2" class="headerlink" title="Code2"></a>Code2</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    arr = [(<span class="number">1</span>,<span class="number">1</span>),(<span class="number">4</span>,<span class="number">2</span>),(<span class="number">11</span>,<span class="number">5</span>)]</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> cnt &lt; <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(arr)):</span><br><span class="line">            x,y = arr[i]</span><br><span class="line">            <span class="keyword">if</span> x &gt; <span class="number">1</span> <span class="keyword">and</span> (x-<span class="number">1</span>)%<span class="number">5</span>==<span class="number">0</span>:</span><br><span class="line">                cnt+=<span class="number">1</span></span><br><span class="line">                <span class="built_in">print</span>((x-<span class="number">1</span>)//<span class="number">5</span>)</span><br><span class="line">            arr[i] = (<span class="number">9</span>*x+<span class="number">20</span>*y,<span class="number">9</span>*y+<span class="number">4</span>*x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>







<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://math.stackexchange.com/questions/742181/find-all-integer-solutions-for-the-equation-5x2-y2-4">https://math.stackexchange.com/questions/742181/find-all-integer-solutions-for-the-equation-5x2-y2-4</a></p>
<p><a target="_blank" rel="noopener" href="https://math.stackexchange.com/questions/1088277/fermats-difference-equation-pells-equation">https://math.stackexchange.com/questions/1088277/fermats-difference-equation-pells-equation</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/pe/066_new/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/pe/066_new/" class="post-title-link" itemprop="url">project euler 066 diophantine equation(关键内容重新整理版)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-12-05 10:37:14" itemprop="dateCreated datePublished" datetime="2020-12-05T10:37:14+08:00">2020-12-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2024-01-26 01:38:14" itemprop="dateModified" datetime="2024-01-26T01:38:14+08:00">2024-01-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Project-Euler/" itemprop="url" rel="index"><span itemprop="name">Project Euler</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/pe/066_new/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="pe/066_new/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>8.3k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>28 分鐘</span>
    </span>
</div>

            <div class="post-description">从零入门 pell 方程</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="解pell方程"><a href="#解pell方程" class="headerlink" title="解pell方程"></a>解pell方程</h1><p>就过程进行书写,去掉自己尝试思考的中间步骤,只留下有效的过程</p>
<p><a href="http://yexiaorain.github.io/Blog/2020-05-29-project-euler066/">初版文章</a></p>
<h2 id="原题目"><a href="#原题目" class="headerlink" title="原题目"></a>原题目</h2><p><a target="_blank" rel="noopener" href="https://projecteuler.net/problem=66">https://projecteuler.net/problem=66</a></p>
<p>$d &#x3D; 1\to 1000$,d是非平方数</p>
<p>对于每个$d$ 求最小的正整数$x$使得$x^2-dy^2&#x3D;1$,其中$x$,$y$都是正整数,</p>
<p>最后对所有这些$x$求最大的$x$</p>
<blockquote>
<p>本文针对给定的$d$讨论具体的方程解法</p>
</blockquote>
<h1 id="读懂本文你可能需要的前置知识"><a href="#读懂本文你可能需要的前置知识" class="headerlink" title="读懂本文你可能需要的前置知识"></a>读懂本文你可能需要的前置知识</h1><p>抽屉原理</p>
<p>二元一次方程</p>
<p>绝对值</p>
<p>有理数&#x2F;无理数</p>
<p>模运算</p>
<p>矩阵运算</p>
<p>数列&#x2F;递推数列</p>
<p>二项式展开</p>
<p>反证法</p>
<p>归纳法</p>
<p>不等式(缩放,三角不等式)</p>
<p>共轭实数(不太知道怎么翻译比较好,还是对偶实数？ 描述的就是$a+b\sqrt{m}$与$a-b\sqrt{m}$</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p><img data-src="/Blog/img/20201205pe066.png" alt="2020 12 05 pe 066"></p>
<h2 id="pell方程的解"><a href="#pell方程的解" class="headerlink" title="pell方程的解"></a>pell方程的解</h2><h3 id="解的存在性证明"><a href="#解的存在性证明" class="headerlink" title="解的存在性证明"></a>解的存在性证明</h3><h4 id="对于给定-d-存在无穷多对整数-x-y-满足-x-y-sqrt-d"><a href="#对于给定-d-存在无穷多对整数-x-y-满足-x-y-sqrt-d" class="headerlink" title="对于给定$d$,存在无穷多对整数$(x,y)$满足 $|x-y\sqrt{d}|&lt;\frac 1y$"></a>对于给定$d$,存在无穷多对整数$(x,y)$满足 $|x-y\sqrt{d}|&lt;\frac 1y$</h4><p>取任意正整数$q_0 &gt; 1$</p>
<p>把区间$[0,1)$均分为$q_0$个左闭右开的区间,则每部分长度为$\frac 1{q_0}$, 考虑 $t \sqrt{d}$的小数部分($t &#x3D; 0,\cdots,q_0$ 共计$q_0+1$个),抽屉原理,必定有两个落在同一区间, 即存在$0\leq i &lt; j\leq q_0$使得 $| \{i \sqrt{d}\} - \{j \sqrt{d}\} | &lt;\frac 1{q_0}$</p>
<p>即$|x-(j-i)\sqrt{d}| &#x3D;  | \{i \sqrt{d}\} - \{ j \sqrt{d}\} | &lt; \frac 1{q_0} \leq  \frac 1{j - i}$, 其中$x$用于去掉整数部分</p>
<blockquote>
<p>这里要注意的是知道$i &lt; j$,和它们的小数部分落在同一个区间,所以这里应该是它们的小数部分相减的绝对值,而不是相减的绝对值的小数部分,例如q取2, 一个取0.4,一个1.3,它们都在[0,0.5)的区间里,但是如果$|1.3-0.4|$ 再取绝对值的小数部分,得到的是0.9而不是0.1,对于x来说,只要增减1就能在最终的值上切换成功.</p>
</blockquote>
<p>得到一个解$(x,y&#x3D;j-i)$</p>
<p>取$\frac 1{q_1} &lt; |x-(j-i)\sqrt{d}|$</p>
<p>如下这样, 相同的$(x,y)$一定是等于关系, 因此如下这样可以产生无限多的解</p>
<p>$|x_3-y_3\sqrt{d}| &lt;\frac 1{q_3} &lt; |x_2-y_2 \sqrt{d}| &lt; \frac 1{q_2} &lt; |x_1-y_1\sqrt{d}| &lt;\frac 1{q_1} &lt; |x_0-y_0 \sqrt{d}| &lt; \frac 1{q_0} &lt; 1$</p>
<h4 id="反复使用抽屉原理-证明存在性-并配出一个解"><a href="#反复使用抽屉原理-证明存在性-并配出一个解" class="headerlink" title="反复使用抽屉原理, 证明存在性, 并配出一个解"></a>反复使用抽屉原理, 证明存在性, 并配出一个解</h4><p>对于上一个结论中的无限多个解</p>
<p>$0 &lt; \left|x^2-dy^2\right| $</p>
<p>$&#x3D;\left|x+y\sqrt{d}\right|\cdot\left|x-y\sqrt{d}\right|$</p>
<p>$&#x3D;\left|x-y\sqrt{d}+2y\sqrt{d}\right|\cdot\left|x-y\sqrt{d}\right| $</p>
<p>$\le (\left|x-y\sqrt{d}\right|+\left|2y\sqrt{d}\right|)\cdot\left|x-y\sqrt{d}\right| $ </p>
<p>$&lt; \left(2y\sqrt{d}+\frac{1}{y}\right)\cdot\frac{1}{y}$</p>
<p>$\le 2\sqrt{d}+\frac 1{y^2} $</p>
<p>$\le 2 \sqrt{d} + 1 $</p>
<p>说明这无限多个$(x,y)$的取值,对$|x^2-dy^2|$的计算结果是有限范围内的整数</p>
<blockquote>
<p>如果你看下面我提供的youtube链接,你会发现证明的细节步骤会有些差别,视频里,并没有这么精细的放缩,因为最终目的只需要证明有限个取值,而在中间直接放缩到 $\le |3y\sqrt{d}|$</p>
</blockquote>
<p>抽屉原理,存在正整数$k$, 使得$|x^2-dy^2|&#x3D;k$ 的 解有无限个</p>
<p>考虑这些解$(x \bmod k,y \bmod k)$ , 结果的方案数$\leq k^2$,也是有限的,</p>
<p>抽屉原理,存在$(M_x,M_y)$,有无限个$i$ 满足 $(x_i \bmod k, y_i \bmod k) &#x3D; (M_x,M_y)$,在这无限组中取两组$(x_1,y_1),(x_2,y_2)$</p>
<p>令 $X&#x3D;|\frac{x_1x_2-y_1y_2d}{k}|,Y&#x3D;|\frac{x_2y_1-x_1y_2}{k}|$</p>
<p>有 $X^2-d \cdot Y^2 &#x3D; \frac{(x_1^2-d \cdot y_1^2)(x_2^2-d \cdot y_2^2)}{k^2} &#x3D; 1$</p>
<p>因为 $(x_2y_1-x_1y_2)\bmod k &#x3D; (x_1y_1-x_1y_1) \bmod k &#x3D; 0 \bmod k &#x3D; 0$,所以$Y$是非负整数</p>
<p>注意到 $x^2-dy^2$ 的取值范围为 $\pm k$ (2个,有限个),但可取的$(x,y)$有无限对,抽屉原理,因此存在$(x_i,y_i)\neq(x_j,y_j)$使得 $x_i^2-dy_i^2&#x3D;x_j^2-dy_j^2$ 这时 $\frac{x_i}{y_i} \neq \frac{x_j}{y_j}$ (否则代入前式子得到$x_i&#x3D;x_j$), 即$Y$为非$0$正整数</p>
<p>因为$X$是有理数且满足pell方程,所以它是整数, 且$X &#x3D; \sqrt{1+dY^2} \neq 0$</p>
<p>综上, 一定存在解</p>
<blockquote>
<p>注,上面X,Y的等式看着很突兀,但在看了Youtube视频之后意识到了, 既然 基础解的幂次能有效,且证明了负幂次也有效,那么 $ x^2-dy^2 &#x3D; 1 &#x3D; k&#x2F;k &#x3D; \frac{x_1^2-dy_1^2}{x_2^2-dy_2^2}$ 然后通分化简就有了上面那个显得突兀的<code>令</code></p>
</blockquote>
<h3 id="解的性质-基础解"><a href="#解的性质-基础解" class="headerlink" title="解的性质(基础解)"></a>解的性质(基础解)</h3><p>如果解存在 $x,y \ge 0$</p>
<h4 id="任意两个解能生成新的解"><a href="#任意两个解能生成新的解" class="headerlink" title="任意两个解能生成新的解"></a>任意两个解能生成新的解</h4><p>若$(x_0,y_0),(x_1,y_1)$ 是 $x^2-d y^2&#x3D;1$ 的解</p>
<p>$1 &#x3D; (x_0^2-d y_0^2)(x_1^2-d y_1^2)$</p>
<p>$&#x3D; (x_0 + \sqrt{d} y_0)(x_0 - \sqrt{d} y_0)(x_1 + \sqrt{d} y_1)(x_1 - \sqrt{d} y_1)$</p>
<p>$&#x3D; (x_0 + \sqrt{d} y_0)(x_1 + \sqrt{d} y_1)(x_0 - \sqrt{d} y_0)(x_1 - \sqrt{d} y_1)$</p>
<p>$&#x3D; (x_0x_1 + dy_0 y_1 + \sqrt{d} (y_0x_1+y_1 x_0))(x_0x_1 + dy_0 y_1 - \sqrt{d} (y_0x_1+y_1x_0))$</p>
<p>$&#x3D; (x_0x_1 + dy_0 y_1)^2 - d(y_0x_1+y_1 x_0)^2$</p>
<p>那么$(x_0x_1 + dy_0y_1, y_0x_1+y_1x_0)$也是一个解</p>
<p>如果定义 $A(x,y) &#x3D; x+\sqrt{d}y,x &gt; 0,y &gt; 0$ 为一个解, 那么有 $A(x_0x_1 + dy_0 y_1,y_0x_1+y_1 x_0) &#x3D; A(x_0,y_0)\cdot A(x_1,y_1)$</p>
<h4 id="存在一个基础解-最小解-所有解都是由基础解生成的"><a href="#存在一个基础解-最小解-所有解都是由基础解生成的" class="headerlink" title="存在一个基础解(最小解),所有解都是由基础解生成的"></a>存在一个基础解(最小解),所有解都是由基础解生成的</h4><p><strong>下面证明所有解都是最小解生成的</strong></p>
<p>反证法, 因为$y$越大$x$越大, 设$(x_1,y_1)$为最小解, $(x_k,y_k)$不是由最小解,通过上述乘积的幂次方法生成的一个解</p>
<p>根据$y$越大$x$越大的性质,存在一个整数$n$</p>
<p>$(x_1+y_1 \sqrt{d})^n &lt; (x_k+y_k \sqrt{d}) &lt; (x_1+y_1 \sqrt{d})^{n+1} $, 同时乘$(x_1-y_1 \sqrt{d})^n$有</p>
<p>$1 &lt; (x_k+y_k \sqrt{d}) (x_1-y_1 \sqrt{d})^n &lt; (x_1+y_1 \sqrt{d}) $</p>
<p>注意到中间的表达式 也是一个解(且因为 它 大于1, 所以它的共轭 在0到1之间, 而它和它的共轭 只有 y的符号不同, 所以它的x和y的符号均为正)</p>
<p>这与最小解定义矛盾,所以所有解都是最小解生成的</p>
<h4 id="pell方程性质小结"><a href="#pell方程性质小结" class="headerlink" title="pell方程性质小结"></a>pell方程性质小结</h4><p>关于pell方程的解 ,现在有了两个结论</p>
<ol>
<li>一定存在解</li>
<li>有最小的基础解, 所有解都是由它的幂次得到的, $(1,0)$ 正好看作它的$0$次方的结果</li>
</ol>
<p>下面开始看看连分数。</p>
<h2 id="连分数"><a href="#连分数" class="headerlink" title="连分数"></a>连分数</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>形如</p>
<p>$\alpha &#x3D; a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \cfrac{1}{\ddots,}}}} $</p>
<p>例如 </p>
<p>$ \sqrt{2} &#x3D; 1 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \ddots}}}}}} $</p>
<p>展开的剩余部分是在<code>[0,1)</code>之间</p>
<h3 id="所有无限连分数都是无理数"><a href="#所有无限连分数都是无理数" class="headerlink" title="所有无限连分数都是无理数"></a>所有无限连分数都是无理数</h3><p>证明：如果一个数是有理数,把它写成分数的形式,再按照连分数的方式展开,你会发现这过程就是辗转相除,分子分母单调递减 所以一定有限,它的逆否命题就是要证明的性质</p>
<h3 id="渐进分数-分子-分母等性质"><a href="#渐进分数-分子-分母等性质" class="headerlink" title="渐进分数(分子,分母等性质)"></a>渐进分数(分子,分母等性质)</h3><h4 id="分子-h-n-分母-k-n"><a href="#分子-h-n-分母-k-n" class="headerlink" title="分子$h_n$分母$k_n$"></a>分子$h_n$分母$k_n$</h4><h5 id="递推式"><a href="#递推式" class="headerlink" title="递推式"></a>递推式</h5><p>渐进分数,把上述表示无理数$\alpha$的连分数部分截断所得到的分数</p>
<p>若$h,k$分别为渐进分数的分子和分母,根据简化为分数的过程</p>
<p>$\begin{bmatrix} h_n &amp; k_n \end{bmatrix} &#x3D; \begin{bmatrix} 1 &amp; 0 \end{bmatrix} \cdot \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdots \begin{bmatrix} a_0 &amp; 1 \\ 1 &amp; 0 \end{bmatrix} $</p>
<p>然而这不好建立递推关系,稍做变形</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ ? &amp; ? \end{bmatrix} &#x3D; \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix} \cdot \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdots \begin{bmatrix} a_0 &amp; 1 \\ 1 &amp; 0 \end{bmatrix} $</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ ? &amp; ? \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdots \begin{bmatrix} a_0 &amp; 1 \\ 1 &amp; 0 \end{bmatrix} $</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ ? &amp; ? \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} &amp; k_{n-1} \\ ? &amp; ? \end{bmatrix} $</p>
<p>左式的底部可以确定</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ h_{n-1} &amp; k_{n-1} \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} &amp; k_{n-1} \\ ? &amp; ? \end{bmatrix} $</p>
<p>又因为递推关系,右边式子相当于左式带入n-1</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ h_{n-1} &amp; k_{n-1} \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} &amp; k_{n-1} \\ h_{n-2} &amp; k_{n-2} \end{bmatrix} $</p>
<p>综上</p>
<p>$h_n &#x3D; a_n \cdot h_{n-1} + h_{n-2}$<br>$k_n &#x3D; a_n \cdot k_{n-1} + k_{n-2}$</p>
<p>渐进值 $\frac{h_n}{k_n} &#x3D; \frac{a_n \cdot h_{n-1} + h_{n-2}}{a_n \cdot k_{n-1} + k_{n-2}}$</p>
<p>且根据计算过程,可知 $h_n,k_n$互质</p>
<h5 id="等式"><a href="#等式" class="headerlink" title="等式"></a>等式</h5><p>由上面的递推关系再递推有</p>
<p>$k_nh_{n-1}-k_{n-1}h_n&#x3D;-(k_{n-1}h_{n-2}-k_{n-2}h_{n-1})&#x3D;(-1)^n $, </p>
<p>$k_nh_{n-2}-k_{n-2}h_n&#x3D;a_n(k_{n-1}h_{n-2}-k_{n-2}h_{n-1})&#x3D;a_n(-1)^{n-1} $, </p>
<p>设无理数$\alpha$ 的精确表示为$[a_0,a_1,\cdots,a_n,x_{n+1}]$,即是最后$a_{n+1}$替换为<strong>精确的</strong>非整数值$x_{n+1}$,有$1\leq a_{n+1}&lt;x_{n+1}&lt;a_{n+1}+1,(n&gt;&#x3D;1)$</p>
<h4 id="与原无理数的距离-alpha-frac-h-n-k-n"><a href="#与原无理数的距离-alpha-frac-h-n-k-n" class="headerlink" title="与原无理数的距离 $\alpha - \frac{h_n}{k_n}$"></a>与原无理数的距离 $\alpha - \frac{h_n}{k_n}$</h4><h5 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h5><p>根据上方计算渐进值得到的公式,同理递推式有</p>
<p>$\alpha &#x3D;\frac{x_{n+1}h_n+h_{n-1}}{x_{n+1}k_n+k_{n-1}}  $</p>
<p>$\alpha - \frac{h_n}{k_n} &#x3D;\frac{x_{n+1}h_n+h_{n-1}}{x_{n+1}k_n+k_{n-1}} -\frac{h_n}{k_n} $</p>
<p>$&#x3D;\frac{h_{n-1}k_{n}-h_nk_{n-1}}{k_n(x_{n+1}k_n+k_{n-1})}$</p>
<p>$&#x3D;\frac{(-1)^n}{k_n(x_{n+1}k_n+k_{n-1})}$</p>
<p>$|\alpha -\frac{h_n}{k_n}| &#x3D;\frac{1}{k_n(x_{n+1}k_n+k_{n-1})} &lt; \frac{1}{k_n(a_{n+1}k_n+k_{n-1})} &#x3D; \frac{1}{k_nk_{n+1}}$</p>
<p>注意到$k_n$的递推式,容易发现它是单调递增的正整数,所以渐进分数真的是趋近($n$趋于无限大, 渐进分数与原无理数距离趋近于0)</p>
<h5 id="单调递减"><a href="#单调递减" class="headerlink" title="单调递减"></a>单调递减</h5><p>$|k_n\alpha - h_n|$单调递减</p>
<p>证明:</p>
<p>$|k_n\alpha - h_n| - |k_{n-1}\alpha - h_{n-1}|$</p>
<p>$ &#x3D; |k_n(\alpha - \frac{h_n}{k_n})| - |k_{n-1}(\alpha - \frac{h_{n-1}}{k_{n-1}})|$</p>
<p>$ &#x3D; \frac 1{x_{n+1}k_n+k_{n-1}} - \frac 1{x_{n}k_{n-1}+k_{n-2}} $</p>
<p>$ &#x3D; \frac {(x_{n}k_{n-1}+k_{n-2})-(x_{n+1}k_n+k_{n-1})}{(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {((a_n+\frac 1{x_{n+1}})k_{n-1}+k_{n-2})-(x_{n+1}k_n+k_{n-1})}{(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {(x_{n+1}(a_nk_{n-1}+k_{n-2})+k_{n-1})-x_{n+1}(x_{n+1}k_n+k_{n-1})}{x_{n+1}(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {(x_{n+1}k_n+k_{n-1})-x_{n+1}(x_{n+1}k_n+k_{n-1})}{x_{n+1}(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {(1-x_{n+1})(x_{n+1}k_n+k_{n-1})}{x_{n+1}(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})} &lt; 0$</p>
<hr>
<p>由此也可知和原无理数的距离$|\alpha - \frac{h_n}{k_n}|$单调递减</p>
<p>$|\alpha - \frac{h_n}{k_n}|-|\alpha -\frac{h_{n-1}}{k_{n-1}}|$</p>
<p>$&#x3D;\frac {|{k_n}\alpha-{h_n}|-\frac {k_n}{k_{n-1}}|{k_{n-1}}\alpha-{h_{n-1}}|}{k_n}$ (因为$k_n$单调递增</p>
<p>$&lt;\frac {|{k_n}\alpha-{h_n}|-|{k_{n-1}}\alpha-{h_{n-1}}|}{k_n} &lt; 0$</p>
<h4 id="最优接近-alpha-frac-h-k-与-k-alpha-h"><a href="#最优接近-alpha-frac-h-k-与-k-alpha-h" class="headerlink" title="最优接近 $|\alpha - \frac{h}{k}|$与$|k\alpha - h|$"></a>最优接近 $|\alpha - \frac{h}{k}|$与$|k\alpha - h|$</h4><p><a target="_blank" rel="noopener" href="https://proofwiki.org/wiki/Convergents_are_Best_Approximations">https://proofwiki.org/wiki/Convergents_are_Best_Approximations</a></p>
<h5 id="和渐进数同分母的所有分数中-渐进数最接近原无理数"><a href="#和渐进数同分母的所有分数中-渐进数最接近原无理数" class="headerlink" title="和渐进数同分母的所有分数中,渐进数最接近原无理数"></a>和渐进数同分母的所有分数中,渐进数最接近原无理数</h5><p>若$(h_n,k_n)$是一个渐进分数,则对于分母$k_n$,分子取$h_n$时,整个分数最接近原无理数</p>
<p>取任意$h\neq h_n$,根据三角不等式</p>
<p>$|\alpha -\frac{h}{k_n}| \geq |\frac{h-h_n}{k_n}| - |\alpha - \frac{h_n}{k_n}|$</p>
<p>$&gt;\frac 1{k_n} - \frac 1{k_nk_{n+1}} $,因为n足够大 $k_{n+1}&gt;&#x3D;3$有</p>
<p>$&gt; \frac 1{k_n} - \frac 1{2k_n} $</p>
<p>$&#x3D;\frac 1{2k_n} $</p>
<p>$&gt;  \frac 1{k_nk_{n+1}} &gt; |\alpha -\frac{h_n}{k_n}|$</p>
<p>证明了$h_n$是最接近的分子</p>
<p>即 $|k_n\alpha - h|$在 $h&#x3D;h_n$时取最小值</p>
<h5 id="0-k-le-k-n-的所有分数-frac-h-k-中-渐进数-frac-h-n-k-n-能使-k-alpha-h-为最小值-h-n-1-k-n-1-使它为次小值"><a href="#0-k-le-k-n-的所有分数-frac-h-k-中-渐进数-frac-h-n-k-n-能使-k-alpha-h-为最小值-h-n-1-k-n-1-使它为次小值" class="headerlink" title="$0 &lt; k \le k_n$的所有分数$\frac{h}{k}$中, 渐进数$\frac{h_n}{k_n}$能使$|k\alpha - h|$为最小值, $(h_{n-1},k_{n-1})$ 使它为次小值"></a>$0 &lt; k \le k_n$的所有分数$\frac{h}{k}$中, 渐进数$\frac{h_n}{k_n}$能使$|k\alpha - h|$为最小值, $(h_{n-1},k_{n-1})$ 使它为次小值</h5><p>考虑任意$(h,k),(0 &lt; k &lt; k_n)$,且$\frac hk$的为最简分数, 且不是渐进数</p>
<blockquote>
<p>若它不是最简分数, 则它是它最简分数的t倍, 比它最简分数得到的值更大</p>
</blockquote>
<blockquote>
<p>因为已经证明了渐进数随着$n$增大, $|k_n\alpha - h_n|$单调递减,且渐进数分子分母互质,所以如果是渐进数则对应渐进数的该表达式 更大</p>
</blockquote>
<p>设二元一次方程组</p>
<p>$h_nx+h_{n-1}y&#x3D;h$</p>
<p>$k_nx+k_{n-1}y&#x3D;k$</p>
<p>则有$(x,y)&#x3D;(\frac {hk_{n-1}-kh_{n-1}}{h_nk_{n-1}-h_{n-1}k_n},\frac {hk_{n}-kh_{n}}{h_nk_{n-1}-h_{n-1}k_n}) &#x3D; ((-1)^{n-1}(hk_{n-1}-kh_{n-1}),(-1)^{n-1}(hk_{n}-kh_{n}))$</p>
<p>因为$\frac hk$不是渐进分数,所以$x,y$都是非零整数,又因为$k &lt; k_n$和$k_nx+k_{n-1}y&#x3D;k$有:$x,y$异号</p>
<p>因为$\alpha - \frac {h_n}{k_n} &#x3D;\frac{(-1)^n}{k_n(x_{n+1}k_n+k_{n-1})}$的分子为$(-1)^n$,分母为正数,</p>
<p>所以$\alpha - \frac {h_n}{k_n}$和$\alpha - \frac {h_{n-1}}{k_{n-1}}$异号</p>
<p>即$k_n\alpha - {h_n}$和$k_{n-1}\alpha - {h_{n-1}}$异号</p>
<p>有$x(k_n\alpha - {h_n})$和$y(k_{n-1}\alpha - {h_{n-1}})$同号</p>
<p>$|k\alpha -h| &#x3D; |(k_nx+k_{n-1}y)\alpha - (h_nx+h_{n-1}y)|$</p>
<p>$&#x3D; |x(k_n\alpha - {h_n}) + y(k_{n-1}\alpha - {h_{n-1}})|$,因为同号</p>
<p>$&#x3D; |x(k_n\alpha - {h_n})|+|y(k_{n-1}\alpha - {h_{n-1}})|$,因为$x,y$非零整数:</p>
<p>$|k\alpha - h| &gt; |k_n\alpha - {h_n}|$且$|k\alpha -h|&gt;|k_{n-1}\alpha - {h_{n-1}}|$, 得证</p>
<h4 id="alpha-frac-hk"><a href="#alpha-frac-hk" class="headerlink" title="$|\alpha - \frac hk|&lt;\frac 1{2k^2}$(pell方程必要的不等式, 渐进数判定不等式)"></a>$|\alpha - \frac hk|&lt;\frac 1{2k^2}$(pell方程必要的不等式, 渐进数判定不等式)</h4><p><a target="_blank" rel="noopener" href="https://proofwiki.org/wiki/Condition_for_Rational_to_be_a_Convergent">https://proofwiki.org/wiki/Condition_for_Rational_to_be_a_Convergent</a></p>
<h5 id="连续的两个渐进数中至少有一个满足该不等式"><a href="#连续的两个渐进数中至少有一个满足该不等式" class="headerlink" title="连续的两个渐进数中至少有一个满足该不等式"></a>连续的两个渐进数中至少有一个满足该不等式</h5><p>反证法, 证明:</p>
<p>假设都不满足,有</p>
<p>$0 \leq |\alpha-\frac{h_{n+1}}{k_{n+1}}| - \frac{1}{2k_{n+1}^2} + |\alpha-\frac{h_{n}}{k_{n}}|-\frac{1}{2k_{n}^2}$, 因为$\alpha - \frac{h_{n}}{k_{n}} &#x3D;\frac{(-1)^n}{k_n(x_{n+1}k_n+k_{n-1})}$正负交替,所以</p>
<p>$ &#x3D; |\frac{h_{n+1}}{k_{n+1}}-\frac{h_{n}}{k_{n}}|-\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; |\frac{h_{n+1}k_{n}-h_{n}k_{n+1}}{k_{n+1}k_{n}}|-\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; \frac 1{k_nk_{n+1}} -\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; \frac {-(k_n-k_{n+1})^2}{2k_{n}^2k_{n+1}^2} &lt; 0$</p>
<p>矛盾, 因此至少有一个满足, 得证</p>
<h5 id="任何最简分数如果满足该不等式-那么它是一个渐进分数"><a href="#任何最简分数如果满足该不等式-那么它是一个渐进分数" class="headerlink" title="任何最简分数如果满足该不等式,那么它是一个渐进分数"></a>任何最简分数如果满足该不等式,那么它是一个渐进分数</h5><p>证明</p>
<p>设$\frac hk$满足不等式$|\alpha - \frac hk|&lt;\frac 1{2k^2}$,则存在$n$使得渐进数分母满足 $k_{n+1} &gt; k \ge k_n $, 若$\frac hk \neq \frac{h_n}{k_n}$,即$k_n &lt; k$</p>
<p>$0 \leq \frac{|hk_n-h_nk|-1}{kk_n}$</p>
<p>$&#x3D; |\frac{h}{k}-\frac{h_n}{k_n}|-\frac{1}{kk_n}$,因为三角不等式,有</p>
<p>$\leq |\alpha -\frac{h}{k}|+|\alpha -\frac{h_n}{k_n}|-\frac{1}{kk_n}$, 因为假设满足的不等式</p>
<p>$&lt; \frac 1{2k^2} + \frac 1{k_n}|k_n\alpha - h_n|-\frac{1}{kk_n}$,因为上面的最优接近, 所有$&lt; k_{n+1}$ 的分母中 都大于 $(h_n,k_n)$的方案</p>
<p>$&lt; \frac 1{2k^2} + \frac 1{k_n}|k\alpha - h|-\frac{1}{kk_n}$</p>
<p>$&#x3D; \frac 1{2k^2} + \frac {k}{k_n}|\alpha - \frac hk|-\frac{1}{kk_n}$因为假设满足的不等式</p>
<p>$&lt; \frac 1{2k^2} + \frac {k}{k_n}\cdot \frac 1{2k^2}-\frac{1}{kk_n}$</p>
<p>$&#x3D; \frac {k_n-k}{2k^2k_n} &lt; 0$</p>
<p>矛盾,因此$\frac hk$和某个渐进数相等</p>
<blockquote>
<p>注记：最开始该文的版本,的渐进分数的部分直接使用的是pell方程中$\sqrt{d}$,其中$d$是非平方正整数,但为了写project euler 100需要的证明,需要把它扩充到实数（当然也是成立的）,所以这部分改写了一次</p>
</blockquote>
<h3 id="Lagrange’s-Theorem-二次无理数与有循环节的连分数"><a href="#Lagrange’s-Theorem-二次无理数与有循环节的连分数" class="headerlink" title="Lagrange’s Theorem 二次无理数与有循环节的连分数"></a>Lagrange’s Theorem 二次无理数与有循环节的连分数</h3><p>quadratic irrational(二次无理数) 定义: 二次整式多项式的根 $\frac{-b\pm \sqrt{b^2-4ac}}{2a}$ 或者形如$\frac{P+\sqrt{D}}{Q}$</p>
<p>一个无理数是二次无理数, 当且仅当它的连分数是循环连分数: An irrational number is quadratic irrational if and only if its continued fraction is periodic.</p>
<h4 id="循环连分数一定是二次无理数"><a href="#循环连分数一定是二次无理数" class="headerlink" title="循环连分数一定是二次无理数"></a>循环连分数一定是二次无理数</h4><p>按照连分数的写法,令循环节的值为$t$</p>
<p>还原为分数,有$x&#x3D;\frac{a t + b}{c t +d},t &#x3D; \frac{et+f}{gt+h}$ 变换左表达式用$x$表示$t$,带入右侧表达式得到$\frac{ix+j}{kx+l} &#x3D; \frac{mx+n}{ox+p}$,其中字母$a \to p$均为整数,且注意到$x$为无理数, 所以化简后一定是二次方程</p>
<h4 id="二次无理数一定是循环连分数"><a href="#二次无理数一定是循环连分数" class="headerlink" title="二次无理数一定是循环连分数"></a>二次无理数一定是循环连分数</h4><p>定义,对于无理数x</p>
<p>$f(x) &#x3D; x-1 (x&gt;1)$</p>
<p>$f(x) &#x3D; \frac{1}{\frac{1}{x}-1} , (x&lt;1)$</p>
<p>对应到连分数展开$[a_0,a_1,a_2,\cdots]$,即是将首个数字减少$1$,($x&gt;1$时就是$a_0$减去$1$,$x&lt;1$时就是$a_1$减去$1$)</p>
<p>令$x_1&#x3D;x,x_{n+1}&#x3D;f(x_n)$,可以知道 这是一个无限数列</p>
<p>如果$x$满足$ax^2+bx+c&#x3D;0$,写作$x \in g(a,b,c)$</p>
<p>那么$x-1$ 满足$a(x-1)^2+(2a+b)(x-1)+(a+b+c) &#x3D; ax^2+bx+c&#x3D;0$, 即$x-1 \in g(a,2a+b,a+b+c)$</p>
<p>那么$\frac{1}{\frac{1}{x}-1} &#x3D; \frac{x}{1-x}$ 满足$(a+b+c)(\frac{x}{1-x})^2+(b+2c)\frac{x}{1-x}+c &#x3D; \frac{ax^2+bx+c}{(1-x)^2} &#x3D; 0$, 即$\frac{1}{\frac{1}{x}-1} \in g(a+b+c,b+2c,c)$</p>
<p>所以$f(x)$满足 $f(x)\in g(a,2a+b,a+b+c)$ 或 $f(x)\in g(a+b+c,b+2c,c)$</p>
<p>不失一般性,写作$x_n \in g(s_n,t_n,u_n)$,有 $s_n &gt; 0$, 否则把三元组同时换号</p>
<p>注意到上式 $(2a+b)^2-4a(a+b+c)&#x3D;b^2-4ac&#x3D;(b+2c)^2-4(a+b+c)c$</p>
<p>说明了 $t_n^2-4s_nu_n$是和$n$无关的值</p>
<p>反证法: 如果只有有限个$u&lt;0$,那么从某一处开始,$s&gt;0,u&gt;0$且$t&lt;0$(因为 $x &gt; 0$)</p>
<p>那么意味着 $t$ 严格单调递增,(因为$t$的变化关系是$t&#x3D;2s+t$或$t&#x3D;t+2u$),整数是离散的,矛盾</p>
<p>所以有无限个$u_n&lt;0$, 即无限多$s_n u_n &lt; 0$</p>
<p>注意到 $t_n^2-4s_nu_n$是常数,抽屉原理, 至少有一个三元组$[s_n,t_n,u_n]$ 出现了三次以上,一个二次方程有两个解,所以有满足的$x_n&#x3D;x_m,m&gt;n$</p>
<p>得证 连分数展开有循环</p>
<p>Theorem 1. If x is a positive quadratic irrational then its continued fraction is eventually periodic.</p>
<h3 id="Galois’-Theorem-纯循环连分数与reduced二次无理数"><a href="#Galois’-Theorem-纯循环连分数与reduced二次无理数" class="headerlink" title="Galois’ Theorem 纯循环连分数与reduced二次无理数"></a>Galois’ Theorem 纯循环连分数与reduced二次无理数</h3><p><a target="_blank" rel="noopener" href="https://proofwiki.org/wiki/Definition:Quadratic_Irrational/Reduced">https://proofwiki.org/wiki/Definition:Quadratic_Irrational/Reduced</a></p>
<p>Definition 1.24. $x$ 是二次方程的一个根,$\overline{x}$ 是另一个根,那么如果 $x &gt; 1$ 且 $-1 &lt; \overline{x} &lt; 0$.那么称 x 为 reduced</p>
<p>Theorem 1.25. (Galois’ Theorem) 无理数a. a是纯循环连分数（从$a_0$开始的循环节）,当且仅当 x is reduced. If $x &#x3D; [\overline{a_0, a_1, a_2, . . . , a_{l−1}}]$ and $\overline{x}$ 是它共轭实数, then $-\frac{1}{x} &#x3D; [\overline{a_{l−1}, . . . , a_2, a_1}].$</p>
<h4 id="reduced二次无理数-是-纯循环连分数"><a href="#reduced二次无理数-是-纯循环连分数" class="headerlink" title="reduced二次无理数 是 纯循环连分数"></a>reduced二次无理数 是 纯循环连分数</h4><p>设reduced二次无理数$x$的一个渐进分数为$[a_0,a_1,\cdots,a_n], x&gt;1,-1&lt;\overline{x}&lt;0$</p>
<p>那么有 $x_{n+1}&#x3D;\frac{1}{x_n-a_n}$ 表示 按照展开从n处向后取值</p>
<p>$\overline{x_{n+1}} &#x3D; \frac{1}{\overline{x_n-a_n}} &#x3D; \frac{1}{\overline{x_n}-a_n}$,(因为 两个形如$A+B\sqrt{C}$的无理数相乘为有理数,说明相乘后的无理数的系数为0,所以更改其中一个无理数的系数的正负,另一个无理数系数的正负更改即可)</p>
<p>注意到$x \ge 1$有$a_0 \ge 1$,所以 $a_n \ge 1$</p>
<p>下面归纳证明 $-1 &lt; \overline{x_n} &lt; 0 $</p>
<p>若 $-1 &lt; \overline{x_n} &lt; 0$</p>
<p>有 $\frac{1}{\overline{x_{n+1}}} &#x3D; \overline{x_n} - a_n &lt; -1$</p>
<p>即 $-1 &lt; \overline{x_{n+1}} &lt; 0$,得证</p>
<hr>
<p>$-1 &lt; \overline{x_n} &#x3D; \frac{1}{\overline{x_{n+1}}}+a_n &lt; 0$</p>
<p>$ 1 &gt; -\frac{1}{\overline{x_{n+1}}}-a_n &gt; 0$</p>
<p>$ a_n &#x3D; [ -\frac{1}{\overline{x_{n+1}}} ] $ ($a_n$等于分式的整数部分)</p>
<p>因为上面已经证明 如果是二次无理数,那么必定有循环节,所以存在$x_i &#x3D; x_j,(i &lt; j )$</p>
<p>即$\overline{x_i}&#x3D;\overline{x_j}$</p>
<p>即$a_{i-1}&#x3D;[-\frac{1}{\overline{x_i}}]&#x3D;[-\frac{1}{\overline{x_j}}] &#x3D; a_{j-1}$</p>
<p>即$x_{i-1}&#x3D;a_{i-1}+\frac{1}{x_i} &#x3D; a_{j-1}+\frac{1}{x_j} &#x3D; x_{j-1}$, 意义就是如果两个后缀相等,那么它们各向前一个 也相等,综上逐步迭代$a_0 &#x3D;a_{j-i}$ </p>
<p>因此证明了 如果一个二次无理数是 reduced,那么它是个纯循环连分数</p>
<h4 id="纯循环连分数-是-reduced二次无理数"><a href="#纯循环连分数-是-reduced二次无理数" class="headerlink" title="纯循环连分数 是 reduced二次无理数"></a>纯循环连分数 是 reduced二次无理数</h4><p>首先有循环节的连分数一定是二次无理数（上面证过了)</p>
<p>因为是纯循环,所以$a_0 \ge 1$,所以$a_n \ge 1$,有$x &gt; 1$</p>
<p>假设周期为$n$, 有 $x_n &#x3D; x &#x3D; [\overline{a_0,a_1,\cdots,a_{n-1}}]$</p>
<p>根据上面推过的递推式 $x &#x3D; \frac{x_nh_{n-1}+h_{n-2}}{x_nk_{n-1}+k_{n-2}} &#x3D; \frac{xh_{n-1}+h_{n-2}}{xk_{n-1}+k_{n-2}}$</p>
<p>化简 $k_{n-1}x^2+(k_{n-2}-h_{n-1})x-h_{n-2}&#x3D;0$</p>
<p>下面证明这个方程除了$x$ (已经有 $x&gt;1$了)的另一个根$\overline{x}$满足$-1 &lt; \overline{x} &lt; 0$</p>
<p>连续函数零点存在性定理</p>
<p>$x &#x3D; 0$时 原式子 $&#x3D;-h_{n-2} &lt; 0$</p>
<p>$x &#x3D; 1$时 原式子 </p>
<p>$&#x3D; k_{n-1}+(h_{n-1}-k_{n-2})-h_{n-2}$</p>
<p>$&#x3D; (a_{n-1}k_{n-2}+k_{n-3}) + (a_{n-1}h_{n-2}+h_{n-3}) -k_{n-2}-h_{n-2}$</p>
<p>$&#x3D; (a_{n-1}-1)(h_{n-2}+k_{n-2}) + (h_{n-3}+k_{n-3}) $</p>
<p>$ &gt; 0 $</p>
<p>说明了另一个根$-1 &lt; \overline{x} &lt; 0$</p>
<p>至此证明了 reduced 和 纯循环之间的 充要</p>
<h4 id="reduced二次无理数-纯循环连分数的-原无理数与它的共轭相反倒数的连分数数值关系"><a href="#reduced二次无理数-纯循环连分数的-原无理数与它的共轭相反倒数的连分数数值关系" class="headerlink" title="reduced二次无理数 纯循环连分数的 原无理数与它的共轭相反倒数的连分数数值关系"></a>reduced二次无理数 纯循环连分数的 原无理数与它的共轭相反倒数的连分数数值关系</h4><p>若 $x &#x3D; [\overline{a_0, a_1, a_2, . . . , a_{l−1}}]$ 且 $\overline{x}$ 是它共轭实数, 有 $-\frac{1}{\overline{x}} &#x3D; [\overline{a_{l−1}, . . . , a_2, a_1,a_0}].$</p>
<hr>
<p>考虑有限的连分数 $x &#x3D; [a_0,a_1,\cdots,,a_n], y&#x3D;[a_n,a_{n-1},\cdots,a_0] , a_i &gt; 0$</p>
<p>$h_n,k_n$为$x$的分子分母,$h_n’,k_n’$为$y$的分子分母</p>
<p>要证明 $\frac{h_n}{h_{n-1}} &#x3D; \frac{h_n’}{k_n’}$ 且 $\frac{k_n}{k_{n-1}} &#x3D; \frac{h_{n-1}’}{k_{n-1}’}, n \ge 1$ 且分子分母对应相等(因为是最简分数,所以只要证明了分数相等就有对应相等了)</p>
<p>注意到上面 $h_n &#x3D; a_n \cdot h_{n-1} + h_{n-2}$,同时除以 $h_{n-1}$</p>
<p>$\frac{h_n}{h_{n-1}} &#x3D; a_n + \frac{1}{\frac{h_{n-1}}{h_{n-2}}}$</p>
<p>递归展开 可以得到 $\frac{h_n}{h_{n-1}} &#x3D; [a_n,a_{n-1},\cdots,a_0]$,</p>
<p>注意到 $k_n &#x3D; a_n \cdot k_{n-1} + k_{n-2}$,同理 $\frac{k_n}{k_{n-1}} &#x3D; [a_n,a_{n-1},\cdots,a_1] $(注意是$a_1$不是$a_0$)</p>
<p>根据上面的<code>递归展开的结论</code> 和 <code>y的分子分母定义</code> 有</p>
<p>$\frac{h_{n}}{h_{n-1}} &#x3D; [a_{n},a_{n-1},\cdots,a_0] &#x3D; \frac{h_{n}’}{k_{n}’}$</p>
<p>$\frac{k_{n}}{k_{n-1}} &#x3D; [a_{n},a_{n-1},\cdots,a_1] &#x3D; \frac{h_{n-1}’}{k_{n-1}’}$</p>
<p>且分子分母对应相等(因为是最简分数)</p>
<hr>
<p>若$x$是纯循环连分数,则$x$为reduced 二次无理数,则$-\frac{1}{\overline{x}}$为reduced的二次无理数,则$-\frac{1}{\overline{x}}$为纯循环连分数</p>
<p>假设直接取$n+1 &#x3D; $ 两个循环节长度的最小公倍数</p>
<p>$k_{n}x^2+(k_{n-1}-h_{n})x-h_{n-1}&#x3D;0$</p>
<p>令</p>
<p>$y &#x3D; [\overline{a_n,a_{n-1},\cdots,a_0}] &#x3D; [a_n,a_{n-1},\cdots,a_0,y]$</p>
<p>$y &#x3D; \frac{h_n’y+h_{n-1}’}{k_n’y+k_{n-1}’}$</p>
<p>上面证明了对应相等$h_n&#x3D;h_n’,k_{n-1}&#x3D;k_{n-1}’, h_{n-1}&#x3D;k_{n}’,h_{n-1}’&#x3D;k_n$</p>
<p>做对应替换,$y &#x3D; \frac{h_ny+k_{n}}{h_{n-1}y+k_{n-1}}$</p>
<p>展开 $k_{n}{(-\frac{1}{y})}^2+(k_{n-1}-h_{n})(-\frac{1}{y})-h_{n-1}&#x3D;0$</p>
<p>$-\frac{1}{y} &#x3D; \overline{x}$ 得证($y$为正 所以 不可能等于$x$)</p>
<p>至此 Theorem 1.25. (Galois’ Theorem) 无理数a. a是纯循环连分数（从a0开始的循环节）,当且仅当 x is reduced. If $x &#x3D; [\overline{a_0, a_1, a_2, . . . , a_{l−1}}]$ and $\overline{x}$ 是它共轭实数, then $-\frac{1}{\overline{x}} &#x3D; [\overline{a_{l−1}, . . . , a_1, a_0}].$ 得证</p>
<h4 id="sqrt-d-的-连分数-lfloor-sqrt-d-rfloor-overline-a-1-a-2-cdots-a-2-a-1-2-lfloor-sqrt-d-rfloor"><a href="#sqrt-d-的-连分数-lfloor-sqrt-d-rfloor-overline-a-1-a-2-cdots-a-2-a-1-2-lfloor-sqrt-d-rfloor" class="headerlink" title="$\sqrt{d}$ 的 连分数$ &#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,\cdots,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$"></a>$\sqrt{d}$ 的 连分数$ &#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,\cdots,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</h4><p>Theorem 1.26 $d$是非平方数,那么$\sqrt{d} &#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,\cdots,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</p>
<p>也就是 是从第二位开始循环节,且循环节最后一个是它的整部的2倍,且剩余部分是回文</p>
<p>令$x&#x3D;\lfloor \sqrt{d} \rfloor + \sqrt{d}$ 则$\overline{x} &#x3D; \lfloor \sqrt{d} \rfloor - \sqrt{d}$</p>
<p>注意它们的取值范围发现$x$是reduced 二次无理数</p>
<p>因此 $ x &#x3D; \lfloor \sqrt{d} \rfloor + \sqrt{d} &#x3D; [\overline{2\lfloor \sqrt{d} \rfloor,a_1,a_2,\cdots,a_{l-1}}]$</p>
<p>$ &#x3D; [2\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,\cdots,a_{l-1},2\lfloor \sqrt{d} \rfloor}]$</p>
<p>$ \sqrt{d}&#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,\cdots,a_{l-1},2\lfloor \sqrt{d} \rfloor}]$</p>
<p>根据Galois’ Theorem有</p>
<p>$\frac{1}{\sqrt{d}-\lfloor \sqrt{d} \rfloor} &#x3D; -\frac{1}{\overline{x}} &#x3D; [\overline{a_{l-1},\cdots,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</p>
<p>也就是$\sqrt{d} &#x3D; [\lfloor \sqrt{d} \rfloor,\frac{1}{\sqrt{d}-\lfloor \sqrt{d} \rfloor}]$</p>
<p>$ &#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_{l-1},\cdots,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</p>
<p>因此 循环内容 和 回文性质 得证</p>
<h2 id="利用连分数-解-Pell’s-Equation"><a href="#利用连分数-解-Pell’s-Equation" class="headerlink" title="利用连分数 解 Pell’s Equation"></a>利用连分数 解 Pell’s Equation</h2><p>因为平方带来的对称性,只考虑$x&gt;0,y&gt;0$的解</p>
<h3 id="x-sqrt-d-的后缀连分数-可以表示为-x-n-frac-P-n-sqrt-d-Q-n"><a href="#x-sqrt-d-的后缀连分数-可以表示为-x-n-frac-P-n-sqrt-d-Q-n" class="headerlink" title="$x&#x3D;\sqrt{d}$的后缀连分数 可以表示为 $x_n&#x3D;\frac{P_n+\sqrt{d}}{Q_n}$"></a>$x&#x3D;\sqrt{d}$的后缀连分数 可以表示为 $x_n&#x3D;\frac{P_n+\sqrt{d}}{Q_n}$</h3><p>若$d$为非平方数,$x&#x3D;\sqrt{d}$,</p>
<p>则对于任意$n$,存在整数$P_n,Q_n$满足$x_n&#x3D;\frac{P_n+\sqrt{d}}{Q_n}$和$d-P_n^2 &#x3D; 0 \pmod{Q_n}$</p>
<p>当$n&#x3D;0$时$(P_0,Q_0) &#x3D; (0,1)$满足,归纳法,若$n$时能满足上述两点性质,则</p>
<p>$x_{n+1} &#x3D; \frac{1}{x_n-a_n}$</p>
<p>$&#x3D;\frac{1}{\frac{P_n+\sqrt{d}}{Q_n}-a_n}$</p>
<p>$&#x3D;\frac{Q_n}{P_n+\sqrt{d}-a_n{Q_n}}$ (通过分母有理化)</p>
<p>$&#x3D;\frac{Q_n(P_n-a_nQ_n-\sqrt{d})}{(P_n-a_nQ_n)^2-d}$</p>
<p>$&#x3D;\frac{a_nQ_n-P_n+\sqrt{d}}{\frac{d-(P_n-a_nQ_n)^2}{Q_n}}$</p>
<p>$(P_{n+1},Q_{n+1}) &#x3D; (a_nQ_n-P_n,\frac{d-(P_n-a_nQ_n)^2}{Q_n})$</p>
<p>现在要证明的就是 它是满足$\frac{P_{n+1}+\sqrt{d}}{Q_{n+1}}$的形式,并且满足上面的取模</p>
<hr>
<p>也就是要证明$Q_{n+1}$是整数</p>
<p>$Q_{n+1} &#x3D; \frac{d-P_n^2}{Q_n}+2a_nP_n-a_n^2Q_n$, 因为$n$时有 $d-P_n^2 &#x3D; 0 \pmod{Q_n}$所以 $Q_{n+1}$是整数</p>
<p>又因为$Q_nQ_{n+1}&#x3D;d-P_{n+1}^2$ 所以  $d-P_{n+1}^2 &#x3D; 0 \pmod{Q_{n+1}}$ 得证</p>
<h3 id="sqrt-d-的渐进分数满足-h-n-1-2-d-k-n-1-2-1-n-Q-n"><a href="#sqrt-d-的渐进分数满足-h-n-1-2-d-k-n-1-2-1-n-Q-n" class="headerlink" title="$\sqrt{d}$的渐进分数满足 $h_{n-1}^2-d k_{n-1}^2&#x3D;(-1)^n Q_n$"></a>$\sqrt{d}$的渐进分数满足 $h_{n-1}^2-d k_{n-1}^2&#x3D;(-1)^n Q_n$</h3><p>对于$n \ge 2$ 要证明 $h_{n-1}^2-d k_{n-1}^2&#x3D;(-1)^n Q_n$</p>
<p>证明:</p>
<p>$\sqrt{d} &#x3D; \frac{x_n h_{n-1}+h_{n-2}}{x_nk_{n-1}+k_{n-2}}$</p>
<p>把$ x_n &#x3D; \frac{P_n+\sqrt{d}}{Q_n}$带入并通分化简</p>
<p>$(P_nk_{n-1}+Q_nk_{n-2}-h_{n-1})\sqrt{d} &#x3D; P_nh_{n-1}+h_{n-2}Q_n-k_{n-1}d$, 无理数 &#x3D; 有理数, 只有都为$0$</p>
<p>即 $P_nk_{n-1}+Q_nk_{n-2}&#x3D;h_{n-1}$ 且 $P_nh_{n-1}+h_{n-2}Q_n&#x3D;k_{n-1}d$</p>
<p>所以有 $h_{n-1}^2-dk_{n-1}^2 &#x3D; h_{n-1}(P_nk_{n-1}+Q_nk_{n-2})-k_{n-1}(P_nh_{n-1}+h_{n-2}Q_n)$</p>
<p>$&#x3D; Q_n(h_{n-1}k_{n-2}-h_{n-2}k_{n-1})$</p>
<p>$&#x3D; (-1)^nQ_n$</p>
<h3 id="pell方程的解一定是-sqrt-d-的渐进分数"><a href="#pell方程的解一定是-sqrt-d-的渐进分数" class="headerlink" title="pell方程的解一定是$\sqrt{d}$的渐进分数"></a>pell方程的解一定是$\sqrt{d}$的渐进分数</h3><p>若$(x,y)$是 pell方程$x^2-dy^2&#x3D;1$的解$(d&gt;1,x&gt;y&gt;0)$,则</p>
<p>$|\sqrt{d} - \frac{x}{y}| &#x3D; |\frac{dy^2-x^2}{y^2(\sqrt{d}+\frac{x}{y})}| &lt; \frac{1}{2y^2}$ (从一定程度上说明了 为什么前面要去证明 小于$\frac{1}{2y^2}$)</p>
<p>根据前面的结论, 知道满足这个表达式的一定是 无理数$\sqrt{d}$ 的 渐进数, (但渐进数不一定是解)</p>
<p>(Yang.pdf那个paper下面的部分蛮多笔误的 不过能看懂证明思路)</p>
<p>因为上面有 $h_{n-1}^2-dk_{n-1}^2&#x3D;(-1)^nQ_n$ 也就是如果要满足pell方程 那么$|Q_n|&#x3D;1$,分类讨论$Q_n$</p>
<p>假设 $\sqrt{d}$的 最小周期长度为l</p>
<h3 id="分类讨论-Q-1"><a href="#分类讨论-Q-1" class="headerlink" title="分类讨论 $Q &#x3D; -1$"></a>分类讨论 $Q &#x3D; -1$</h3><p>$Q_n \neq -1, n &gt; 0$</p>
<p>证明</p>
<p>注意到上面根据$\sqrt{d}$的表达式 证明了$n&gt;0$时,$x_n$是纯循环连分数,也就是reduced 二次无理数</p>
<p>如果$Q_n &#x3D; -1$ 因为$x_n&#x3D;\frac{P_n+\sqrt{d}}{Q_n}$,所以有 $x_n&#x3D;-P_n-\sqrt{d} &gt; 1$,有$-1&lt;-P_n+\sqrt{d} &lt; 0$ (Galois)</p>
<p>但$\sqrt{d} &lt; P_n &lt; -\sqrt{d} - 1$,矛盾 所以$Q_n \neq -1$, 对于$Q_0 &#x3D; 1$也不为$-1$,得证</p>
<h3 id="分类讨论-Q-1-1"><a href="#分类讨论-Q-1-1" class="headerlink" title="分类讨论 $Q &#x3D; 1$"></a>分类讨论 $Q &#x3D; 1$</h3><p>$Q_n &#x3D; 1$当且仅当$n$为循环节长度的倍数才有</p>
<p>证明</p>
<p>若于$n&gt;1$若$Q_n&#x3D;1$那么有$x_n&#x3D;P_n+\sqrt{d}$,它的共轭 $-1 &lt; P_n-\sqrt{d} &lt; 0$ 即 $P_n&#x3D;\lfloor \sqrt{d} \rfloor$所以 $x_n &#x3D; \lfloor \sqrt{d} \rfloor + \sqrt{d}$</p>
<p>$ \lfloor \sqrt{d} \rfloor +\sqrt{d} &#x3D; x_n &#x3D; 2\lfloor\sqrt{d}\rfloor + \frac{1}{\frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}} $ 即 $ x_{n+1} &#x3D; \frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}$</p>
<p>$ \sqrt{d} &#x3D; x_0 &#x3D; \lfloor \sqrt{d} \rfloor + \frac{1}{\frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}}$ 即 $x_1 &#x3D; \frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}$</p>
<p>说明了 它的下一个数$x_{n+1} $和$x_1$相等, 这说明如果$Q_n &#x3D; 1$ 那么n是当且仅当循环节长度的倍数(如果为1则循环节长度)</p>
<h3 id="循环节长度-与-pell方程的最小解"><a href="#循环节长度-与-pell方程的最小解" class="headerlink" title="循环节长度 与 pell方程的最小解"></a>循环节长度 与 pell方程的最小解</h3><p>最后回到这里 $h_{n-1}^2-dk_{n-1}^2&#x3D;(-1)^nQ_n &#x3D; (-1)^n $ 也就是再看个奇偶,最后得到了pell方程和连分数比较紧密的结论</p>
<p>假设 $\sqrt{d}$的 最小周期长度为$l$</p>
<p>那么对应pell 方程的最小解</p>
<p>$(x,y) &#x3D; {h_{l-1},k_{l-1}}$ 长度为偶数</p>
<p>$(x,y) &#x3D; {h_{2l-1},k_{2l-1}}$ 长度为奇数</p>
<h2 id="回顾历程"><a href="#回顾历程" class="headerlink" title="回顾历程"></a>回顾历程</h2><ol>
<li>pell方程解一定存在</li>
<li>pell方程所有解为基础解的幂次</li>
<li>连分数分子 分母 递推式</li>
<li>连分数,分子分母相关性质(分子分母互质性,原无理数与渐进数差值表达式,差值绝对值单调递减性,连分数是最给定分母以及更小分母中最接近原无理数,任何满足 渐进数充分不等式 的数字是渐进数（这个不等式是pell方程 的必要条件）)</li>
<li>Lagrange’s Theorem : 二次无理数 与 有循环节的连分数 等价关系</li>
<li>Galois’ Theorem : reduced二次无理数 与 纯循环连分数  等价关系</li>
<li>$x &#x3D; \sqrt{d} &#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,\cdots,a_2,a_1,2\lfloor \sqrt{d} \rfloor}] $, 以及连分数性质（精确的$x_n &#x3D; \frac{P_n+\sqrt{d}}{Q_n}$表示 和 渐进数性质$h_{n-1}^2-dk_{n-1}^2&#x3D;(-1)^nQ_n$）</li>
<li>分类讨论$Q_n &#x3D; 1 , -1$与$n$的取值, 循环节长度, 与最后的结论</li>
</ol>
<p>方法涉及</p>
<ol>
<li>反复抽屉原理,绝对值,无理数,模运算</li>
<li>二项式展开,不等式,唯一最小(有术语吗),无理数,反证法</li>
<li>矩阵乘法,归纳法&#x2F;递推关系</li>
<li>归纳法&#x2F;递推,互质,不等式放缩,三角不等式,反证法,二元一次方程组,巧妙正负值+不等式。 很多方法都是多次</li>
<li>归纳,反证,单调+整数离散+有限,二次函数</li>
<li>共轭实数,反向推,归纳法</li>
<li>归纳法,上面的分子分母等式性质</li>
<li>-1的幂次,分类讨论,Lagrange,Galois</li>
</ol>
<p>然后还有很多整数的离散性质</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Continued_fraction">Continued fraction</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pell%27s_equation">Pell equation</a></p>
<p><a target="_blank" rel="noopener" href="https://www.math.uchicago.edu/~may/VIGRE/VIGRE2008/REUPapers/Yang.pdf">Yang.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://crypto.stanford.edu/pbc/notes/contfrac/pell.html">stanford crypto pell</a></p>
<p><a target="_blank" rel="noopener" href="http://sites.millersville.edu/bikenaga/number-theory/periodic-continued-fractions/periodic-continued-fractions.html">millersville periodic-continued-fractions</a></p>
<p>下面这个youtube非常推荐,他讲得很系统,并不是证明了就好,而是按照了每步都能抽象出结论的推导过程,然后和连分数相关的没讲,主要在讲pell 方程的解的性质 </p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=E51GKQ1qorE">YouTube:Number Theory:Pell’s Equation part 1</a></p>
<p><a target="_blank" rel="noopener" href="https://dspace.sunyconnect.suny.edu/bitstream/handle/1951/69917/fulltext.pdf?sequence=1&isAllowed=y">A short proof and generalization of Lagrange’s theorem on continued fractions</a></p>
<p><a target="_blank" rel="noopener" href="http://sites.millersville.edu/bikenaga/number-theory/purely-periodic-continued-fractions/purely-periodic-continued-fractions.html">purely periodic continued fractions</a></p>
<h1 id="总结-感受"><a href="#总结-感受" class="headerlink" title="总结&amp;感受"></a>总结&amp;感受</h1><p>有些结论在证明过程中其实是缩小了范围,有些结论其实放大定义域之类也是成立的,但在证明过程中却只使用了所需要的部分。这类的从定义域和对应的要证明的逻辑不是“完美对应”的,但是足够,不知道是好还是不好。</p>
<p>证明的结论之间引用过程,感觉画成网状或者树状关系图会更好？</p>
<p>看youtube了上的讲解视频,会发现有一种写代码的抽取函数感觉,和我上面完全拆开证明不一样,抽函数的感觉其实在数学里大概是叫做“令”+“引理”,感觉和完全展开比较,的确能减少很多心智负担啊！如果你也能打开youtube建议去看看</p>
<p>另外比如有些 强结论要用的时候,即使你证出了相对弱的结论,但没有证明出强结论,其实相当于“没有用”,比如上面 基础解,的平方,的n次方,和任意另一组解能产生新的解的证明。当然如果能证明出,那些就是过程了,但不是步骤（虽然我上面有写进文中,因为要简洁整理的话,直接强结论证明,即可其它的弱的可以直接省略</p>
<p>虽然视频看的时候的确感觉到老师和同学的口算不如国内,但自从自己思考过十进制的意义以后,感觉数值计算都不再重要,有的是计算机,不需要人类来算。</p>
<p>youtuber james cook 有证明一个 同系数二元二次方程 之间的关系,可以用它来 从 不是解的东西里生成解(感觉好像不是特别行,因为一个等式的 四个值仅仅由两个变量控制而不是3个？)！(Quadradic Forms) Q(u+v)+Q(u-v)&#x3D;2(Q(u)+Q(v)),然后以此建立树,考虑其中的“正负交替路线”river</p>
<p>多核没智力还是搞不动数学啊,</p>
<p>这篇文章整理了很多篇其它资料,所以在符号使用上还不够统一,之后看有空整理一下</p>
<p>在我快写完这一篇文章的时候发现了 一个<a target="_blank" rel="noopener" href="https://chaoli.club/index.php/2756/0">超理论坛-连分数入门</a> 注册需要一点点水平XD,这篇是带着例子讲解写的！(大自看了一下 感觉很棒 推荐), 又 有些性质证明方式不止一种,例如我本篇文章所抄来的证明 二次无理数和有循环节的充要 会感觉更漂亮一些</p>
<p>有些paper写到后面还是很多笔误,不过看通了也是能理解具体过程</p>
<p>有一个想法是 哪些结论是关键或者说证明的难点,其实可以这样想,现在,把文章中一些部分换成填空,你还能不能补全整个文章,不需要完全一样,只要能证明就行。这样想的话,就会知道所谓的难点是在哪。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/pe/129/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/pe/129/" class="post-title-link" itemprop="url">pe 129(repunit divisibility,含证明)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-12-03 10:37:14" itemprop="dateCreated datePublished" datetime="2020-12-03T10:37:14+08:00">2020-12-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2024-01-26 01:38:14" itemprop="dateModified" datetime="2024-01-26T01:38:14+08:00">2024-01-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Project-Euler/" itemprop="url" rel="index"><span itemprop="name">Project Euler</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/pe/129/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="pe/129/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>1.2k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>4 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a target="_blank" rel="noopener" href="https://projecteuler.net/problem=129">https://projecteuler.net/problem=129</a></p>
<h1 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h1><p>给一个整数n,(gcd(n,10)&#x3D;1)，找最小的 <code>111...111</code>使得是n的倍数，A(n)返回这个最小的长度</p>
<p><code>A(7)=6</code>,<code>A(41)=5</code></p>
<p>求最小的n能让<code>A(n) &gt; 1000000</code>的</p>
<h2 id="存在性证明"><a href="#存在性证明" class="headerlink" title="存在性证明"></a>存在性证明</h2><p>题目说始终存在</p>
<p>因为$\text{gcd}(n,10) &#x3D; 1$所以n不包含2和5这两个质因子</p>
<p>考虑结尾的字符为<code>1,3,7,9</code></p>
<p>因为要证明的是任意n都能找到<code>111...111</code>，对于<code>3,7,9</code>结尾的，对应乘上<code>7,3,9</code>都会变成1 结尾的</p>
<p>那我们其实只要证明了 任何以1结尾的数，能找到<code>111...111</code>是它的倍数即可，我卡住了</p>
<hr>
<p>对于给定n要找到,考虑它的每个质数因子p</p>
<p>$(10^i-1)&#x2F;9 &#x3D; 0 \pmod p$</p>
<p><a target="_blank" rel="noopener" href="https://artofproblemsolving.com/wiki/index.php?title=Fermat%27s_Little_Theorem#Introductory">费马小定理</a></p>
<p>$a^{p-1} - 1 &#x3D; 0 \pmod p$</p>
<p>如果$p&#x3D;3$, 有111是它的倍数(不是按照上面的公式, 因为有除以9的部分)</p>
<p>如果$p$是非2,3,5的质数</p>
<p>$10^{p-1}-1&#x3D;0 \pmod p$</p>
<p>$(10^{p-1}-1)&#x2F;9&#x3D;0 \pmod p$</p>
<p>我们只得到</p>
<p>$10^{(p_1-1)(p_2-1)(p_3-1)} &#x3D; 1 \pmod {p_1 p_2 p_3}$</p>
<p>但是如果有幂次质因子还是未知</p>
<hr>
<p>和费马小定理相似但是更强劲的 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Euler%27s_theorem">欧拉定理</a></p>
<p>$a^{\varphi (n)} \equiv 1 \pmod{n}$</p>
<p>要求正好是 a和n互质</p>
<p>对于不含质因子3的$n$，能直接通过上式得到</p>
<p>$10^{\varphi (n)} \equiv 1 \pmod{n}$</p>
<p>$(10^{\varphi (n)} - 1)&#x2F;9 \equiv 0 \pmod{n}$</p>
<p>对于含有3质因子的$n$,直接考虑9n</p>
<p>$10^{\varphi (9n)} \equiv 1 \pmod{9n}$</p>
<p>$10^{\varphi (9n)} - 1 \equiv 0 \pmod{9n}$</p>
<p>$(10^{\varphi (9n)} - 1)&#x2F;9 \equiv 0 \pmod{n}$</p>
<p>得证</p>
<h2 id="证明-A-n-le-n"><a href="#证明-A-n-le-n" class="headerlink" title="证明 $A(n) \le n$"></a>证明 $A(n) \le n$</h2><p>考虑找到的$111\cdots 111$ 对应的<code>商</code> $x &#x3D; 111\cdots111 &#x2F; n$</p>
<p>因为我们上面证明了$n$能整除，所以倒过来思考乘积如何填数</p>
<p>$x \cdot n &#x3D; 111\cdots111$</p>
<p>因为 n 的末位是$1,3,7,9$中的奇数，那么 对于给定的尾数能直接确定商的尾数</p>
<p>同样我们能唯一确定十位,考虑每次计算后的余数</p>
<p>这里的余数是指 $((最少的前补1(\ge 0个) + 上一次的剩余值 - 当前商位上的数码\cdot n)&#x2F;10) \pmod n$,</p>
<p>显然，上一次的剩余值通过个位数唯一决定 当前商的数码，又 前补1要最少又能满足表达式大于0,也是唯一方案。</p>
<p>因此 低$i$位的余数唯一确定$i+1$位的余数 $r_{i+1} &#x3D; f(r_i)$，注意多个剩余值可能对应同一个余数，但这些余数相同的剩余值推导出的 高位的剩余值唯一</p>
<p>因此 考虑余数的变化，因为最终余数为零，所以中途余数不能成环。综上，商的位数不会超过$n$</p>
<p>因此原始的$111\cdots 111 &#x3D; x\cdot n$ 也不会超过$n$</p>
<hr>
<p>以7 举例, 说明上面的证明过程</p>
<p>$3\cdot 7&#x3D;21,(111-21)&#x2F;10 &#x3D; 9 &#x3D; 2 \pmod 7$</p>
<p>余数是控制链的长度，但是不影响计算 所以下面是109而不是102, 稍加理解的话是$102 - 6\cdot 7 &#x3D; 109 - 7\cdot 7$</p>
<p>$7\cdot 7&#x3D;49,(109-49)&#x2F;10 &#x3D; 6 &#x3D; 6 \pmod 7$</p>
<p>$8\cdot 7&#x3D;56,(106-56)&#x2F;10 &#x3D; 5 &#x3D; 5 \pmod 7$</p>
<p>$5\cdot 7&#x3D;35,(105-35)&#x2F;10 &#x3D; 7 &#x3D; 0 \pmod 7$ &#x2F;&#x2F; 同上不影响计算 </p>
<p>$1\cdot 7 &#x3D; 7, 7 - 7 &#x3D; 0$</p>
<p>因此$15873 \cdot 7 &#x3D; 111111$</p>
<p>余数变化是$2 \to 6 \to 5 \to 0$</p>
<hr>
<p>对应上面唯一描述是</p>
<p>剩余值$11$,确定商的数码$3$,$3\cdot 7&#x3D;21$,最少补充1个1,$(111-21&#x3D;90)&#x2F;10 &#x3D; 9$,剩余值9,余数2</p>
<p>剩余值$ 9$,确定商的数码$7$,$7\cdot 7&#x3D;49$,最少补充1个1,$(109-49&#x3D;60)&#x2F;10 &#x3D; 6$,剩余值6,余数6</p>
<p>剩余值$ 6$,确定商的数码$8$,$8\cdot 7&#x3D;56$,最少补充1个1,$(106-56&#x3D;50)&#x2F;10 &#x3D; 5$,剩余值5,余数5</p>
<p>剩余值$ 5$,确定商的数码$5$,$5\cdot 7&#x3D;35$,最少补充1个1,$(105-35&#x3D;70)&#x2F;10 &#x3D; 7$,剩余值7,余数0</p>
<p>剩余值$ 7$,确定商的数码$1$,$1\cdot 7&#x3D;7 $,最少补充0个1,7-7&#x3D;0 结束</p>
<hr>
<p>其实上面欧拉定理，我们只用关心 n 包含质因子3的情况，A(i) 是否会超过n</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><p>幂次总是在小于 n的时候能模为1,这样可以从1000000开始</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">def A(v):</span><br><span class="line">    p = 1</span><br><span class="line">    for j in range(1, 9*v+1):</span><br><span class="line">        p *= 10</span><br><span class="line">        p %= 9*v</span><br><span class="line">        if p % (9*v) == 1:</span><br><span class="line">            return j</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    maxAi = 0</span><br><span class="line">    for i in range(500000-10, 1000000):</span><br><span class="line">        ii = i*2+1</span><br><span class="line">        if ii % 10 != 5:</span><br><span class="line">            Ai = A(ii)</span><br><span class="line">            # if Ai &gt; ii:</span><br><span class="line">            #     print(ii, Ai)</span><br><span class="line">            if Ai - maxAi &gt; 10000:</span><br><span class="line">                maxAi = Ai</span><br><span class="line">                print(ii, Ai)</span><br><span class="line">            if Ai &gt; 1000000:</span><br><span class="line">                print(ii, Ai)</span><br><span class="line">                break</span><br><span class="line">    print(&quot;end&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>


<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://mathlesstraveled.com/2011/11/16/fun-with-repunit-divisors-proofs/">https://mathlesstraveled.com/2011/11/16/fun-with-repunit-divisors-proofs/</a></p>
<p><a target="_blank" rel="noopener" href="https://artofproblemsolving.com/wiki/index.php?title=Fermat%27s_Little_Theorem#Introductory">https://artofproblemsolving.com/wiki/index.php?title=Fermat%27s_Little_Theorem#Introductory</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Euler%27s_theorem">https://en.wikipedia.org/wiki/Euler%27s_theorem</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一頁" aria-label="上一頁" href="/Blog/page/42/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/Blog/">1</a><a class="page-number" href="/Blog/page/12/">12</a><a class="page-number" href="/Blog/page/28/">28</a><a class="page-number" href="/Blog/page/36/">36</a><a class="page-number" href="/Blog/page/40/">40</a><a class="page-number" href="/Blog/page/42/">42</a><span class="page-number current">43</span><a class="page-number" href="/Blog/page/44/">44</a><a class="page-number" href="/Blog/page/46/">46</a><a class="page-number" href="/Blog/page/50/">50</a><a class="page-number" href="/Blog/page/58/">58</a><a class="extend next" rel="next" title="下一頁" aria-label="下一頁" href="/Blog/page/44/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiao Ye</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">499k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">27:43</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="回到頂端">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/Blog/js/comments.js"></script><script src="/Blog/js/utils.js"></script><script src="/Blog/js/schemes/muse.js"></script><script src="/Blog/js/next-boot.js"></script><script src="/Blog/js/bookmark.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/Blog/js/third-party/search/local-search.js"></script>






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/Blog/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":false,"home":false,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://yexiaorain.github.io/Blog/page/43/"}</script>
  <script src="/Blog/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"yexiaorain","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/Blog/js/third-party/comments/disqus.js"></script>

</body>
</html>
