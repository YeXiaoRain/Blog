<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/Blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/Blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/Blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/Blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/Blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha256-xejo6yLi6vGtAjcMIsY8BHdKsLg7QynVlFMzdQgUuy8=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"yexiaorain.github.io","root":"/Blog/","images":"/Blog/images","scheme":"Muse","darkmode":false,"version":"8.12.3","exturl":false,"sidebar":{"position":"right","display":"hide","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/Blog/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/Blog/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="YeXiaoRain Blog">
<meta property="og:url" content="https://yexiaorain.github.io/Blog/page/37/index.html">
<meta property="og:site_name" content="YeXiaoRain Blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Xiao Ye">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://yexiaorain.github.io/Blog/page/37/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-TW","comments":"","permalink":"","path":"page/37/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>YeXiaoRain Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/Blog/css/noscript.css">
  </noscript>
<link rel="alternate" href="/Blog/atom.xml" title="YeXiaoRain Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/Blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">YeXiaoRain Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/Blog/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li><li class="menu-item menu-item-archives"><a href="/Blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔<span class="badge">245</span></a></li><li class="menu-item menu-item-yearmonth"><a href="/Blog/yearmonth/" rel="section"><i class="fa fa-calendar-days fa-fw"></i>年月</a></li><li class="menu-item menu-item-categories"><a href="/Blog/categories/" rel="section"><i class="fa fa-shapes fa-fw"></i>分類<span class="badge">17</span></a></li><li class="menu-item menu-item-tags"><a href="/Blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤<span class="badge">237</span></a></li><li class="menu-item menu-item-rss"><a href="/Blog/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>rss</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Xiao Ye"
      src="https://avatars.githubusercontent.com/u/7298239?v=4">
  <p class="site-author-name" itemprop="name">Xiao Ye</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/Blog/archives/">
          <span class="site-state-item-count">245</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/Blog/categories/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/Blog/tags/">
        <span class="site-state-item-count">237</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yexiaorain" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yexiaorain" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yexiaorain@gmail.com" title="E-Mail → mailto:yexiaorain@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://atcoder.jp/users/cromarmot" title="https:&#x2F;&#x2F;atcoder.jp&#x2F;users&#x2F;cromarmot" rel="noopener" target="_blank">AtCoder</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://codeforces.com/profile/YeXiaoRain" title="https:&#x2F;&#x2F;codeforces.com&#x2F;profile&#x2F;YeXiaoRain" rel="noopener" target="_blank">Codeforces</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="回到頂端">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/pe/078/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/pe/078/" class="post-title-link" itemprop="url">project euler 078 Coin partitions</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-06-10 10:37:14" itemprop="dateCreated datePublished" datetime="2020-06-10T10:37:14+08:00">2020-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2023-02-05 19:13:43" itemprop="dateModified" datetime="2023-02-05T19:13:43+08:00">2023-02-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Project-Euler/" itemprop="url" rel="index"><span itemprop="name">Project Euler</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/pe/078/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="pe/078/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>1.9k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>6 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a target="_blank" rel="noopener" href="https://projecteuler.net/problem=78">https://projecteuler.net/problem=78</a></p>
<p><code>4 = 4 = 3+1 = 2+2 = 2+1+1=1+1+1+1,p(4)=5</code></p>
<p><code>5 = 5 = 4+1 = 3+2 = 3+1+1 = 2+2+1 = 2+1+1+1 = 1+1+1+1+1,p(5)=7</code></p>
<p>求最小的n使得 <code>p(n) % 1_000_000 = 0</code></p>
<h1 id="rust"><a href="#rust" class="headerlink" title="rust"></a>rust</h1><p>dp递推暴力似乎并不可解,<strong>警告 下面的代码 只要没找到答案就会一直增加vector大小，所以建议尽早掐断，不然会吃很大内存XD,可能造成系统卡死或者假卡死</strong></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::cmp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// dp[n][x] + (n-x &lt;= x?) + sum(dp[n-x][1 -&gt; min(x,n-x-1)])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">dp</span> = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">dpsum</span> = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    dp.<span class="title function_ invoke__">push</span>(<span class="type">Vec</span>::<span class="title function_ invoke__">new</span>());</span><br><span class="line">    dpsum.<span class="title function_ invoke__">push</span>(<span class="type">Vec</span>::<span class="title function_ invoke__">new</span>());</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">i</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">loop</span>&#123;</span><br><span class="line">        dp.<span class="title function_ invoke__">push</span>(<span class="type">Vec</span>::<span class="title function_ invoke__">new</span>());</span><br><span class="line">        dpsum.<span class="title function_ invoke__">push</span>(<span class="type">Vec</span>::<span class="title function_ invoke__">new</span>());</span><br><span class="line">        dp[i].<span class="title function_ invoke__">push</span>(<span class="number">0</span>);</span><br><span class="line">        dpsum[i].<span class="title function_ invoke__">push</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">cnt</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">j</span> <span class="keyword">in</span> <span class="number">1</span>..i+<span class="number">1</span> &#123;</span><br><span class="line">            dp[i].<span class="title function_ invoke__">push</span>(<span class="number">0</span>);</span><br><span class="line">            dpsum[i].<span class="title function_ invoke__">push</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> i == j &#123;</span><br><span class="line">                dp[i][j] = <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                dp[i][j] = dpsum[i-j][cmp::<span class="title function_ invoke__">min</span>(j,i-j)];</span><br><span class="line">            &#125;</span><br><span class="line">            cnt += dp[i][j];</span><br><span class="line">            cnt %= <span class="number">1_000_000</span>;</span><br><span class="line">            dpsum[i][j] = (dpsum[i][j-<span class="number">1</span>]+dp[i][j]) % <span class="number">1_000_000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;=&gt;&#123;&#125;&quot;</span>,i,cnt);</span><br><span class="line">        <span class="keyword">if</span> cnt % <span class="number">1_000_000</span> == <span class="number">0</span> &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;=&gt;&#123;&#125;&quot;</span>,i,cnt);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        i+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><h2 id="分拆"><a href="#分拆" class="headerlink" title="分拆"></a>分拆</h2><p>实际上可以把n看成，拆了$a_1$个1,$a_2$个2…</p>
<p>所以$p(n)$可以看成 $n &#x3D; 1a_1+2a_2+3a_3+…+na_n$的解 $(a_1,a_2,…,a_n)$的个数</p>
<p>也是 $(1+x+x^2+x^3+…)(1+x^2+x^4+x^6+…)(1+x^3+x^6+x^9+…)…$ 结果中 $x^n$的系数,因为相当于从每个括号中选取了一项 假设第i个括号选取的是$x^{ij}$ 那么对应上面 $a_i &#x3D; j$，也对应到相关的解</p>
<p>也就是 $\sum_{n&#x3D;0}^{\infty} p(n)x^n &#x3D; (1+x+x^2+…)(1+x^2+x^4+…)… &#x3D; \frac{1}{1-x} \frac{1}{1-x^2} … &#x3D; \prod_{n&#x3D;1}^{\infty} \frac{1}{1-x^n} $ </p>
<h2 id="互异分拆"><a href="#互异分拆" class="headerlink" title="互异分拆"></a>互异分拆</h2><p>如果分拆结果要求 不能出现相同的数字(互异分拆 partitions into distinct parts)，则相当于上面$a_i$增加限制$a_i\in\{0,1\}$</p>
<p>也就是 $\sum_{n&#x3D;0}^{\infty} q(n)x^n &#x3D; (1+x)(1+x^2)… &#x3D; \prod_{n&#x3D;1}^{\infty} (1+x^n) $ </p>
<p>$p(n) &#x3D; $拆分成偶数个互异的数的方案数 + 拆分成奇数个互异的数方案数</p>
<p>考虑一个互异分拆$n&#x3D;n_1+n_2+…+n_s$ (注意这里是$n_i$不是$a_i$,实际是$a_{n_i} &#x3D; 1$的那些)</p>
<p>$x^{n} &#x3D; x^{n_1}x^{n_2}…x^{n_s}$</p>
<p>$(-1)^sx^{n} &#x3D; (-x^{n_1})(-x^{n_2})…(-x^{n_s})$</p>
<p>考虑 $\sum_{n&#x3D;0}^{\infty} g(n)x^n &#x3D; (1-x)(1-x^2)… &#x3D; \prod_{n&#x3D;1}^{\infty} (1-x^n) $ 从值的构成上 它依然表示的是互异分拆 </p>
<p>注意到:$a_{n_i} &#x3D; 0$在乘积贡献上是1,$a_{n_i}&#x3D;1$在乘积贡献上是$-1$,所以 上述 每个互异分拆 对$g(n)$的贡献 是 $(-1)^s$</p>
<p>也就是$g(n) &#x3D; $拆分成偶数个互异的数方案数 - 拆分成奇数个互异的数方案数</p>
<h2 id="g-n"><a href="#g-n" class="headerlink" title="g(n)"></a>g(n)</h2><p>下面我们要看看欧拉大佬的神之推导</p>
<p>先上 Ferrer 图</p>
<p>比如 $ 11 &#x3D; 5+4+2$</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xxxxx</span><br><span class="line">xxxx</span><br><span class="line">xx</span><br></pre></td></tr></table></figure>

<p>只考虑互异分拆，把底部的长度记为b(上图是1),从最大递减1的长度记为s(上图是5,4 所以s&#x3D;2)</p>
<p>如果 一个图 $s \le b$,那么可以把最下面一排移到右侧,上图变为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xxxxx x</span><br><span class="line">xxxx x</span><br></pre></td></tr></table></figure>

<p>注意性质</p>
<ol>
<li><p>移动以后，因为少了一行，分拆的奇偶性变了。</p>
</li>
<li><p>b至少增加1, s &#x3D; 原来的b ，所以 新的图是 s&gt;b的。</p>
</li>
</ol>
<p>仅有一种情况是不能移动的（因为要移动的最后一行点数比移动后剩余的行数大1） 如下,注意到需要s排满和s排满，所以对于分拆的一个n，至多出现一次，学过等差数列求和的也可以看出满足这种的n的公式。</p>
<p>$n &#x3D; \frac{s(s+(2s-1))}{2}$</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xxxxx</span><br><span class="line">xxxx</span><br><span class="line">xxx</span><br></pre></td></tr></table></figure>

<p>以上 说明除了这特殊的以外，所有$s \le b$的 都有唯一对应的 $s &gt; b$的互异ferrer图</p>
<hr>
<p>再看 $s&gt;b$的,例如(s&#x3D;3,b&#x3D;2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xxxxxx</span><br><span class="line">xxxxx</span><br><span class="line">xxx</span><br></pre></td></tr></table></figure>

<p>我们把右侧45度的点移到下面一排，有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xxxxx</span><br><span class="line">xxxx</span><br><span class="line">xxx</span><br><span class="line">xx</span><br></pre></td></tr></table></figure>

<p>同样有性质</p>
<ol>
<li>移动以后因为多了一行，分拆的奇偶性变了</li>
<li>新的s &gt;&#x3D;旧的s，新的b &#x3D; 旧的s，所以有 新的s&gt;&#x3D;新的b</li>
</ol>
<p>同样有特殊的$s+1&#x3D;b$的排满时，不能移动（否则移动后最下两行点数相等）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xxxxxx</span><br><span class="line">xxxxx</span><br><span class="line">xxxx</span><br></pre></td></tr></table></figure>

<p>同样学过等差数列求和的，对于一个n最多有一个，n的表达式也呼之欲出了</p>
<p>$n &#x3D; \frac{s((s+1)+2s)}{2}$</p>
<p>综上 除了两种特殊的情况，其它的 都能找到一一对应的，所以偶奇相减除了特殊的外结果为0</p>
<p>所以就有神奇的展开</p>
<p>$\prod_{n&#x3D;1}^{\infty}(1-x^n) &#x3D; 1+\sum_{s&#x3D;1}^{\infty} (-1)^s(x^{\frac{3s^2-s}{2}}+x^{\frac{3s^2+s}{2}})$</p>
<h1 id="回到目标p-n"><a href="#回到目标p-n" class="headerlink" title="回到目标p(n)"></a>回到目标p(n)</h1><p>$(\sum_{n&#x3D;0}^{\infty} p(n)x^n)(\cdot \prod_{n&#x3D;1}^{\infty} 1-x^n) &#x3D; (\prod_{n&#x3D;1}^{\infty} )\cdot(\frac{1}{1-x^n} \cdot \prod_{n&#x3D;1}^{\infty} 1-x^n) &#x3D; 1 $ (…真的能这样乘吗。。</p>
<p>$(\sum_{n&#x3D;0}^{\infty} p(n)x^n)(1+\sum_{s&#x3D;1}^{\infty} (-1)^s(x^{\frac{3s^2-s}{2}}+x^{\frac{3s^2+s}{2}})) &#x3D; 1 $ </p>
<p>也就意味着左边 乘以后 对于$n&gt;0$ 乘积后的系数都是$a_n &#x3D; 0$</p>
<p>$a_n x^n &#x3D; (p(n)x^n\cdot 1 + \sum_{s&#x3D;1}^{\frac{3s^2-s}{2} \le n}[ p(n-\frac{3s^2-s}{2}) x^{n-\frac{3s^2-s}{2}} (-1)^s \cdot x^{\frac{3s^2-s}{2}} ]+ \sum_{s&#x3D;1}^{\frac{3s^2+s}{2} \le n}[ p(n-\frac{3s^2+s}{2}) x^{n-\frac{3s^2+s}{2}} (-1)^s \cdot x^{\frac{3s^2+s}{2}} ])$</p>
<p>$0&#x3D;a_n &#x3D; p(n) + \sum_{s&#x3D;1}^{\frac{3s^2-s}{2} \le n}[ p(n-\frac{3s^2-s}{2}) (-1)^s ]+ \sum_{s&#x3D;1}^{\frac{3s^2+s}{2} \le n}[ p(n-\frac{3s^2+s}{2}) (-1)^s ])$</p>
<p>由此 我们有了$p(n)$的递推式,时间复杂度像是$n^1.5$(因为 s与n的不等式 是s平方增长 ，空间就只需要$O(n)$</p>
<p>$p(n) &#x3D;  \sum_{s&#x3D;1}^{\frac{3s^2-s}{2} \le n}[(-1)^{s+1} p(n-\frac{3s^2-s}{2})]+ \sum_{s&#x3D;1}^{\frac{3s^2+s}{2} \le n}[(-1)^{s+1} p(n-\frac{3s^2+s}{2}) ])$</p>
<p>只需要初始化$p(0) &#x3D; 1$</p>
<p><strong>至此就已经可以编码了</strong></p>
<p>有的地方会采取 $t&#x3D;-s$的带入第一个求和，把上面两个求和合并成一个,也就是 s取非零的正负整数</p>
<p>$p(n) &#x3D; \sum_{s\neq 0,s\in Z,\frac{3s^2+s}{2}\le n} [(-1)^{s+1}p(n-\frac{3s^2+s}{2})] $</p>
<p>然后就是五边形数相关的东西了,在这道题看来 不是必须的</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">ans</span> = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">modnum</span>:<span class="type">i32</span> = <span class="number">1_000_000</span>; <span class="comment">// 注意usize范围很小 大坑</span></span><br><span class="line">    ans.<span class="title function_ invoke__">push</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">i</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">loop</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">ansi</span>:<span class="type">i32</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span>:<span class="type">i32</span> = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sres</span> = ( s*(<span class="number">3</span>*s-<span class="number">1</span>)/<span class="number">2</span> ) <span class="keyword">as</span> <span class="type">usize</span>;</span><br><span class="line">        <span class="keyword">while</span> sres &lt;= i&#123;</span><br><span class="line">            ansi += ((s%<span class="number">2</span>)*<span class="number">2</span>-<span class="number">1</span>) * ans[i - sres];</span><br><span class="line">            ansi %= modnum;</span><br><span class="line">            s+=<span class="number">1</span>;</span><br><span class="line">            sres = ( s*(<span class="number">3</span>*s-<span class="number">1</span>)/<span class="number">2</span> ) <span class="keyword">as</span> <span class="type">usize</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        s = <span class="number">1</span>;</span><br><span class="line">        sres = (s*(<span class="number">3</span>*s+<span class="number">1</span>)/<span class="number">2</span>) <span class="keyword">as</span> <span class="type">usize</span>;</span><br><span class="line">        <span class="keyword">while</span> sres &lt;= i&#123;</span><br><span class="line">            ansi += ((s%<span class="number">2</span>)*<span class="number">2</span>-<span class="number">1</span>) * ans[i - sres];</span><br><span class="line">            ansi %= modnum;</span><br><span class="line">            s+=<span class="number">1</span>;</span><br><span class="line">            sres = (s*(<span class="number">3</span>*s+<span class="number">1</span>)/<span class="number">2</span>) <span class="keyword">as</span> <span class="type">usize</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ansi+=modnum;</span><br><span class="line">        ansi%=modnum;</span><br><span class="line"></span><br><span class="line">        ans.<span class="title function_ invoke__">push</span>(ansi);</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;=&gt;&#123;&#125;&quot;</span>,i,ansi);</span><br><span class="line">        <span class="keyword">if</span> ansi == <span class="number">0</span> &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;ans :&#123;&#125;&quot;</span>,i);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        i+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>秒出</p>
<p>不过看结果和我第一遍卡爆内存的值一比，我想是不是多点内存也是暴力可行的XD。</p>
<h1 id="本题没有用到的-euler’s-theorem"><a href="#本题没有用到的-euler’s-theorem" class="headerlink" title="本题没有用到的 euler’s theorem"></a>本题没有用到的 euler’s theorem</h1><p>互异分拆方案数&#x3D;拆分成全是奇数个的方案数 ,$(1+x+x^2+…)(1+x^3+x^6+…)(1+x^5+x^{10}+…)…$</p>
<p>$\prod_{n&#x3D;1}^{\infty} \sum_{k&#x3D;0}^{\infty} x^{k*(2n-1)}$</p>
<p>$&#x3D; \prod_{n&#x3D;1}^{\infty} \frac{1}{1-x^{2n-1}}$</p>
<p>$&#x3D; \prod_{n&#x3D;1}^{\infty} \frac{1}{1-x^{2n-1}} \frac{\prod_{n&#x3D;1}^{\infty} 1-x^{2n}}{\prod_{n&#x3D;1}^{\infty} 1-x^{2n}}$</p>
<p>$&#x3D; \frac{1}{\prod_{n&#x3D;1}^{\infty} 1-x^{2n-1}}\frac{\prod_{n&#x3D;1}^{\infty} (1-x^n)(1+x^n)}{\prod_{n&#x3D;1}^{\infty} 1-x^{2n}}$</p>
<p>$ &#x3D; \prod_{n&#x3D;1}^{\infty} (1+x^n)$ (这。。。无限项这样拆分相消科学吗</p>
<p>就有了wikipedia上面那个公式 $\sum _{n&#x3D;0}^{\infty }q(n)x^{n}&#x3D;\prod _{k&#x3D;1}^{\infty }(1+x^{k})&#x3D;\prod _{k&#x3D;1}^{\infty }{\frac {1}{1-x^{2k-1}}}.$</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><code>https://en.wikipedia.org/wiki/Partition_(number_theory)</code></p>
<p><code>https://en.wikipedia.org/wiki/Pentagonal_number_theorem</code></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/pe/075/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/pe/075/" class="post-title-link" itemprop="url">project euler 075 Singular integer right triangles</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-06-08 10:37:14" itemprop="dateCreated datePublished" datetime="2020-06-08T10:37:14+08:00">2020-06-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2023-02-05 19:13:43" itemprop="dateModified" datetime="2023-02-05T19:13:43+08:00">2023-02-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Project-Euler/" itemprop="url" rel="index"><span itemprop="name">Project Euler</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/pe/075/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="pe/075/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>1.1k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>4 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a target="_blank" rel="noopener" href="https://projecteuler.net/problem=75">https://projecteuler.net/problem=75</a></p>
<p>$12&#x3D;3+4+5,3^2+4^2&#x3D;5^2;$</p>
<p>有些整数 有唯一拆分，可以拆分成直角三角形的三条边</p>
<h1 id="rust"><a href="#rust" class="headerlink" title="rust"></a>rust</h1><p>看上去 枚举中间长度，二分最短长度，估算一下 <code>(n*n/4 log n)</code>，</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::thread;</span><br><span class="line"><span class="keyword">use</span> std::sync::mpsc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> N:<span class="type">usize</span> = <span class="number">1_500_000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">f</span>(s:<span class="type">usize</span>) <span class="punctuation">-&gt;</span> <span class="type">usize</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">cnt</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">mstart</span> = <span class="keyword">if</span> s/<span class="number">4</span> &gt; <span class="number">1</span> &#123;s/<span class="number">4</span>&#125;<span class="keyword">else</span>&#123;<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">m</span> <span class="keyword">in</span> mstart..s/<span class="number">2</span>+<span class="number">1</span> &#123;</span><br><span class="line">    <span class="comment">// for m in 1..s+1 &#123;</span></span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">l</span> = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">r</span> = m+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> l+<span class="number">1</span> &lt; r &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">mid</span> = (l+r)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">o</span> = s-m-mid;</span><br><span class="line">            <span class="keyword">if</span> o &lt; m  || mid*mid + m*m &gt; o*o &#123;</span><br><span class="line">                r = mid;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> mid*mid + m*m &lt;= o*o &#123;</span><br><span class="line">                l = mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">o</span> = s-m-l;</span><br><span class="line">        <span class="keyword">if</span> l*l+m*m == o*o &#123;</span><br><span class="line">            cnt+=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> cnt &gt; <span class="number">1</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> cnt == <span class="number">1</span> &#123;<span class="number">1</span>&#125;<span class="keyword">else</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> (tx, rx) = mpsc::<span class="title function_ invoke__">channel</span>();</span><br><span class="line">    thread::<span class="title function_ invoke__">spawn</span>(<span class="keyword">move</span> || &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">1</span>..N+<span class="number">1</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">tx_clone</span> = mpsc::Sender::<span class="title function_ invoke__">clone</span>(&amp;tx) ; </span><br><span class="line">            thread::<span class="title function_ invoke__">spawn</span>(<span class="keyword">move</span> || &#123;</span><br><span class="line">                tx_clone.<span class="title function_ invoke__">send</span>( (i,<span class="title function_ invoke__">f</span>(i)) ).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">ans</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">_i</span> <span class="keyword">in</span> <span class="number">1</span>..N+<span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">rxr</span> = rx.<span class="title function_ invoke__">recv</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">        <span class="keyword">if</span> rxr.<span class="number">1</span> == <span class="number">1</span> &#123;</span><br><span class="line">            ans += <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> ans % <span class="number">1000</span> == <span class="number">0</span> &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;sum: &#123;&#125;&quot;</span>, rxr.<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;ans:&#123;&#125;&quot;</span>,ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>答案每新增1000 输出一次当前i，但运行了3min+ (x8核) 我把它掐了,准备学一学 如何数学角度优化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">time ./p075 </span><br><span class="line">sum: 8890</span><br><span class="line">sum: 18078</span><br><span class="line">sum: 27312</span><br><span class="line">sum: 36472</span><br><span class="line">sum: 45568</span><br><span class="line">sum: 54426</span><br><span class="line">sum: 63444</span><br><span class="line">sum: 72672</span><br><span class="line">sum: 81828</span><br><span class="line">sum: 90648</span><br><span class="line">sum: 99898</span><br><span class="line">sum: 109240</span><br><span class="line">sum: 118476</span><br><span class="line">sum: 127950</span><br><span class="line">sum: 137208</span><br><span class="line">sum: 146294</span><br><span class="line">sum: 155246</span><br><span class="line">sum: 164206</span><br><span class="line">sum: 173180</span><br><span class="line">sum: 182322</span><br><span class="line">sum: 191448</span><br><span class="line">sum: 200406</span><br><span class="line">sum: 209448</span><br><span class="line">sum: 218514</span><br><span class="line">sum: 227412</span><br><span class="line">sum: 236474</span><br><span class="line">sum: 245712</span><br><span class="line">sum: 254716</span><br><span class="line">sum: 263728</span><br><span class="line">sum: 272950</span><br><span class="line">sum: 282184</span><br><span class="line">sum: 291248</span><br><span class="line">sum: 300514</span><br><span class="line">sum: 309800</span><br><span class="line">sum: 319228</span><br><span class="line">sum: 328368</span><br><span class="line">sum: 337978</span><br><span class="line">sum: 347204</span><br><span class="line">sum: 356892</span><br><span class="line">sum: 366226</span><br><span class="line">sum: 375914</span><br><span class="line">^C</span><br><span class="line"></span><br><span class="line">real	3m33.095s</span><br><span class="line">user	24m40.718s</span><br><span class="line">sys	0m22.575s</span><br></pre></td></tr></table></figure>

<h1 id="解法"><a href="#解法" class="headerlink" title="解法"></a>解法</h1><p>如果有正整数对$(a,b,c)$满足$a^2+b^2&#x3D;c^2$那么 这是一组勾股数</p>
<p>我们可以有$(ka,kb,kc)$也是勾股数，对于$gcd(a,b,c) &#x3D; 1$的情况 称作素勾股数字</p>
<p>若$m&gt;n$且$gcd(m,n)&#x3D;1$ , m,n一个奇一个偶。</p>
<p>则令 $a&#x3D;m^2-n^2$,$b&#x3D;2mn$,$c&#x3D;m^2+n^2$ ，则$(a,b,c)$是 素勾股数 </p>
<p>充分性显然，上述表达满足勾股定理,且根据gcd运算规则是素勾股数</p>
<p>下面再证明必要，也就是所有素勾股数都能拆解成上面的<code>m</code>和<code>n</code>,</p>
<p>因为$gcd(a,b,c) &#x3D; 1$ 说明两两$gcd &#x3D; 1$(否则如果两个gcd不为1,运算过程 会导致另一个变量也是这个gcd的倍数 )</p>
<p>因此 必定<code>a,b</code>一个奇一个偶</p>
<p>根据轮换性质，不妨设 a奇 b偶 c奇</p>
<p>有$(c-a)(c+a)&#x3D;b^2$</p>
<p>令  $\frac{m}{n} &#x3D; \frac{c+a}{b} &#x3D; \frac{b}{c-a}$</p>
<p>下面解 方程组$\frac{c}{b} + \frac{a}{b} &#x3D; \frac{m}{n}, \frac{c}{b}-\frac{a}{b}&#x3D;\frac{n}{m}$</p>
<p>得到$\frac{c}{b}&#x3D;\frac{m^2+n^2}{2mn},\frac{a}{b}&#x3D;\frac{m^2-n^2}{2mn}$</p>
<p>所以 素勾股数字总能写成上述m,n的形式</p>
<p>以上证明了 素勾股数 和 m,n 形式的充要关系</p>
<hr>
<p>注意到 $c&#x3D;m^2+n^2$</p>
<p>所以 最大的只用枚举到 $\sqrt{\frac{l}{2}}$</p>
<h2 id="勾股数"><a href="#勾股数" class="headerlink" title="勾股数"></a>勾股数</h2><p>上面感觉很突兀,</p>
<p>看了一下 <a target="_blank" rel="noopener" href="https://personal.math.ubc.ca/~cass/courses/m446-03/pl322/parametrization.html">https://personal.math.ubc.ca/~cass/courses/m446-03/pl322/parametrization.html</a> 的文章发现了来源</p>
<p>如果 a,b,c 能构成, 那么 (a&#x2F;c,b&#x2F;c) 在单位圆上, 且是 有理点, 那么和(1,0)的斜率也是有理数</p>
<p>令为(A,B),  (B-0)&#x2F;(A-1) &#x3D; m, A^2+B^2&#x3D;1, 解这个方程组</p>
<p>!! 没有根号, A&#x3D;(m^2-1)&#x2F;(m^2+1), B&#x3D;-2m&#x2F;(m^2+1)</p>
<p>令 m &#x3D; -p&#x2F;q, 带进去 就很自然了</p>
<hr>
<p>这样的话 ,对于椭圆 x^2+by^2&#x3D;z^2</p>
<p>同样是(x&#x2F;z,y&#x2F;z) 在椭圆上, 然后过(1,0)</p>
<p>就可以搞Project Euler 195了</p>
<h1 id="code"><a href="#code" class="headerlink" title="code"></a>code</h1><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::thread;</span><br><span class="line"><span class="keyword">use</span> std::sync::mpsc;</span><br><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> N:<span class="type">usize</span> = <span class="number">1_500_000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">gcd</span>(v1:<span class="type">usize</span>,v2:<span class="type">usize</span>) <span class="punctuation">-&gt;</span> <span class="type">usize</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> v2 == <span class="number">0</span> &#123;v1&#125; <span class="keyword">else</span>&#123;<span class="title function_ invoke__">gcd</span>(v2,v1%v2)&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">f</span>(n:<span class="type">usize</span>) <span class="punctuation">-&gt;</span> HashMap&lt;<span class="type">usize</span>,<span class="type">usize</span>&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">m</span> = n+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">ret</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">while</span> <span class="number">2</span>*m*(m+n) &lt;= N&#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="title function_ invoke__">gcd</span>(m*m-n*n,<span class="number">2</span>*m*n) == <span class="number">1</span> &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;,&#123;&#125;,&#123;&#125; =&gt; &#123;&#125;&quot;</span>,m*m-n*n,<span class="number">2</span>*m*n,m*m+n*n,<span class="number">2</span>*m*(m+n));</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">l</span> = <span class="number">2</span>*m*(m+n);</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">kl</span> = l;</span><br><span class="line">            <span class="keyword">while</span> kl &lt;= N&#123;</span><br><span class="line">                ret.<span class="title function_ invoke__">insert</span>(kl, <span class="keyword">match</span> ret.<span class="title function_ invoke__">get</span>(&amp;kl) &#123;</span><br><span class="line">                    <span class="title function_ invoke__">Some</span>(oldcnt) =&gt; oldcnt+<span class="number">1</span>,</span><br><span class="line">                    <span class="literal">None</span> =&gt; <span class="number">1</span></span><br><span class="line">                &#125;);</span><br><span class="line">                kl+=l;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        m+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> (tx, rx) = mpsc::<span class="title function_ invoke__">channel</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">maxn</span> = <span class="number">1000</span>; <span class="comment">// N+1</span></span><br><span class="line">    thread::<span class="title function_ invoke__">spawn</span>(<span class="keyword">move</span> || &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">1</span>..maxn&#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">tx_clone</span> = mpsc::Sender::<span class="title function_ invoke__">clone</span>(&amp;tx) ; </span><br><span class="line">            thread::<span class="title function_ invoke__">spawn</span>(<span class="keyword">move</span> || &#123;</span><br><span class="line">                tx_clone.<span class="title function_ invoke__">send</span>( <span class="title function_ invoke__">f</span>(i) ).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">hash_res</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">_i</span> <span class="keyword">in</span> <span class="number">1</span>..maxn &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">rxr</span> = rx.<span class="title function_ invoke__">recv</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">        <span class="title function_ invoke__">for</span> (k,v) <span class="keyword">in</span> rxr&#123;</span><br><span class="line">            hash_res.<span class="title function_ invoke__">insert</span>(k,<span class="keyword">match</span> hash_res.<span class="title function_ invoke__">get</span>(&amp;k)&#123;</span><br><span class="line">                <span class="title function_ invoke__">Some</span>(oldv) =&gt; oldv+v,</span><br><span class="line">                <span class="literal">None</span> =&gt; v</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">ans</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="title function_ invoke__">for</span> (_k,v) <span class="keyword">in</span> hash_res&#123;</span><br><span class="line">        <span class="keyword">if</span> v == <span class="number">1</span>&#123;</span><br><span class="line">            ans += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;ans:&#123;&#125;&quot;</span>,ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pythagorean_triple">https://en.wikipedia.org/wiki/Pythagorean_triple</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Formulas_for_generating_Pythagorean_triples">https://en.wikipedia.org/wiki/Formulas_for_generating_Pythagorean_triples</a></p>
<p><a target="_blank" rel="noopener" href="https://personal.math.ubc.ca/~cass/courses/m446-03/pl322/parametrization.html">https://personal.math.ubc.ca/~cass/courses/m446-03/pl322/parametrization.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/pe/066/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/pe/066/" class="post-title-link" itemprop="url">project euler 066 diophantine equation</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-05-29 10:37:14" itemprop="dateCreated datePublished" datetime="2020-05-29T10:37:14+08:00">2020-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2023-02-05 19:13:43" itemprop="dateModified" datetime="2023-02-05T19:13:43+08:00">2023-02-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Project-Euler/" itemprop="url" rel="index"><span itemprop="name">Project Euler</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/pe/066/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="pe/066/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>10k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>34 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="叹气"><a href="#叹气" class="headerlink" title="叹气"></a>叹气</h1><p>从2020 02 09 挖的坑，中间很长一段时间鸽了，终于在05 29写完了.</p>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a target="_blank" rel="noopener" href="https://projecteuler.net/problem=66">https://projecteuler.net/problem=66</a></p>
<h1 id="大意"><a href="#大意" class="headerlink" title="大意"></a>大意</h1><p>d &#x3D; 1-&gt;1000，d是非平方数</p>
<p>对于每个d 求最小的正整数<code>x</code>使得$x^2-dy^2&#x3D;1$，其中x,y都是正整数,</p>
<p>最后对所有这些x求最大的x</p>
<h1 id="读懂本文你可能需要的前置知识"><a href="#读懂本文你可能需要的前置知识" class="headerlink" title="读懂本文你可能需要的前置知识"></a>读懂本文你可能需要的前置知识</h1><p>抽屉原理</p>
<p>二元一次方程</p>
<p>绝对值</p>
<p>有理数&#x2F;无理数</p>
<p>模运算</p>
<p>矩阵运算</p>
<p>数列&#x2F;递推数列</p>
<p>二项式展开</p>
<p>反证法</p>
<p>归纳法</p>
<p>不等式(缩放，三角不等式)</p>
<p>共轭实数(不太知道怎么翻译比较好，还是对偶实数？ 描述的就是$a+b\sqrt{m}$与$a-b\sqrt{m}$</p>
<h1 id="自闭尝试"><a href="#自闭尝试" class="headerlink" title="自闭尝试"></a>自闭尝试</h1><h2 id="一些自己的数学推论"><a href="#一些自己的数学推论" class="headerlink" title="一些自己的数学推论"></a>一些自己的数学推论</h2><p>如果质数p是d的因子，那么$x^2 &#x3D; 1 (\bmod p)$,由此$x &#x3D; 1 (\bmod p)$ 或者$x&#x3D;p-1(\bmod p)$</p>
<p>所以我们可以按d的最大质因子的倍数 加减1去搜，能快个常数倍</p>
<hr>
<p>显然有$(x-1)(x+1) &#x3D; dy^2$</p>
<p>令$d&#x3D;d_1 \cdot d_2$</p>
<p>令$y&#x3D;y_1 \cdot y_2$</p>
<p>根据对称性必然有 $d_1 \cdot {y_1}^2 - d_2 \cdot {y_2}^2 &#x3D; (x+1) - (x-1) &#x3D; 2$</p>
<p>一定程度上能减少搜索量，优化最多也就最大质数常数倍，也是最多100倍的优化</p>
<blockquote>
<p>另外就是MOD 4的性质，用处不大，2倍左右常数优化</p>
</blockquote>
<blockquote>
<p>然后就是1-100内的尝试是d&#x3D;61最大1766319049</p>
</blockquote>
<blockquote>
<p>如果d0能找到x0，那么d0和y0因子平方的组合最多是x0,也是优化不大</p>
</blockquote>
<h2 id="python3写了个-按x递增搜索"><a href="#python3写了个-按x递增搜索" class="headerlink" title="python3写了个 按x递增搜索"></a>python3写了个 按x递增搜索</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">1000</span></span><br><span class="line">arr = <span class="built_in">set</span>()</span><br><span class="line">Q = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,N+<span class="number">1</span>):</span><br><span class="line">    arr.add(d)</span><br><span class="line"></span><br><span class="line">x = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(arr) != <span class="number">0</span>:</span><br><span class="line">    Q.add(x**<span class="number">2</span>)</span><br><span class="line">    delarr = []</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> arr:</span><br><span class="line">        <span class="keyword">if</span> x**<span class="number">2</span> - <span class="number">1</span> &gt; <span class="number">0</span> <span class="keyword">and</span> (x**<span class="number">2</span>-<span class="number">1</span>)%d == <span class="number">0</span> <span class="keyword">and</span> (x**<span class="number">2</span>-<span class="number">1</span>)//d <span class="keyword">in</span> Q:</span><br><span class="line">            <span class="built_in">print</span>(x,<span class="string">&quot;^2-&quot;</span>,d,<span class="string">&quot;*&quot;</span>,(x**<span class="number">2</span>-<span class="number">1</span>)//d,<span class="string">&quot;=1,leftcnt=&quot;</span>,<span class="built_in">len</span>(arr))</span><br><span class="line">            delarr.append(d)</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> delarr:</span><br><span class="line">        arr.remove(d)</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">2 ^2- 3 * 1 =1,leftcnt= 1000</span></span><br><span class="line"><span class="string">3 ^2- 2 * 4 =1,leftcnt= 999</span></span><br><span class="line"><span class="string">3 ^2- 8 * 1 =1,leftcnt= 999</span></span><br><span class="line"><span class="string">4 ^2- 15 * 1 =1,leftcnt= 997</span></span><br><span class="line"><span class="string">5 ^2- 6 * 4 =1,leftcnt= 996</span></span><br><span class="line"><span class="string">5 ^2- 24 * 1 =1,leftcnt= 996</span></span><br><span class="line"><span class="string">6 ^2- 35 * 1 =1,leftcnt= 994</span></span><br><span class="line"><span class="string">7 ^2- 12 * 4 =1,leftcnt= 993</span></span><br><span class="line"><span class="string">7 ^2- 48 * 1 =1,leftcnt= 993</span></span><br><span class="line"><span class="string">8 ^2- 7 * 9 =1,leftcnt= 991</span></span><br><span class="line"><span class="string">8 ^2- 63 * 1 =1,leftcnt= 991</span></span><br><span class="line"><span class="string">9 ^2- 5 * 16 =1,leftcnt= 989</span></span><br><span class="line"><span class="string">9 ^2- 20 * 4 =1,leftcnt= 989</span></span><br><span class="line"><span class="string">9 ^2- 80 * 1 =1,leftcnt= 989</span></span><br><span class="line"><span class="string">10 ^2- 11 * 9 =1,leftcnt= 986</span></span><br><span class="line"><span class="string">10 ^2- 99 * 1 =1,leftcnt= 986</span></span><br><span class="line"><span class="string">11 ^2- 30 * 4 =1,leftcnt= 984</span></span><br><span class="line"><span class="string">11 ^2- 120 * 1 =1,leftcnt= 984</span></span><br><span class="line"><span class="string">12 ^2- 143 * 1 =1,leftcnt= 982</span></span><br><span class="line"><span class="string">13 ^2- 42 * 4 =1,leftcnt= 981</span></span><br><span class="line"><span class="string">.....</span></span><br><span class="line"><span class="string">23915529 ^2- 365 * 1566993225616 =1,leftcnt= 291</span></span><br><span class="line"><span class="string">24220799 ^2- 284 * 2065658817600 =1,leftcnt= 290</span></span><br><span class="line"><span class="string">24220799 ^2- 639 * 918070585600 =1,leftcnt= 290</span></span><br><span class="line"><span class="string">24248647 ^2- 172 * 3418586519364 =1,leftcnt= 288</span></span><br><span class="line"><span class="string">24248647 ^2- 688 * 854646629841 =1,leftcnt= 288</span></span><br><span class="line"><span class="string">27365201 ^2- 666 * 1124405744400 =1,leftcnt= 286</span></span><br><span class="line"><span class="string">30580901 ^2- 550 * 1700348192676 =1,leftcnt= 285</span></span><br><span class="line"><span class="string">32080051 ^2- 106 * 9708770492100 =1,leftcnt= 284</span></span><br><span class="line"><span class="string">32080051 ^2- 424 * 2427192623025 =1,leftcnt= 284</span></span><br><span class="line"><span class="string">32080051 ^2- 954 * 1078752276900 =1,leftcnt= 284</span></span><br><span class="line"><span class="string">^CTraceback (most recent call last):</span></span><br><span class="line"><span class="string">  File &quot;./p066.py&quot;, line 13, in &lt;module&gt;</span></span><br><span class="line"><span class="string">    if x**2 - 1 &gt; 0 and (x**2-1)%d == 0 and (x**2-1)//d in Q:</span></span><br><span class="line"><span class="string">KeyboardInterrupt</span></span><br><span class="line"><span class="string">^C</span></span><br><span class="line"><span class="string">real	135m43.883s</span></span><br><span class="line"><span class="string">user	133m30.473s</span></span><br><span class="line"><span class="string">sys	0m20.102s</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>我给它掐断了,跑了两小时，虽然是单核的，但是还有284个数没算出来</p>
<h2 id="go并行-每个数各算各的"><a href="#go并行-每个数各算各的" class="headerlink" title="go并行 每个数各算各的"></a>go并行 每个数各算各的</h2><p>值过大,需要big&#x2F;int</p>
<p>写了一个可分段，可并行，可”断点”计算的</p>
<p>第一遍把1到1000直接跑，每次找到值都会输出剩余表</p>
<p>没统计计算时间，反正很久，每次运算的结果可以去替换slowv和ans</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// x*x-d*y*y=1</span></span><br><span class="line"><span class="comment">// 如果d包含质因子p</span></span><br><span class="line"><span class="comment">// x*x mod p = 1</span></span><br><span class="line"><span class="comment">// 所以 x mod p = 1 or p-1</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;math/big&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Xd <span class="keyword">struct</span> &#123;</span><br><span class="line">  X big.Int</span><br><span class="line">  d <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> prime [<span class="number">1010</span>]<span class="type">bool</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> offset = <span class="number">0</span></span><br><span class="line"><span class="keyword">const</span> VCNT = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> slowv = []<span class="type">int</span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否平方数 返回 &#123;开根,true&#125;或者&#123;0,false&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSqrt</span><span class="params">(x *big.Int)</span></span> (*big.Int, <span class="type">bool</span>) &#123;</span><br><span class="line">  xsqrt := big.NewInt(<span class="number">0</span>).Sqrt(x)</span><br><span class="line">  <span class="keyword">var</span> xx big.Int</span><br><span class="line">  xx.Mul(xsqrt, xsqrt)</span><br><span class="line">  <span class="keyword">if</span> xx.Cmp(x) == <span class="number">0</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> xsqrt, <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> big.NewInt(<span class="number">0</span>), <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对每个d尝试</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findx</span><span class="params">(d <span class="type">int</span>, ch <span class="keyword">chan</span> Xd)</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> _, ok := getSqrt(big.NewInt(<span class="type">int64</span>(d))); ok &#123;</span><br><span class="line">    ch &lt;- Xd&#123;*big.NewInt(<span class="number">0</span>), d&#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// d的最大质因子</span></span><br><span class="line">  maxp := <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= d; i++ &#123;</span><br><span class="line">    <span class="keyword">if</span> prime[i] &#123;</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> d%i == <span class="number">0</span> &amp;&amp; i &gt; maxp &#123;</span><br><span class="line">      maxp = i</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i := big.NewInt(<span class="number">1</span>); ; i.Add(i, big.NewInt(<span class="number">1</span>)) &#123;</span><br><span class="line">    imaxp := big.NewInt(<span class="number">0</span>).Mul(i, big.NewInt(<span class="type">int64</span>(maxp)))</span><br><span class="line">    sub1 := big.NewInt(<span class="number">0</span>).Sub(imaxp, big.NewInt(<span class="number">1</span>))</span><br><span class="line">    add1 := big.NewInt(<span class="number">0</span>).Add(imaxp, big.NewInt(<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">for</span> _, x := <span class="keyword">range</span> []*big.Int&#123;sub1, add1&#125; &#123;</span><br><span class="line">      <span class="comment">// x^2-1</span></span><br><span class="line">      x2s1 := big.NewInt(<span class="number">0</span>).Sub(big.NewInt(<span class="number">0</span>).Mul(x, x), big.NewInt(<span class="number">1</span>))</span><br><span class="line">      x2s1mod := big.NewInt(<span class="number">0</span>).Mod(x2s1, big.NewInt(<span class="type">int64</span>(d)))</span><br><span class="line">      <span class="keyword">if</span> x2s1mod.Cmp(big.NewInt(<span class="number">0</span>)) != <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">      &#125;</span><br><span class="line">      x2s1div := big.NewInt(<span class="number">0</span>).Div(x2s1, big.NewInt(<span class="type">int64</span>(d)))</span><br><span class="line">      <span class="keyword">if</span> _, ok := getSqrt(x2s1div); ok &#123;</span><br><span class="line">        ch &lt;- Xd&#123;*x, d&#125;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 结果处理</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">waitAns</span><span class="params">(ch <span class="keyword">chan</span> Xd, ans *Xd, wg *sync.WaitGroup)</span></span> &#123;</span><br><span class="line">  s := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]<span class="type">int</span>)</span><br><span class="line">  <span class="keyword">for</span> _,v := <span class="keyword">range</span> slowv&#123;</span><br><span class="line">    s[v]=<span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  cnt := <span class="number">0</span></span><br><span class="line">  fmt.Println(s, *ans, <span class="built_in">len</span>(s))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> v := <span class="keyword">range</span> ch &#123;</span><br><span class="line">    cnt++</span><br><span class="line">    <span class="built_in">delete</span>(s,v.d)</span><br><span class="line">    fmt.Println(s, *ans, <span class="built_in">len</span>(s))</span><br><span class="line">    <span class="keyword">if</span> v.X.Cmp(&amp;ans.X) == <span class="number">1</span> &#123;</span><br><span class="line">      *ans = v</span><br><span class="line">      <span class="comment">// fmt.Println(&quot;new&quot;,*ans, cnt)</span></span><br><span class="line">    &#125;</span><br><span class="line">    wg.Done()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">2</span>; i &lt; <span class="number">100</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">if</span> prime[i] &#123;</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> j := i * i; j &lt;= <span class="number">1000</span>; j += i &#123;</span><br><span class="line">      prime[j] = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ans := Xd&#123;*big.NewInt(<span class="number">0</span>), <span class="number">1</span>&#125;</span><br><span class="line">  <span class="comment">// 取消下面两行注释 从计算结果继续</span></span><br><span class="line">  <span class="comment">// slowv = []int&#123;739, 367, 547, 835, 457, 797, 766, 508, 931, 166, 937, 556, 989, 517, 926, 554, 834, 253, 796, 331, 976, 953, 883, 394, 977, 511, 199, 449, 661, 919, 571, 581, 814, 271, 805, 862, 277, 526, 653, 981, 664, 829, 749, 382, 956, 821, 412, 913, 596, 911, 871, 268, 941, 859, 967, 809, 214, 317, 298, 622, 974, 565, 997, 607, 649, 991, 751, 823, 358, 487, 679, 921, 501, 716, 826, 929, 853, 478, 586, 863, 309, 947, 569, 946, 778, 849, 481, 157, 553, 673, 301, 681, 244, 509, 523, 865, 754, 844, 433, 773, 634, 869, 753, 643, 669, 589, 790, 721, 614, 857, 685, 334, 521, 149, 709, 856, 694, 491, 971, 789, 549, 281, 757, 893, 907, 964, 313, 746, 454, 724, 463, 617, 109, 886, 337, 477, 489, 922, 637, 641, 877, 597, 211, 881, 409, 493, 631, 593, 599, 397, 889, 838, 610, 970, 801, 949, 628, 928, 436, 181, 719, 811, 613, 538, 604, 421, 958, 619, 972, 379, 772, 241, 769, 541, 193, 686, 601, 691, 764, 988, 652, 353, 461, 61, 787, 718,&#125;</span></span><br><span class="line">  <span class="comment">// ans := Xd&#123;*big.NewInt(3832352837), 502&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line">  ch := <span class="built_in">make</span>(<span class="keyword">chan</span> Xd)</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(slowv) == <span class="number">0</span>&#123;</span><br><span class="line">    <span class="comment">// 第一遍的时候 lowv 为空 用这个代码</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>+offset; i &lt;= VCNT+offset; i++ &#123;</span><br><span class="line">      slowv = <span class="built_in">append</span>(slowv, i)</span><br><span class="line">      wg.Add(<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">go</span> findx(i, ch)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> _,v := <span class="keyword">range</span> slowv&#123;</span><br><span class="line">      wg.Add(<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">go</span> findx(v,ch)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">go</span> waitAns(ch, &amp;ans, &amp;wg)</span><br><span class="line">  wg.Wait()</span><br><span class="line">  fmt.Println(ans)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>这时就体现出当数学家可以推出结论，而计算机拥有的只是“蛮力”。</p>
<h2 id="pell方程的解"><a href="#pell方程的解" class="headerlink" title="pell方程的解"></a>pell方程的解</h2><h3 id="解的性质-基础解"><a href="#解的性质-基础解" class="headerlink" title="解的性质(基础解)"></a>解的性质(基础解)</h3><h4 id="平方一个解相关的表达式能得到新的解-多余"><a href="#平方一个解相关的表达式能得到新的解-多余" class="headerlink" title="平方一个解相关的表达式能得到新的解(多余)"></a>平方一个解相关的表达式能得到新的解(多余)</h4><p>如果$x^2-d \cdot y^2&#x3D;1$ 平方得 $x^4+d^2 \cdot y^4-2dx^2y^2&#x3D;1$</p>
<p>$x^4+2dx^2y^2+d^2 \cdot y^4-d \cdot 4x^2y^2&#x3D;1$</p>
<p>$(x^2+dy^2)^2 - d \cdot (2xy)^2&#x3D;1$</p>
<p>即当我们有一个解时，通过平方能得到新的解</p>
<h4 id="一个解相关的表达式的整幂次能得到新的解-多余"><a href="#一个解相关的表达式的整幂次能得到新的解-多余" class="headerlink" title="一个解相关的表达式的整幂次能得到新的解(多余)"></a>一个解相关的表达式的整幂次能得到新的解(多余)</h4><p>又$(x+\sqrt{d} \cdot y)\cdot (x-\sqrt{d} \cdot y)&#x3D;1$</p>
<p>可得$((x+\sqrt{d} \cdot y)\cdot (x-\sqrt{d} \cdot y))^n&#x3D;1$</p>
<p>$(x+\sqrt{d} \cdot y)^n\cdot (x-\sqrt{d} \cdot y)^n&#x3D;1$</p>
<p>根据二项式展开有</p>
<p>若 $(x+\sqrt{d} \cdot y)^n &#x3D; A + B\cdot{d}$</p>
<p>则 $(x-\sqrt{d} \cdot y)^n &#x3D; A - B\cdot{d}$ 即是 $A^2-d \cdot B^2&#x3D;1$</p>
<p>也就是它的n次方展开的系数也是一组解</p>
<h4 id="任意两个解相关的表达式的乘积能得到新的解-该结论包含上述两个结论"><a href="#任意两个解相关的表达式的乘积能得到新的解-该结论包含上述两个结论" class="headerlink" title="任意两个解相关的表达式的乘积能得到新的解(该结论包含上述两个结论)"></a>任意两个解相关的表达式的乘积能得到新的解(该结论包含上述两个结论)</h4><blockquote>
<p>同样,假设有两组解：(x1,y1)和(x2,y2)的，它们也可以通过上述乘积方法，合成一组新的解</p>
</blockquote>
<h4 id="存在一个基础解-最小解-，所有解都是由基础解生成的"><a href="#存在一个基础解-最小解-，所有解都是由基础解生成的" class="headerlink" title="存在一个基础解(最小解)，所有解都是由基础解生成的"></a>存在一个基础解(最小解)，所有解都是由基础解生成的</h4><p><strong>下面证明所有解都是最小解生成的</strong></p>
<p>因为y越大x越大,设$(x_1,y_1)$为最小解,$(x_k,y_k)$不是由最小解上述幂次方法生成的一个解</p>
<p>根据y越大x越大的性质，则存在一个整数n</p>
<p>$(x_1+y_1 \cdot \sqrt{d})^n &lt; (x_k+y_k \cdot \sqrt{d}) &lt; (x_1+y_1 \cdot \sqrt{d})^{n+1} $</p>
<p>同时乘$(x_1-y_1 \cdot \sqrt{d})^n$有</p>
<p>$1 &lt; (x_k+y_k \cdot \sqrt{d}) \cdot (x_1-y_1 \cdot \sqrt{d})^n &lt; (x_1+y_1 \cdot \sqrt{d}) $</p>
<p>注意到中间的表达式 也是满足参数形式的 也是一组解(并且因为$\frac{x_1}{y_1} &#x3D; \sqrt{\frac{1}{y_1^2}+d} &gt; \sqrt{\frac{1}{y_k^2}+d} &#x3D; \frac{x_k}{y_k}$,所以参数均为正数 )</p>
<p>这与最小解定义冲突，所以所有解都是最小解生成的</p>
<h3 id="解的存在性证明"><a href="#解的存在性证明" class="headerlink" title="解的存在性证明"></a>解的存在性证明</h3><h4 id="引理1，无穷多对整数满足给定不等式"><a href="#引理1，无穷多对整数满足给定不等式" class="headerlink" title="引理1，无穷多对整数满足给定不等式"></a>引理1，无穷多对整数满足给定不等式</h4><p>存在无穷多对整数(x,y)满足 $|x-y\sqrt{d}|&lt;\frac 1y$</p>
<p>取正整数$q_0 &gt; 1$</p>
<p>取$t&#x3D;1,…,q_0+1$ 共计$q_0+1$个</p>
<p>把区间$[0,1)$等分为$q_0$部分，则每部分长度为$\frac 1{q_0}$,考虑 $t \sqrt{d}$的小数部分(t为整数)，必定有两个落在同一区间 所以存在$0\leq i&lt;j\leq q_0$使得 $| \{t_i \sqrt{d}\} - \{t_j \sqrt{d}\} | &lt;\frac 1{q_0}$</p>
<p>即$|x-(t_j-t_i)\sqrt{d}| &#x3D;  | \{t_i \sqrt{d}\} - \{ t_j \sqrt{d}\} | &lt; \frac 1{q_0} \leq  \frac 1{t_j-t_i}$</p>
<p>这里要注意的是我们知道i&lt;j,和它们的小数部分落在同一个区间，所以这里应该是它们的小数部分相减的绝对值，而不是相减的绝对值的小数部分，例如q取2, 一个取0.4,一个1.3,它们都在[0,0.5)的区间里，但是如果$|1.3-0.4|$ 再取绝对值的小数部分，得到的是0.9而不是0.1,对于x来说，只要增减1就能在最终的值上切换成功.</p>
<p>把$t_j-t_i$ 看作y得到一个解</p>
<p>取$\frac 1{q_1} &lt; |x-(t_j-t_i)\sqrt{d}|$</p>
<p>可以得到新的解(因为同一个y最多有两种 $|x-y\sqrt{d}|$的小数部分，反复如此可生成无限个解</p>
<p>取$|x_3-y_3\sqrt{d}| &lt;\frac 1{q_3} &lt; |x_2-y_2 \sqrt{d}| &lt; \frac 1{q_2} &lt; |x_1-y_1\sqrt{d}| &lt;\frac 1{q_1} &lt; |x_0-y_0 \sqrt{d}| &lt; \frac 1{q_0} $</p>
<h4 id="基于引理1-配出pell方程的解"><a href="#基于引理1-配出pell方程的解" class="headerlink" title="基于引理1,配出pell方程的解"></a>基于引理1,配出pell方程的解</h4><p>对于这无限个解</p>
<p>0 &lt; $\left|x^2-dy^2\right|&#x3D;\left|x+y\sqrt{d}\right|\cdot\left|x-y\sqrt{d}\right|&#x3D;\left|x-y\sqrt{d}+2y\sqrt{d}\right|\cdot\left|x-y\sqrt{d}\right|\leq (\left|x-y\sqrt{d}\right|+\left|2y\sqrt{d}\right|)\cdot\left|x-y\sqrt{d}\right|&lt;\left(2y\sqrt{d}+\frac{1}{y}\right)\cdot\frac{1}{y}\le 2\sqrt{d}+\frac 1{y^2}$</p>
<p>说明这无限个(x,y)的取值,对$|x^2-dy^2|$的计算结果是有限范围内的整数</p>
<p>再一次根据抽屉原理，存在正整数k,使得$|x^2-dy^2|&#x3D;k$的解有无限个</p>
<p>考虑这些解$(x \bmod k,y \bmod k)$ , 可以的方案数$\leq k^2$,也是有限的，</p>
<p>再根据抽屉原理，存在$(M_x,M_y)$，使得无限个i， $s.t. (x_i \bmod k, y_i \bmod k) &#x3D; (M_x,M_y)$,在这无限组中取两组$(x_1,y_1),(x_2,y_2)$</p>
<p>令 $X&#x3D;|\frac{x_1x_2-y_1y_2d}{k}|,Y&#x3D;|\frac{x_2y_1-x_1y_2}{k}|$</p>
<p>有 $X^2-d \cdot Y^2 &#x3D; \frac{(x_1^2-d \cdot y_1^2)(x_2^2-d \cdot y_2^2)}{k^2} &#x3D; 1$</p>
<p>因为 $(x_2y_1-x_1y_2)\bmod k &#x3D; (x_1y_1-x_1y_1) \bmod k &#x3D; 0 \bmod k &#x3D; 0$,所以Y是整数</p>
<p>因为$X$是有理数且满足pell方程，所以它是整数</p>
<p>显然$X &#x3D; \sqrt{1+dY^2}$ 不为0</p>
<p>注意到 $x^2-dy^2$ 的取值范围为 $\pm k$ (有限个 ，2个)，但可取的$(x,y)$有无限对，再一次抽屉原理,因此存在$(x_i,y_i)\neq(x_j,y_j)$使得 $x_i^2-dy_i^2&#x3D;x_j^2-dy_j^2$ 这时 $\frac{x_i}{y_i} \neq \frac{x_j}{y_j}$ (否则代入前式子得到$x_i&#x3D;x_j$), 即Y不为0,Y为正整数</p>
<p>综上，一定存在解</p>
<h4 id="pell方程性质小结"><a href="#pell方程性质小结" class="headerlink" title="pell方程性质小结"></a>pell方程性质小结</h4><p>关于 pell方程 ，我们现在有了 一定存在解，且存在一个最小解的基础解，两个结论，下面开始看看连分数。</p>
<h2 id="连分数"><a href="#连分数" class="headerlink" title="连分数"></a>连分数</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>形如</p>
<p>$\alpha &#x3D; a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \cfrac{1}{\ddots,}}}} $</p>
<p>例如 </p>
<p>$ \sqrt{2} &#x3D; 1 + \frac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \ddots}}}}}} $</p>
<p>展开的剩余部分是在<code>[0,1)</code>之间</p>
<h3 id="性质1-所有无限连分数都是无理数。"><a href="#性质1-所有无限连分数都是无理数。" class="headerlink" title="性质1 所有无限连分数都是无理数。"></a>性质1 所有无限连分数都是无理数。</h3><p>证明：如果一个数是有理数，把它写成分数的形式，再按照连分数的方式展开，你会发现这过程就是辗转相除，分子分母单调递减 所以一定有限，它的逆否命题就是要证明的性质</p>
<h3 id="渐进分数-分子，分母等性质"><a href="#渐进分数-分子，分母等性质" class="headerlink" title="渐进分数(分子，分母等性质)"></a>渐进分数(分子，分母等性质)</h3><h4 id="分子分母递推式"><a href="#分子分母递推式" class="headerlink" title="分子分母递推式"></a>分子分母递推式</h4><p>渐进分数，把上述表示无理数$\alpha$的连分数部分截断所得到的分数</p>
<p>假设h,k分别为渐进分数的分子和分母,根据简化为分数的过程</p>
<p>$\begin{bmatrix} h_n &amp; k_n \end{bmatrix} &#x3D; \begin{bmatrix} 1 &amp; 0 \end{bmatrix} \cdot \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdots \begin{bmatrix} a_0 &amp; 1 \\ 1 &amp; 0 \end{bmatrix} $</p>
<p>然而这不好建立递推关系,稍做变形</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ ? &amp; ? \end{bmatrix} &#x3D; \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix} \cdot \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdots \begin{bmatrix} a_0 &amp; 1 \\ 1 &amp; 0 \end{bmatrix} $</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ ? &amp; ? \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} a_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdots \begin{bmatrix} a_0 &amp; 1 \\ 1 &amp; 0 \end{bmatrix} $</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ ? &amp; ? \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} &amp; k_{n-1} \\ ? &amp; ? \end{bmatrix} $</p>
<p>显然左式的底部可以确定</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ h_{n-1} &amp; k_{n-1} \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} &amp; k_{n-1} \\ ? &amp; ? \end{bmatrix} $</p>
<p>又因为递推关系，右边式子相当于左式带入n-1</p>
<p>$\begin{bmatrix} h_n &amp; k_n \\ h_{n-1} &amp; k_{n-1} \end{bmatrix} &#x3D; \begin{bmatrix} a_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix}  \cdot \begin{bmatrix} h_{n-1} &amp; k_{n-1} \\ h_{n-2} &amp; k_{n-2} \end{bmatrix} $</p>
<p>综上</p>
<p>$h_n &#x3D; a_n \cdot h_{n-1} + h_{n-2}$<br>$k_n &#x3D; a_n \cdot k_{n-1} + k_{n-2}$</p>
<p>渐进值 $\frac{h_n}{k_n} &#x3D; \frac{a_n \cdot h_{n-1} + h_{n-2}}{a_n \cdot k_{n-1} + k_{n-2}}$</p>
<p>且根据计算过程，可知 $h_n,k_n$互质</p>
<h4 id="分子分母-相关等式"><a href="#分子分母-相关等式" class="headerlink" title="分子分母 相关等式"></a>分子分母 相关等式</h4><p>由上面的递推关系再递推有</p>
<p>$k_nh_{n-1}-k_{n-1}h_n&#x3D;-(k_{n-1}h_{n-2}-k_{n-2}h_{n-1})&#x3D;(-1)^n $, </p>
<p>$k_nh_{n-2}-k_{n-2}h_n&#x3D;a_n(k_{n-1}h_{n-2}-k_{n-2}h_{n-1})&#x3D;a_n(-1)^{n-1} $, </p>
<p>设无理数$\alpha$ 的精确表示为$[a_0,a_1,…,a_n,x_{n+1}]$,即是最后$a_{n+1}$替换为精确的非整数值$x_{n+1}$,有$1\leq a_{n+1}&lt;x_{n+1}&lt;a_{n+1}+1,(n&gt;&#x3D;1)$</p>
<h4 id="原无理数与渐进数的差值表达式"><a href="#原无理数与渐进数的差值表达式" class="headerlink" title="原无理数与渐进数的差值表达式"></a>原无理数与渐进数的差值表达式</h4><p>根据上方计算渐进值得到的公式，同理递推式有</p>
<p>$\alpha &#x3D;\frac{x_{n+1}h_n+h_{n-1}}{x_{n+1}k_n+k_{n-1}}  $</p>
<p>$\alpha - \frac{h_n}{k_n} &#x3D;\frac{x_{n+1}h_n+h_{n-1}}{x_{n+1}k_n+k_{n-1}} -\frac{h_n}{k_n} $</p>
<p>$&#x3D;\frac{h_{n-1}k_{n}-h_nk_{n-1}}{k_n(x_{n+1}k_n+k_{n-1})}$</p>
<p>$&#x3D;\frac{(-1)^n}{k_n(x_{n+1}k_n+k_{n-1})}$</p>
<p>$|\alpha -\frac{h_n}{k_n}| &#x3D;\frac{1}{k_n(x_{n+1}k_n+k_{n-1})} &lt; \frac{1}{k_n(a_{n+1}k_n+k_{n-1})} &#x3D; \frac{1}{k_nk_{n+1}}$</p>
<p>注意到k的递推式，容易发现它是单调递增的正整数,所以渐进分数真的是趋近(n趋于无限大，渐进分数趋进原无理数)</p>
<h4 id="原无理数与渐进数的差值绝对值单调递减"><a href="#原无理数与渐进数的差值绝对值单调递减" class="headerlink" title="原无理数与渐进数的差值绝对值单调递减"></a>原无理数与渐进数的差值绝对值单调递减</h4><p>$|k_n\alpha - h_n|$单调递减。</p>
<p>证明:</p>
<p>$|k_n\alpha - h_n| - |k_{n-1}\alpha - h_{n-1}|$</p>
<p>$ &#x3D; |k_n(\alpha - \frac{h_n}{k_n})| - |k_{n-1}(\alpha - \frac{h_{n-1}}{k_{n-1}})|$</p>
<p>$ &#x3D; \frac 1{x_{n+1}k_n+k_{n-1}} - \frac 1{x_{n}k_{n-1}+k_{n-2}} $</p>
<p>$ &#x3D; \frac {(x_{n}k_{n-1}+k_{n-2})-(x_{n+1}k_n+k_{n-1})}{(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {((a_n+\frac 1{x_{n+1}})k_{n-1}+k_{n-2})-(x_{n+1}k_n+k_{n-1})}{(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {(x_{n+1}(a_nk_{n-1}+k_{n-2})+k_{n-1})-x_{n+1}(x_{n+1}k_n+k_{n-1})}{x_{n+1}(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {(x_{n+1}k_n+k_{n-1})-x_{n+1}(x_{n+1}k_n+k_{n-1})}{x_{n+1}(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})}$</p>
<p>$ &#x3D; \frac {(1-x_{n+1})(x_{n+1}k_n+k_{n-1})}{x_{n+1}(x_{n+1}k_n+k_{n-1})(x_{n}k_{n-1}+k_{n-2})} &lt; 0$</p>
<hr>
<p>由此也可知$|\alpha - \frac{h_n}{k_n}|$单调递减</p>
<p>$|\alpha - \frac{h_n}{k_n}|-|\alpha -\frac{h_{n-1}}{k_{n-1}}|$</p>
<p>$&#x3D;\frac {|{k_n}\alpha-{h_n}|-\frac {k_n}{k_{n-1}}|{k_{n-1}}\alpha-{h_{n-1}}|}{k_n}$</p>
<p>$&lt;\frac {|{k_n}\alpha-{h_n}|-|{k_{n-1}}\alpha-{h_{n-1}}|}{k_n} &lt; 0$</p>
<p>&#x2F;&#x2F; 或者因为$k_n$单调递增</p>
<h4 id="和渐进数同分母的所有分数中，渐进数最接近原无理数"><a href="#和渐进数同分母的所有分数中，渐进数最接近原无理数" class="headerlink" title="和渐进数同分母的所有分数中，渐进数最接近原无理数"></a>和渐进数同分母的所有分数中，渐进数最接近原无理数</h4><p>若$(h_n,k_n)$是一个渐进分数，则对于分母$k_n$,分子取$h_n$时，整个分数最接近原无理数</p>
<p>取任意$h\neq h_n$,根据三角不等式</p>
<p>$|\alpha -\frac{h}{k_n}| \geq |\frac{h-h_n}{k_n}| - |\alpha - \frac{h_n}{k_n}|$</p>
<p>$&gt;\frac 1{k_n} - \frac 1{k_nk_{n+1}} $,因为n足够大 $k_{n+1}&gt;&#x3D;3$有</p>
<p>$&gt; \frac 1{k_n} - \frac 1{2k_n} $</p>
<p>$&#x3D;\frac 1{2k_n} $</p>
<p>$&gt;  \frac 1{k_nk_{n+1}} &gt; |\alpha -\frac{h_n}{k_n}|$</p>
<p>证明了$h_n$是最接近的分子</p>
<p>即 $|k_n\alpha - h|$在 $h&#x3D;h_n$时取最小值</p>
<h4 id="分母小于等于渐进数的分母的所有分数中，渐进数能使-分子x原无理数-分母-取最小值"><a href="#分母小于等于渐进数的分母的所有分数中，渐进数能使-分子x原无理数-分母-取最小值" class="headerlink" title="分母小于等于渐进数的分母的所有分数中，渐进数能使|分子x原无理数-分母|取最小值"></a>分母小于等于渐进数的分母的所有分数中，渐进数能使|分子x原无理数-分母|取最小值</h4><p>下面证明在$(0&lt;k\leq k_n)$中，对于所有$(h,k)$，有$|k_n\alpha -  h_n|$为最小值</p>
<p>考虑任意$(h,k),(0&lt;k&lt;k_n)$，且$\frac hk$的最简分数不是渐进数，（因为已经证明了渐进数随着n增大$|k\alpha - h|$单调递减，且渐进数分子分母互质，所以如果最简分数是渐进数则对应渐进数的该表达式 更大，又是分子分母是渐进数的倍数，则该表达式的结果还要乘上倍数会更大）</p>
<p>&#x2F;&#x2F; 同时它是最简分数，因为上表达式 带入分数和其最简分数得到的值刚好是其分子和其最简分数的分子的比值的倍数</p>
<p>设二元一次方程组</p>
<p>$h_nx+h_{n-1}y&#x3D;h$</p>
<p>$k_nx+k_{n-1}y&#x3D;k$</p>
<p>则有$(x,y)&#x3D;(\frac {hk_{n-1}-kh_{n-1}}{h_nk_{n-1}-h_{n-1}k_n},\frac {hk_{n}-kh_{n}}{h_nk_{n-1}-h_{n-1}k_n}) &#x3D; ((-1)^{n-1}(hk_{n-1}-kh_{n-1}),(-1)^{n-1}(hk_{n}-kh_{n}))$</p>
<p>因为$\frac hk$不是渐进分数，所以$x,y$都是非零整数，又因为$k&lt;k_n$和$k_nx+k_{n-1}y&#x3D;k$有:$x,y$异号</p>
<p>因为$\alpha - \frac {h_n}{k_n}$的分子为$(-1)^n$,分母为正数,</p>
<p>因此$\alpha - \frac {h_n}{k_n}$和$\alpha - \frac {h_{n-1}}{k_{n-1}}$异号</p>
<p>$k_n\alpha - {h_n}$和$k_{n-1}\alpha - {h_{n-1}}$异号</p>
<p>$x(k_n\alpha - {h_n})$和$y(k_{n-1}\alpha - {h_{n-1}})$同号</p>
<p>$|k\alpha -h| &#x3D; |(k_nx+k_{n-1}y)\alpha - (h_nx+h_{n-1}y)|$</p>
<p>$&#x3D; |x(k_n\alpha - {h_n}) + y(k_{n-1}\alpha - {h_{n-1}})|$,因为同号：</p>
<p>$&#x3D; |x(k_n\alpha - {h_n})|+|y(k_{n-1}\alpha - {h_{n-1}})|$，因为$x,y$非零整数:</p>
<p>$|k\alpha - h| &gt; |k_n\alpha - {h_n}|$且$|k\alpha -h|&gt;|k_{n-1}\alpha - {h_{n-1}}|$</p>
<p>内容得证</p>
<h4 id="连续的两个渐进数中至少有一个满足pell方程必要的不等式"><a href="#连续的两个渐进数中至少有一个满足pell方程必要的不等式" class="headerlink" title="连续的两个渐进数中至少有一个满足pell方程必要的不等式"></a>连续的两个渐进数中至少有一个满足pell方程必要的不等式</h4><p>至于为什么是这个标题 见后面的部分</p>
<p>连续的两个渐进数中至少有一个满足，$|\alpha - \frac hk|&lt;\frac 1{2k^2}$</p>
<p>证明:</p>
<p>假设都不满足，有</p>
<p>$0 \leq |\alpha-\frac{h_{n+1}}{k_{n+1}}| - \frac{1}{2k_{n+1}^2} + |\alpha-\frac{h_{n}}{k_{n}}|-\frac{1}{2k_{n}^2}$, 因为$\alpha - \frac{h_{n}}{k_{n}}$正负交替,所以</p>
<p>$ &#x3D; |\frac{h_{n+1}}{k_{n+1}}-\frac{h_{n}}{k_{n}}|-\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; |\frac{h_{n+1}k_{n}-h_{n}k_{n+1}}{k_{n+1}k_{n}}|-\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; \frac 1{k_nk_{n+1}} -\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; \frac 1{k_nk_{n+1}} -\frac 1{2k_{n+1}^2} -\frac 1{2k_{n}^2}$</p>
<p>$ &#x3D; \frac {-(k_n-k_{n+1})^2}{2k_{n}^2k_{n+1}^2} &lt; 0$</p>
<p>矛盾</p>
<p>因此至少有一个大于满足 得证</p>
<h4 id="任何最简分数如果满足pell方程必要的不等式，那么它是一个渐进分数"><a href="#任何最简分数如果满足pell方程必要的不等式，那么它是一个渐进分数" class="headerlink" title="任何最简分数如果满足pell方程必要的不等式，那么它是一个渐进分数"></a>任何最简分数如果满足pell方程必要的不等式，那么它是一个渐进分数</h4><p>任何最简分数如果满足$|\alpha - \frac hk|&lt;\frac 1{2k^2}$，那么它是个渐进分数</p>
<p>证明</p>
<p>设$\frac hk$满足不等式$|\alpha - \frac hk|&lt;\frac 1{2k^2}$，则存在n使得渐进数分母满足 $k_{n+2}&gt;k&gt;&#x3D;k_n $且$\frac {h_n}{k_n}$满足$|\alpha - \frac hk|&lt;\frac 1{2k^2}$(因为相邻渐进数必有一个满足,这里是取n和n+2之间)，根据上面的不等式 有$|k_n\alpha- h_n| &lt; |k\alpha - h|$，若$\frac hk \neq \frac{h_n}{k_n}$,即$k_n &lt; k$</p>
<p>$0 \leq \frac{|hk_n-h_nk|-1}{kk_n}$</p>
<p>$&#x3D; |\frac{h}{k}-\frac{h_n}{k_n}|-\frac{1}{kk_n}$,因为三角不等式，有</p>
<p>$\leq |\alpha -\frac{h}{k}|+|\alpha -\frac{h_n}{k_n}|-\frac{1}{kk_n}$, 因为假设满足的不等式</p>
<p>$&lt; \frac 1{2k^2} + \frac 1{k_n}|k_n\alpha - h_n|-\frac{1}{kk_n}$,因为上面的最小接近</p>
<p>$&lt; \frac 1{2k^2} + \frac 1{k_n}|k\alpha - h|-\frac{1}{kk_n}$</p>
<p>$&#x3D; \frac 1{2k^2} + \frac {k}{k_n}|\alpha - \frac hk|-\frac{1}{kk_n}$因为假设满足的不等式</p>
<p>$&lt; \frac 1{2k^2} + \frac {k}{k_n}\cdot \frac 1{2k^2}-\frac{1}{kk_n}$</p>
<p>$&#x3D; \frac {k_n-k}{2k^2k_n} &lt; 0$</p>
<p>矛盾，因此$\frac hk$和某个渐进数相等</p>
<p><strong>注记：最开始该文的版本，的渐进分数的部分直接使用的是pell方程中$\sqrt{d}$,其中d是非平方正整数，但为了写100需要的证明，需要把它扩充到实数，（当然也是成立的），所以这部分改写了一次</strong></p>
<h3 id="Lagrange’s-Theorem-二次无理数与有循环节的连分数"><a href="#Lagrange’s-Theorem-二次无理数与有循环节的连分数" class="headerlink" title="Lagrange’s Theorem 二次无理数与有循环节的连分数"></a>Lagrange’s Theorem 二次无理数与有循环节的连分数</h3><p>quadratic irrational(二次无理数) : 二次整式多项式的根 $\frac{-b\pm \sqrt{b^2-4ac}}{2a}$ 或者形如$\frac{P+\sqrt{D}}{Q}$</p>
<p> An irrational number is quadratic irrational if and only if its continued fraction is periodic.</p>
<h4 id="循环连分数一定是二次无理数"><a href="#循环连分数一定是二次无理数" class="headerlink" title="循环连分数一定是二次无理数"></a>循环连分数一定是二次无理数</h4><blockquote>
<p>先证明简单的一侧，循环连分数一定是二次根式的根。</p>
</blockquote>
<p>按照连分数的写法，将循环节设为t</p>
<p>显然还原为分数,有$x&#x3D;\frac{a t + b}{c t +d},t &#x3D; \frac{et+f}{gt+h}$ 变换左表达式t是x的函数，带入右侧表达式得到$\frac{ix+j}{kx+l} &#x3D; \frac{mx+n}{ox+p}$,其中字母$a-p$均为整数，且注意到x为无理数，所以化简后一定是二次方程</p>
<h4 id="二次无理数一定是循环连分数"><a href="#二次无理数一定是循环连分数" class="headerlink" title="二次无理数一定是循环连分数"></a>二次无理数一定是循环连分数</h4><blockquote>
<p>再证明二次根式的根一定能表达为有循环节的连分数</p>
</blockquote>
<p>定义,u对于无理数x</p>
<p>$f(x) &#x3D; x-1 (x&gt;1)$</p>
<p>$f(x) &#x3D; \frac{1}{\frac{1}{x}-1} , (x&lt;1)$</p>
<p>对应到连分展开，即是将首个数字减少1,(x&gt;1时就是a0减去1,x&lt;1时就是a1减去1)</p>
<p>令$x1&#x3D;x,x_{n+1}&#x3D;f(x_n)$,可以知道 这是一个无限数列</p>
<p>如果x满足$ax^2+bx+c&#x3D;0$,写作$x\in[a,b,c]$</p>
<p>那么x-1 满足$a(x-1)^2+(2a+b)(x-1)+(a+b+c) &#x3D; ax^2+b+c&#x3D;0$</p>
<p>那么$\frac{x}{1-x}$ 满足$(a+b+c)(\frac{x}{1-x})^2+(b+2c)\frac{x}{1-x}+c &#x3D; 0$</p>
<p>所以f(x)满足 $f(x)\in [a,2a+b,a+b+c]$ 或 $f(x)\in [a+b+c,b+2c,c]$</p>
<p>不失一般性，写作$x_n\in[s_n,t_n,u_n]$,有 $s_n &gt; 0$, 否则把三元组同时换号</p>
<p>注意到上式 $(2a+b)^2-4a(a+b+c)&#x3D;b^2-4ac&#x3D;(b+2c)^2-4(a+b+c)c$</p>
<p>说明了 $t_n^2-4s_nu_n$是和n无关的值</p>
<p>如果只有有限个$u&lt;0$,那么从某一处开始，$s&gt;0,u&gt;0$且$t&lt;0$(因为 x &gt; 0)</p>
<p>那么意味着 $-t$ 严格单调递减并且非负，(因为 t的变化关系是 t&#x3D;2s+t或者 t&#x3D;t+2u),矛盾</p>
<p>所以有无限个$s_nu_n&lt;0$</p>
<p>注意到 $t_n^2-4s_nu_n$是常数，所以 至少有一个三元组$[s_n,t_n,u_n]$ 出现了三次,一个二次方程有两个解，所以有满足的$x_n&#x3D;x_m,m&gt;n$</p>
<p>得证 连分数展开有循环</p>
<p>Theorem 1. If x is a positive quadratic irrational then its continued fraction is eventually periodic.</p>
<h3 id="Galois’-Theorem-纯循环连分数与reduced二次无理数"><a href="#Galois’-Theorem-纯循环连分数与reduced二次无理数" class="headerlink" title="Galois’ Theorem 纯循环连分数与reduced二次无理数"></a>Galois’ Theorem 纯循环连分数与reduced二次无理数</h3><p>Definition 1.24. x 是二次无理数的根，$\overline{x}$ 是另一个根，那么如果 x &gt; 1 且 $-1 &lt; \overline{x} &lt; 0$.那么称 x 为 reduced</p>
<p>Theorem 1.25. (Galois’ Theorem) 无理数a. a是纯循环连分数（从a0开始的循环节），当且仅当 x is reduced. If $x &#x3D; [\overline{a_0, a_1, a_2, . . . , a_{l−1}}]$ and $\overline{x}$ 是它共轭实数, then $-\frac{1}{x} &#x3D; [\overline{a_{l−1}, . . . , a_2, a_1}].$</p>
<h4 id="reduced二次无理数-是-纯循环连分数"><a href="#reduced二次无理数-是-纯循环连分数" class="headerlink" title="reduced二次无理数 是 纯循环连分数"></a>reduced二次无理数 是 纯循环连分数</h4><p>设二次无理数$x&#x3D;[a_0,a_1,…,a_n], x&gt;1,-1&lt;\overline{x}&lt;0$</p>
<p>那么有 $x_{n+1}&#x3D;\frac{1}{x_n-a_n}$ &#x2F;&#x2F; 表示 按照展开从n处向后取值</p>
<p>$\overline{x_{n+1}} &#x3D; \frac{1}{\overline{x_n-a_n}} &#x3D; \frac{1}{\overline{x_n}-a_n}$,(因为 两个形如$A+B\sqrt{C}$的无理数相乘为有理数，说明相乘后的无理数的系数为0,所以更改其中一个无理数的系数的正负，另一个无理数系数的正负更改即可)</p>
<p>注意到$x_1 \ge 1$有$a_0 \ge 1$,所以 $a_n \ge 1$</p>
<p>下面归纳证明 $-1 &lt; \overline{x_n} &lt; 0 $</p>
<p>若 $-1 &lt; \overline{x_n} &lt; 0$</p>
<p>有 $\frac{1}{\overline{x_{n+1}}} &#x3D; \overline{x_n} - a_n &lt; -1$</p>
<p>即 $-1 &lt; \overline{x_{n+1}} &lt; 0$，得证</p>
<p>$-1 &lt; \overline{x_n} &#x3D; \frac{1}{\overline{x_{n+1}}}+a_n &lt; 0$</p>
<p>$ 1 &gt; -\frac{1}{\overline{x_{n+1}}}-a_n &gt; 0$</p>
<p>$ a_n &#x3D; [ -\frac{1}{\overline{x_{n+1}}} ] $ &#x2F;&#x2F; 也就是$a_n$等于分式的整数部分</p>
<p>因为上面已经证明 如果是二次无理数，那么必定有循环节，所以存在$x_i &#x3D; x_j,(i &lt; j )$</p>
<p>即$\overline{x_i}&#x3D;\overline{x_j}$</p>
<p>即$a_{i-1}&#x3D;[-\frac{1}{\overline{x_i}}]&#x3D;[-\frac{1}{\overline{x_j}}] &#x3D; a_{j-1}$</p>
<p>即$x_{i-1}&#x3D;a_{i-1}+\frac{1}{x_i} &#x3D; a_{j-1}+\frac{1}{x_j} &#x3D; x_{j-1}$, 意义就是如果两个后缀相等，那么它们各向前一个 也相等，综上逐步迭代$a_0 &#x3D;a_{j-i}$ </p>
<p>因此证明了 如果一个二次无理数是 reduced，那么它是个纯循环连分数</p>
<h4 id="纯循环连分数-是-reduced"><a href="#纯循环连分数-是-reduced" class="headerlink" title="纯循环连分数 是 reduced"></a>纯循环连分数 是 reduced</h4><p>首先有循环节的连分数一定是二次无理数（上面证过了)</p>
<p>因为是纯循环，所以$a_0 \ge 1$,所以$a_n \ge 1$,有$x &gt; 1$</p>
<p>假设周期为n, 有 $x_n &#x3D; x &#x3D; [\overline{a_0,a_1,…,a_{n-1}}]$</p>
<p>根据上面推过的递推式 $x &#x3D; \frac{x_nh_{n-1}+h_{n-2}}{x_nk_{n-1}+k_{n-2}} &#x3D; \frac{xh_{n-1}+h_{n-2}}{xk_{n-1}+k_{n-2}}$</p>
<p>化简 $k_{n-1}x^2+(k_{n-2}-h_{n-1})x-h_{n-2}&#x3D;0$</p>
<p>也就是证明这个方程除了x (我们已经有 $x&gt;1$了)的另一个根$\overline{x}$满足$-1 &lt; \overline{x} &lt; 0$</p>
<p>$x &#x3D; 0$时 原式子 $&#x3D;-h_{n-2} &lt; 0$</p>
<p>$x &#x3D; 1$时 原式子 </p>
<p>$&#x3D; k_{n-1}+(h_{n-1}-k_{n-2})-h_{n-2}$</p>
<p>$&#x3D; (a_{n-1}k_{n-2}+k_{n-3}) + (a_{n-1}h_{n-2}+h_{n-3}) -k_{n-2}-h_{n-2}$</p>
<p>$&#x3D; (a_{n-1}-1)(h_{n-2}+k_{n-2}) + (h_{n-3}+k_{n-3}) $</p>
<p>$ &gt; 0 $</p>
<p>说明了另一个根$-1 &lt; \overline{x} &lt; 0$</p>
<p>至此我们证明了 reduced 和 纯循环之间的 充要</p>
<h4 id="reduced二次无理数-纯循环连分数的-原无理数与它的共轭相反倒数的连分数数值关系"><a href="#reduced二次无理数-纯循环连分数的-原无理数与它的共轭相反倒数的连分数数值关系" class="headerlink" title="reduced二次无理数 纯循环连分数的 原无理数与它的共轭相反倒数的连分数数值关系"></a>reduced二次无理数 纯循环连分数的 原无理数与它的共轭相反倒数的连分数数值关系</h4><p>最后证明 If $x &#x3D; [\overline{a_0, a_1, a_2, . . . , a_{l−1}}]$ and $\overline{x}$ 是它共轭实数, then $-\frac{1}{x} &#x3D; [\overline{a_{l−1}, . . . , a_2, a_1,a_0}].$</p>
<p>Step 1</p>
<p>考虑有限的连分数 $x &#x3D; [a_0,a_1,…,a_n], y&#x3D;[a_n,a_{n-1},…,a_0] , a_i &gt; 0$</p>
<p>$h_n,k_n$为x的分子分母，$h_n’,k_n’$为y的分子分母</p>
<p>要证明 $\frac{h_n}{h_{n-1}} &#x3D; \frac{h_n’}{k_n’}$ 且 $\frac{k_n}{k_{n-1}} &#x3D; \frac{h_{n-1}’}{k_{n-1}’}, n \ge 1$ 且分子分母对应相等(因为是最简分数，所以只要证明了分数相等就有对应相等了)</p>
<p>注意到上面 $h_n &#x3D; a_n \cdot h_{n-1} + h_{n-2}$,同时除以 $h_{n-1}$</p>
<p>$\frac{h_n}{h_{n-1}} &#x3D; a_n + \frac{1}{\frac{h_{n-1}}{h_{n-2}}}$</p>
<p>递归展开 可以得到 $\frac{h_n}{h_{n-1}} &#x3D; [a_n,a_{n-1},…,a_0]$,</p>
<p>注意到 $k_n &#x3D; a_n \cdot k_{n-1} + k_{n-2}$,同理 $\frac{k_n}{k_{n-1}} &#x3D; [a_n,a_{n-1},…,a_1] $(注意是$a_1$不是$a_0$)</p>
<p>根据上面的<code>递归展开的结论</code> 和 <code>y的分子分母定义</code>有</p>
<p>$\frac{h_{n+1}}{h_n} &#x3D; [a_{n+1},a_n,…,a_0] &#x3D; \frac{h_{n+1}’}{k_{n+1}’}$</p>
<p>$\frac{k_{n+1}}{h_n} &#x3D; [a_{n+1},a_n,…,a_1] &#x3D; \frac{h_{n}’}{k_{n}’}$</p>
<p>且分子分母对应相等</p>
<p>Step 2</p>
<p>若x 是纯循环连分数数(即reduced 二次无理数)，那么显然$-\frac{1}{\overline{x}}$也是 reduced的二次无理数，那么它也是纯循环</p>
<p>假设直接取 n+1 &#x3D; 两个循环节长度的最小公倍数</p>
<p>$k_{n}x^2+(k_{n-1}-h_{n})x-h_{n-1}&#x3D;0$</p>
<p>令</p>
<p>$y &#x3D; [\overline{a_n,a_{n-1},…,a_0}] &#x3D; [a_n,a_{n-1},…,a_0,y]$</p>
<p>$y &#x3D; \frac{h_n’y+h_{n-1}’}{k_n’y+k_{n-1}’}$</p>
<p>因为Step 1 我们证明了对应相等$h_n&#x3D;h_n’,k_{n-1}&#x3D;k_{n-1}’, h_{n-1}&#x3D;k_{n}’,h_{n-1}’&#x3D;k_n$</p>
<p>所以做对应替换,$y &#x3D; \frac{h_ny+k_{n}}{h_{n-1}y+k_{n-1}}$</p>
<p>$k_{n}{(-\frac{1}{y})}^2+(k_{n-1}-h_{n})(-\frac{1}{y})-h_{n-1}&#x3D;0$</p>
<p>$-\frac{1}{y} &#x3D; \overline{x}$ 得证(y为正 所以 不可能等于x)</p>
<p>至此 Theorem 1.25. (Galois’ Theorem) 无理数a. a是纯循环连分数（从a0开始的循环节），当且仅当 x is reduced. If $x &#x3D; [\overline{a_0, a_1, a_2, . . . , a_{l−1}}]$ and $\overline{x}$ 是它共轭实数, then $-\frac{1}{\overline{x}} &#x3D; [\overline{a_{l−1}, . . . , a_2, a_1}].$ 得证</p>
<h4 id="根号n-的-连分数性质"><a href="#根号n-的-连分数性质" class="headerlink" title="根号n 的 连分数性质"></a>根号n 的 连分数性质</h4><p>Theorem 1.26 d是非平方数,那么$\sqrt{d} &#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,…,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</p>
<p>也就是 是从第二位开始循环节，且循环节最后一个是它的整部的2倍，且剩余部分是回文</p>
<p>令$x&#x3D;\lfloor \sqrt{d} \rfloor + \sqrt{d}$ 则$\overline{x} &#x3D; \lfloor \sqrt{d} \rfloor - \sqrt{d}$</p>
<p>注意它们的取值范围发现x是reduced 二次无理数</p>
<p>因此 $ x &#x3D; \lfloor \sqrt{d} \rfloor + \sqrt{d} &#x3D; [\overline{2\lfloor \sqrt{d} \rfloor,a_1,a_2,…,a_{l-1}}]$</p>
<p>$ &#x3D; [2\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,…,a_{l-1},2\lfloor \sqrt{d} \rfloor}]$</p>
<p>$ \sqrt{d}&#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_1,a_2,…,a_{l-1},2\lfloor \sqrt{d} \rfloor}]$</p>
<p>根据Galois’ Theorem我们有</p>
<p>$\frac{1}{\sqrt{d}-\lfloor \sqrt{d} \rfloor} &#x3D; -\frac{1}{\overline{x}} &#x3D; [\overline{a_{l-1},…,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</p>
<p>也就是$\sqrt{d} &#x3D; [\lfloor \sqrt{d} \rfloor,\frac{1}{\sqrt{d}-\lfloor \sqrt{d} \rfloor}]$</p>
<p>$ &#x3D; [\lfloor \sqrt{d} \rfloor,\overline{a_{l-1},…,a_2,a_1,2\lfloor \sqrt{d} \rfloor}]$</p>
<p>因此得证 循环内容和 回文性质</p>
<h2 id="Solution-to-Pell’s-Equation"><a href="#Solution-to-Pell’s-Equation" class="headerlink" title="Solution to Pell’s Equation"></a>Solution to Pell’s Equation</h2><p>因为平方带来的对称性，只考虑(x&gt;0,y&gt;0)的解</p>
<h3 id="根号n的连分数渐进分数的性质"><a href="#根号n的连分数渐进分数的性质" class="headerlink" title="根号n的连分数渐进分数的性质"></a>根号n的连分数渐进分数的性质</h3><h4 id="一个引理"><a href="#一个引理" class="headerlink" title="一个引理"></a>一个引理</h4><p>若d为非平方数，$x&#x3D;\sqrt{d}$,</p>
<p>则对于任意n，存在整数$Q_n,P_n$满足$ x_n&#x3D;\frac{P_n+\sqrt{d}}{Q_n}$和$d-P_n^2 &#x3D; 0 (\bmod Q_n)$</p>
<p>显然n&#x3D;0时$(P_0,Q_0) &#x3D; (0,1)$满足,然后归纳法，若 n时能满足上述两点性质，则</p>
<p>$x_{n+1} &#x3D; \frac{1}{x_n-a_n}$</p>
<p>$&#x3D;\frac{1}{\frac{P_n+\sqrt{d}}{Q_n}-a_n}$</p>
<p>$&#x3D;\frac{Q_n}{P_n+\sqrt{d}-a_n{Q_n}}$ (通过分母有理化:</p>
<p>$&#x3D;\frac{Q_n(P_n-a_nQ_n-\sqrt{d})}{(P_n-a_nQ_n)^2-d}$</p>
<p>$&#x3D;\frac{a_nQ_n-P_n+\sqrt{d}}{\frac{d-(P_n-a_nQ_n)^2}{Q_n}}$</p>
<p>$(Q_{n+1},P_{n+1}) &#x3D; (\frac{d-(P_n-a_nQ_n)^2}{Q_n},a_nQ_n-P_n)$</p>
<p>现在要证明的就是 它是满足$\frac{P_{n+1}+\sqrt{d}}{Q_{n+1}}$的形式,并且满足上面的取模</p>
<p>也就是要证明$P_{n+1}$是整数(显然) 和 $Q_{n+1}$是整数</p>
<p>$Q_{n+1} &#x3D; \frac{d-P_n^2}{Q_n}+2a_nP_n-a_n^2Q_n$</p>
<p>因为n时有 $d-P_n^2 &#x3D; 0 (\bmod Q_n)$所以 $Q_{n+1}$是整数</p>
<p>又因为$Q_nQ_{n+1}&#x3D;d-P_{n+1}^2$ 所以  $d-P_{n+1}^2 &#x3D; 0 (\bmod Q_{n+1})$ 得证</p>
<h4 id="直指pell方程左侧表达式"><a href="#直指pell方程左侧表达式" class="headerlink" title="直指pell方程左侧表达式"></a>直指pell方程左侧表达式</h4><p>对于$n \ge 2$ 要证明 $h_{n-1}^2-d k_{n-1}^2&#x3D;(-1)^n Q_n$</p>
<p>证明:</p>
<p>$\sqrt{d} &#x3D; \frac{x_n h_{n-1}+h_{n-2}}{x_nk_{n-1}+k_{n-2}}$</p>
<p>把$ x_n &#x3D; \frac{P_n+\sqrt{d}}{Q_n}$带入并通分化简</p>
<p>$(P_nk_{n-1}+Q_nk_{n-2}-h_{n-1})\sqrt{d} &#x3D; P_nh_{n-1}+h_{n-2}Q_n-k_{n-1}d$</p>
<p>即 $P_nk_{n-1}+Q_nk_{n-2}&#x3D;h_{n-1}$ 且 $P_nh_{n-1}+h_{n-2}Q_n&#x3D;k_{n-1}d$</p>
<p>所以有 $h_{n-1}^2-dk_{n-1}^2 &#x3D; h_{n-1}(P_nk_{n-1}+Q_nk_{n-2})-k_{n-1}(P_nh_{n-1}+h_{n-2}Q_n)$</p>
<p>$&#x3D; Q_n(h_{n-1}k_{n-2}-h_{n-2}k_{n-1})$</p>
<p>$&#x3D; (-1)^nQ_n$</p>
<h3 id="最后一步-连分数和pell方程的关系"><a href="#最后一步-连分数和pell方程的关系" class="headerlink" title="最后一步 连分数和pell方程的关系"></a>最后一步 连分数和pell方程的关系</h3><p>首先假设 (x,y)是 pell方程$x^2-dy^2&#x3D;1$的解$(d&gt;1,x&gt;y&gt;0)$，所以</p>
<p>$|\sqrt{d} - \frac{x}{y}| &#x3D; |\frac{dy^2-x}{y^2(\sqrt{d}+\frac{x}{y})}| &lt; \frac{1}{2y^2}$ (从一定程度上说明了 为什么前面要去证明 小于$\frac{1}{2y^2}$</p>
<p>根据前面推的 我们知道满足这个表达式的一定是 渐进值</p>
<p>(Yang.pdf那个paper下面的部分蛮多笔误的 不过能看懂证明思路)</p>
<p>因为我们上面有 $h_{n-1}^2-dk_{n-1}^2&#x3D;(-1)^nQ_n$ 也就是如果要满足pell方程 那么$|Q_n|&#x3D;1$，分类讨论$Q_n$</p>
<p>假设 $\sqrt{d}$的 最小周期长度为l</p>
<h4 id="分类讨论-Q-x3D-1"><a href="#分类讨论-Q-x3D-1" class="headerlink" title="分类讨论 Q &#x3D; -1"></a>分类讨论 Q &#x3D; -1</h4><p>$Q_n \neq -1, n &gt; 0$</p>
<p>证明</p>
<p>注意到上面根据$\sqrt{d}$的表达式 证明了$n&gt;0$时，$x_n$是纯循环连分数，也就是reduced</p>
<p>如果$Q_n &#x3D; -1$ 因为$x_n&#x3D;\frac{P_n+\sqrt{d}}{Q_n}$,所以有 $x_n&#x3D;-P_n-\sqrt{d} &gt; 1$,有$-1&lt;-P_n+\sqrt{d} &lt; 0$ (Galois)</p>
<p>有 $\sqrt{d} &lt; P_n &lt; -\sqrt{d} - 1$ 矛盾 所以$Q_n \neq -1$, 对于$Q_0 &#x3D; 1$也满足,得证</p>
<h4 id="分类讨论-Q-x3D-1-1"><a href="#分类讨论-Q-x3D-1-1" class="headerlink" title="分类讨论 Q &#x3D; 1"></a>分类讨论 Q &#x3D; 1</h4><p>$Q_n &#x3D; 1$当且仅当n为循环节长度的倍数才有</p>
<p>证明</p>
<p>若于$n&gt;1$若$Q_n&#x3D;1$那么有$x_n&#x3D;P_n+\sqrt{d}$，它的共轭 $-1 &lt; P_n-\sqrt{d} &lt; 0$ 即 $P_n&#x3D;\lfloor \sqrt{d} \rfloor$所以 $x_n &#x3D; \lfloor \sqrt{d} \rfloor + \sqrt{d}$</p>
<p>$ \lfloor \sqrt{d} \rfloor +\sqrt{d} &#x3D; x_n &#x3D; 2\lfloor\sqrt{d}\rfloor + \frac{1}{\frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}} $ 即 $ x_{n+1} &#x3D; \frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}$</p>
<p>$ \sqrt{d} &#x3D; x_0 &#x3D; \lfloor \sqrt{d} \rfloor + \frac{1}{\frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}}$ 即 $x_1 &#x3D; \frac{1}{\sqrt{d} - \lfloor \sqrt{d} \rfloor}$</p>
<p>说明了 它的下一个数$x_{n+1} $和$x_1$相等, 这说明如果$Q_n &#x3D; 1$ 那么n是当且仅当循环节长度的倍数(如果为1则循环节长度)</p>
<p>如果n是循环节倍数 有</p>
<p>$\frac{P_{kl}+\sqrt{d}}{Q_{kl}} &#x3D; x_{kl} &#x3D; [\overline{2\lfloor \sqrt{d} \rfloor,a_1,a_2,…,a_{l-1}}] &#x3D; \sqrt{d}+\lfloor\sqrt{d}\rfloor,(k&gt;0)$</p>
<p>$(P_{kl},Q_{kl}) &#x3D; (\lfloor\sqrt{d}\rfloor,1)$</p>
<p>对于n&#x3D;0也满足，充要得证</p>
<h4 id="完结"><a href="#完结" class="headerlink" title="完结"></a>完结</h4><p>最后回到这里 $h_{n-1}^2-dk_{n-1}^2&#x3D;(-1)^nQ_n &#x3D; (-1)^n $ 也就是再看个奇偶，最后得到了pell方程和连分数比较紧密的结论</p>
<p>假设 $\sqrt{d}$的 最小周期长度为l</p>
<p>那么对应pell 方程的最小解</p>
<p>$(x,y) &#x3D; {h_{l-1},k_{l-1}}$ 长度为偶数</p>
<p>$(x,y) &#x3D; {h_{2l-1},k_{2l-1}}$ 长度为奇数</p>
<h2 id="回顾历程"><a href="#回顾历程" class="headerlink" title="回顾历程"></a>回顾历程</h2><ol>
<li>pell方程基础解</li>
<li>pell方程解存在性</li>
<li>连分数分子分母递推式</li>
<li>连分数，分子分母相关性质(分子分母互质性,原无理数与渐进数差值表达式，差值绝对值单调递减性，连分数是最给定分母以及更小分母中最接近原无理数，任何满足“某不等式”的数字是渐进数（这个不等式是pell方程 的必要条件）)</li>
<li>Lagrange’s Theorem 二次无理数与有循环节的连分数</li>
<li>Galois’ Theorem 纯循环连分数与reduced二次无理数</li>
<li>根号n的连分数性质（精确的$\frac{P_n+\sqrt{d}}{Q_n}$表示 和 形如pell方程 与$Q_n$的等式）</li>
<li>分类讨论$Q_n$与n的取值最后的结论</li>
</ol>
<p>方法涉及</p>
<ol>
<li>二项式展开，不等式，唯一最小(有术语吗)，无理数，反证法</li>
<li>反复抽屉原理，绝对值，无理数，模运算</li>
<li>矩阵乘法，归纳法&#x2F;递推关系</li>
<li>归纳法&#x2F;递推，互质，不等式放缩，三角不等式，反证法，二元一次方程组，巧妙正负值+不等式。 很多方法都是多次</li>
<li>归纳，反证，单调+整数离散+有限，二次函数</li>
<li>共轭实数，反向推，归纳法</li>
<li>归纳法,上面的分子分母等式性质</li>
<li>-1的幂次,分类讨论，Lagrange,Galois</li>
</ol>
<p>然后还有很多整数的离散性质</p>
<p>证明过程感受</p>
<ol>
<li>如果有证明方向，看上去还挺自然的思路</li>
<li>正过来倒过去看，不明白为什么能想到去先找那个不等式,以及中间的X,Y和取值是怎样的思想</li>
<li>挺自然</li>
<li>其实这里都是 为了那个pell方程的必要条件，但是怎么想到这一条路径。另外就是这里面二元一次方程组感觉是不是和上面X,Y是同样的思路，但是我都没有理解到思想根源，怎么能在证明之前，先去做一个分式最后证明这个分式是整数。另外就是这些反复用于后面证明的一些分子分母等式性质。还有一个我不太会的就是多级放缩，到底是原作者自己多次调整最后得出的过程，还是说有什么思路能做到多次放缩来完成目标不等式证明(或反证)</li>
<li>这里的充分和必要完全不是一个难度，这个三元组的设计还是很能简化描述, 我想的方向是去做精确表达式，再做范围，如果证到有限范围即可，总之自己没证明到</li>
<li>reduced的性质在这里我不知道怎么用，也不知道为什么要，结果是后面证明需要结论</li>
<li>假设给我要证明的目标，这里可能如果我自己来证明会有一个基本去做的归纳目标，但是证明过程中会衍生出额外的证明目标</li>
<li>难点在说要怎么想到去找$h_{n-1}^2-dk_{n-1}^2&#x3D;(-1)^nQ_n$这个方向去证，而后面的分类讨论就比较自然</li>
</ol>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><p>似乎还不足以写代码?，下面的问题是 如何得到根号n的连分数呢？ 手工三元组(分母整数，有理分子整数，无理分子的系数整数)是一个办法，有没有更好的办法呢。</p>
<p>但我们至少说能证明了这个结论</p>
<p>python3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> gcd(b, a % b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">i, p</span>):</span><br><span class="line">    sq = <span class="built_in">int</span>(i**(<span class="number">0.5</span>))</span><br><span class="line">    <span class="keyword">if</span> sq * sq == i:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    hk = ((<span class="number">1</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">    <span class="comment"># a, b, c =&gt; (a+b*sqrt&#123;d&#125;)/c</span></span><br><span class="line">    cur = (<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> cur[<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">or</span> hk[<span class="number">0</span>][<span class="number">0</span>]*hk[<span class="number">0</span>][<span class="number">0</span>] - i*hk[<span class="number">0</span>][<span class="number">1</span>]*hk[<span class="number">0</span>][<span class="number">1</span>] != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> p:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;x_&quot;</span>, idx, <span class="string">&quot; = &quot;</span>, cur)</span><br><span class="line">        z = <span class="built_in">int</span>((cur[<span class="number">0</span>] + cur[<span class="number">1</span>] * (i**(<span class="number">0.5</span>)))/cur[<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">if</span> p:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;a_&quot;</span>, idx, <span class="string">&quot; = &quot;</span>,  z)</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">        <span class="comment"># z 1</span></span><br><span class="line">        <span class="comment"># 1 0</span></span><br><span class="line">        <span class="comment">#    hk 00 01</span></span><br><span class="line">        <span class="comment">#       10 11</span></span><br><span class="line">        newhk = (</span><br><span class="line">            ((hk[<span class="number">0</span>])[<span class="number">0</span>]*z+(hk[<span class="number">1</span>])[<span class="number">0</span>], (hk[<span class="number">0</span>])[<span class="number">1</span>]*z+(hk[<span class="number">1</span>])[<span class="number">1</span>]),</span><br><span class="line">            ((hk[<span class="number">0</span>])[<span class="number">0</span>], (hk[<span class="number">0</span>])[<span class="number">1</span>])</span><br><span class="line">        )</span><br><span class="line">        hk = newhk</span><br><span class="line">        <span class="keyword">if</span> p:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;hk = &quot;</span>, hk)</span><br><span class="line">        a = cur[<span class="number">0</span>]</span><br><span class="line">        b = cur[<span class="number">1</span>]</span><br><span class="line">        c = cur[<span class="number">2</span>]</span><br><span class="line">        <span class="comment"># c/(a+b*sqrt&#123;i&#125;-c*z)</span></span><br><span class="line">        <span class="comment"># c*(a-b*sqrt&#123;i&#125;-cz)/((a-cz)^2-b^2*i)</span></span><br><span class="line">        nv = (c*(a-c*z), -c*b, (a-c*z)*(a-c*z)-b*b*i)</span><br><span class="line">        cm = gcd(<span class="built_in">abs</span>(nv[<span class="number">0</span>]), <span class="built_in">abs</span>(nv[<span class="number">1</span>]))</span><br><span class="line">        cm = gcd(cm, <span class="built_in">abs</span>(nv[<span class="number">2</span>]))</span><br><span class="line">        nv = (nv[<span class="number">0</span>]/cm, nv[<span class="number">1</span>]/cm, nv[<span class="number">2</span>]/cm)</span><br><span class="line">        <span class="keyword">if</span> nv[<span class="number">2</span>] &lt; <span class="number">0</span>:</span><br><span class="line">            nv = (-nv[<span class="number">0</span>], -nv[<span class="number">1</span>], -nv[<span class="number">2</span>])</span><br><span class="line">        cur = nv</span><br><span class="line">    <span class="keyword">return</span> hk[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    ans = (<span class="number">0</span>, (<span class="number">1</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">1001</span>):</span><br><span class="line">        newans = calc(i, <span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">if</span> newans[<span class="number">0</span>] &gt; ans[<span class="number">1</span>][<span class="number">0</span>]:</span><br><span class="line">            ans = (i, newans[:])</span><br><span class="line">        <span class="built_in">print</span>(i, <span class="string">&quot; -&gt; &quot;</span>, newans)</span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到x的值会达到十进制的38位，暴力不可取!即使用了上面分析出的一些晓得性质最多优化661倍 依然是能有10的35次方的数量级。</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Continued_fraction">Continued fraction</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pell%27s_equation">Pell equation</a></p>
<p><a target="_blank" rel="noopener" href="https://www.math.uchicago.edu/~may/VIGRE/VIGRE2008/REUPapers/Yang.pdf">Yang.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://crypto.stanford.edu/pbc/notes/contfrac/pell.html">stanford crypto pell</a></p>
<p><a target="_blank" rel="noopener" href="http://sites.millersville.edu/bikenaga/number-theory/periodic-continued-fractions/periodic-continued-fractions.html">millersville periodic-continued-fractions</a></p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=E51GKQ1qorE">YouTube:Number Theory:Pell’s Equation part 1</a></p>
<p><a target="_blank" rel="noopener" href="https://dspace.sunyconnect.suny.edu/bitstream/handle/1951/69917/fulltext.pdf?sequence=1&isAllowed=y">A short proof and generalization of Lagrange’s theorem on continued fractions</a></p>
<p><a target="_blank" rel="noopener" href="http://sites.millersville.edu/bikenaga/number-theory/purely-periodic-continued-fractions/purely-periodic-continued-fractions.html">purely periodic continued fractions</a></p>
<h1 id="总结-amp-感受"><a href="#总结-amp-感受" class="headerlink" title="总结&amp;感受"></a>总结&amp;感受</h1><p>有些结论在证明过程中其实是缩小了范围，有些结论其实放大定义域之类也是成立的，但我们在证明过程中却只使用了我们所需要的部分。这类的从定义域和对应的要证明的逻辑不是“完美对应”的，但是足够，不知道是好还是不好。</p>
<p>证明的结论之间引用过程，感觉画成网状或者树状关系图会更好？</p>
<p>看youtube了上的讲解视频，会发现有一种写代码的抽取函数感觉，和我上面完全拆开证明不一样，抽函数的感觉其实在数学里大概是叫做“令”+“引理”，感觉和完全展开比较，的确能减少很多心智负担啊！如果你也能打开youtube建议去看看</p>
<p>另外比如有些 强结论要用的时候，即使你证出了相对弱的结论，但没有证明出强结论，其实相当于“没有用”，比如上面 基础解，的平方，的n次方，和任意另一组解能产生新的解的证明。当然如果能证明出，那些就是过程了，但不是步骤（虽然我上面有写进文中，因为要简洁整理的话，直接强结论证明，即可其它的弱的可以直接省略</p>
<p>虽然视频看的时候的确感觉到老师和同学的口算不如国内，但自从自己思考过十进制的意义以后，感觉数值计算都不再重要，有的是计算机，不需要人类来算。</p>
<p>youtuber james cook 有证明一个 同系数二元二次方程 之间的关系，可以用它来 从 不是解的东西里生成解(感觉好像不是特别行，因为一个等式的 四个值仅仅由两个变量控制而不是3个？)！(Quadradic Forms) Q(u+v)+Q(u-v)&#x3D;2(Q(u)+Q(v)),然后以此建立树，考虑其中的“正负交替路线”river</p>
<p>多核没智力还是搞不动数学啊,</p>
<p>这篇文章整理了很多篇其它资料，所以在符号使用上还不够统一，之后看有空整理一下</p>
<p>在我快写完这一篇文章的时候发现了 一个<a target="_blank" rel="noopener" href="https://chaoli.club/index.php/2756/0">超理论坛-连分数入门</a> 注册需要一点点水平XD，这篇是带着例子讲解写的！(大自看了一下 感觉很棒 推荐), 又 有些性质证明方式不止一种，例如我本篇文章所抄来的证明 二次无理数和有循环节的充要 会感觉更漂亮一些</p>
<p>有些paper写到后面还是很多笔误，不过看通了也是能理解具体过程</p>
<p>有一个想法是 哪些结论是关键或者说证明的难点，其实可以这样想，现在，把文章中一些部分换成填空，你还能不能补全整个文章，不需要完全一样，只要能证明就行。这样想的话，就会知道所谓的难点是在哪。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/2020-04-27-tencent042C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/2020-04-27-tencent042C/" class="post-title-link" itemprop="url">tencent 04 26 C 状压DP入门</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-04-27 10:37:14" itemprop="dateCreated datePublished" datetime="2020-04-27T10:37:14+08:00">2020-04-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2023-02-05 19:13:42" itemprop="dateModified" datetime="2023-02-05T19:13:42+08:00">2023-02-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/tencent/" itemprop="url" rel="index"><span itemprop="name">tencent</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/2020-04-27-tencent042C/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020-04-27-tencent042C/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>1.1k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>4 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>n张牌，正反两面都有数字，给初始序列。</p>
<p>一次操作交换相邻的两张牌并翻转这两张牌。</p>
<p>求问能否最后所有朝上的牌构成非减序列</p>
<p>2&lt;&#x3D; n&lt;&#x3D;18</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>显然数值范围没意义，因为就算很大，离散一下也就最多36个</p>
<p>显然根据交换规则，把i放到j后，它的正反面是确定的</p>
<p>所以排列的状态数是<code>n!</code>，18的阶乘就不要想枚举了</p>
<p>这题的边界感觉也能很难想，所以有想过的一个骗分方向是迭代加深，但是估计只能骗分答案比较小，或者n比较小的点</p>
<hr>
<p>有人贪心100%了？？ 不知道腾讯出题的人在干嘛？这样明显一堆hack点的能100%，叫那些写状压的没满的怎么想</p>
<hr>
<p>前置知识：冒泡排序操作数 &#x3D; 逆序对个数。</p>
<p>这题目只看操作过程中坐标的变化，实际就是在进行冒泡排序，所以我们的步数也就是 最初顺序标号变成最后顺序标号的逆序对个数</p>
<hr>
<p>状态设计[前i个，使用的元素的state，第i个用的是下标j]</p>
<p>注意到state用0&#x2F;1来表示是否选择，1的个数就是i，所以可以省略为<code>[state,j]</code></p>
<p>这个状态对应的值 <code>dp[state,j]</code>为 已经选出的元素的逆序对的最小值</p>
<p>转移方程为</p>
<p><code>dp[state][j] = min(dp[state 去掉 j][for剩余可选] + state剩余部分和j构成的逆序对)</code> </p>
<p>注意到<code>state</code>内部顺序不影响state剩余部分 和 j构成的逆序对的值</p>
<p><code>= min(dp[state 去掉 j][for剩余可选]) + state剩余部分和j构成的逆序对</code></p>
<p>所以 一个状态的最小，是从去掉最后一个的最小来的</p>
<p>(感觉这里局部最优&#x2F;最小性证明有点绕，或者可以用归纳证？</p>
<p>注意保证题目限制非减序列别忘了</p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><p>不是我写的，链接在下方,加了点注释</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">作者：qin_peng</span><br><span class="line">链接：https://www.nowcoder.com/discuss/417957?type=0&amp;order=0&amp;pos=77&amp;page=1</span><br><span class="line">来源：牛客网</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> me(a,x) memset(a,x,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc scanf</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pr printf</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IN freopen(<span class="string">&quot;in.txt&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OUT freopen(<span class="string">&quot;out.txt&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">6</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">O</span><span class="params">()</span></span>&#123;<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);<span class="keyword">return</span> <span class="number">0</span>;&#125;<span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keyword">typename</span>... Ty&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">O</span><span class="params">(<span class="type">const</span> T&amp; a,<span class="type">const</span> Ty&amp;... b)</span></span>&#123;cout&lt;&lt;a&lt;&lt;<span class="string">&#x27; &#x27;</span>;<span class="keyword">return</span> <span class="built_in">O</span>(b...);&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">I</span><span class="params">()</span></span>&#123;&#125;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keyword">typename</span>... Ty&gt;<span class="function"><span class="type">void</span> <span class="title">I</span><span class="params">(T&amp; a,Ty&amp;... b)</span></span>&#123;cin&gt;&gt;a;<span class="built_in">I</span>(b...);&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="type">void</span> <span class="title">db</span><span class="params">(T *bg,T *ed)</span></span>&#123;<span class="keyword">while</span>(bg!=ed)cout&lt;&lt;*bg++&lt;&lt;<span class="string">&#x27; &#x27;</span>;<span class="built_in">pr</span>(<span class="string">&quot;\n&quot;</span>);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mul_64</span><span class="params">(ll x,ll y,ll c)</span></span>&#123;<span class="keyword">return</span> (x*y-(ll)((<span class="type">long</span> <span class="type">double</span>)x/c*y)*c+c)%c;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">ksm</span><span class="params">(ll a,ll b,ll c)</span></span>&#123;ll ans=<span class="number">1</span>;<span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>,a=a*a%c)<span class="keyword">if</span>(b&amp;<span class="number">1</span>)ans=ans*a%c;<span class="keyword">return</span> ans;&#125;</span><br><span class="line"><span class="type">int</span> n,a[<span class="number">20</span>],b[<span class="number">20</span>];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">1</span>&lt;&lt;<span class="number">20</span>][<span class="number">20</span>];</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">I</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)<span class="built_in">sc</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)<span class="built_in">sc</span>(<span class="string">&quot;%d&quot;</span>,&amp;b[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;i+=<span class="number">2</span>)<span class="built_in">swap</span>(a[i],b[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(<span class="number">1</span>&lt;&lt;n);i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            dp[i][j]=INF; <span class="comment">// 不可达</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)dp[<span class="number">1</span>&lt;&lt;i][i]=<span class="number">0</span>; <span class="comment">// 选单个 逆序对为0</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(<span class="number">1</span>&lt;&lt;n);i++)&#123; <span class="comment">// 保证子状态先于父状态计算</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dp[i][j]==INF)<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;n;k++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i&gt;&gt;k&amp;<span class="number">1</span>)<span class="keyword">continue</span>;</span><br><span class="line">                <span class="type">int</span> x=__builtin_popcount(i)&amp;<span class="number">1</span>; <span class="comment">// 内置计算1的个数</span></span><br><span class="line">                <span class="keyword">if</span>(x)&#123; <span class="comment">// 非减 限制</span></span><br><span class="line">                    <span class="keyword">if</span>(b[k]&lt;a[j])<span class="keyword">continue</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(a[k]&lt;b[j])<span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> l=k+<span class="number">1</span>;l&lt;n;l++)&#123; <span class="comment">// 计算 state补上k以后 state与k之间新形成的逆序对</span></span><br><span class="line">                    <span class="keyword">if</span>(i&gt;&gt;l&amp;<span class="number">1</span>)ans++;</span><br><span class="line">                &#125;</span><br><span class="line">                dp[i|<span class="number">1</span>&lt;&lt;k][k]=<span class="built_in">min</span>(dp[i|<span class="number">1</span>&lt;&lt;k][k],dp[i][j]+ans); <span class="comment">// 递推感觉局部最小性有点奇怪？只有我？但是从上向下看是没问题的。所以逻辑一致没问题</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans=INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)ans=<span class="built_in">min</span>(ans,dp[(<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>][i]);</span><br><span class="line">    <span class="keyword">if</span>(ans==INF)<span class="built_in">O</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">O</span>(ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>很早看到18 就条件反射的想2的n次方</p>
<p>看到交换两个也想到了逆序对和冒泡</p>
<p>但没想出最后的状态以及转移，果然设计状态有点难啊，我好菜哇</p>
<p>大概技术总结的话应该是 除了最简单的状态，还有一种是<code>[state][末尾选择]</code>，这样的话能保证性质就行，如这里的末尾选择就是用来保证 非减少的</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yexiaorain.github.io/Blog/cf/1340c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/7298239?v=4">
      <meta itemprop="name" content="Xiao Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | YeXiaoRain Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Blog/cf/1340c/" class="post-title-link" itemprop="url">Codeforces 1340 C, 入门bfs</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-04-25 10:37:14" itemprop="dateCreated datePublished" datetime="2020-04-25T10:37:14+08:00">2020-04-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2023-02-05 19:13:42" itemprop="dateModified" datetime="2023-02-05T19:13:42+08:00">2023-02-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/Blog/categories/Codeforces/" itemprop="url" rel="index"><span itemprop="name">Codeforces</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/Blog/cf/1340c/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="cf/1340c/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>568</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>2 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1340/problem/C">https://codeforces.com/contest/1340/problem/C</a></p>
<h1 id="状态设计"><a href="#状态设计" class="headerlink" title="状态设计"></a>状态设计</h1><p>应该算bfs+dp?</p>
<p>状态设计 <code>dist[第i个检查点][剩余步数j] = 到达的最小轮数 或 不可达</code></p>
<p>转移从数轴上看，只有左右关系相邻的两个点能在dist中转换，每个点最多被更新一次。</p>
<p>所以 O(nm)时间空间</p>
<p>注意的是 不能跨过g，每次转移前是<code>j&lt;g</code>,转以后的<code>j&lt;=g</code></p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><p>托爷代码：<a target="_blank" rel="noopener" href="https://codeforces.com/contest/1340/submission/77808028">https://codeforces.com/contest/1340/submission/77808028</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,a,n) for (int i=a;i&lt;n;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> per(i,a,n) for (int i=n-1;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> foreach(i, v) for (__typeof((v).begin()) i = (v).begin(); i != (v).end(); ++ i)</span></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="type">int</span> n, m;</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">d</span><span class="params">(m)</span></span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">    cin &gt;&gt; d[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(d.<span class="built_in">begin</span>(), d.<span class="built_in">end</span>());</span><br><span class="line">  <span class="type">int</span> g, r;</span><br><span class="line">  cin &gt;&gt; g &gt;&gt; r;</span><br><span class="line">  <span class="comment">// dist[0-&gt;m-1][0-&gt;g] = -1; 不可达</span></span><br><span class="line">  <span class="comment">// dist[第i个停靠点][还要走j步为g的整数倍] = 最小的完整轮数</span></span><br><span class="line">  vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dist</span>(m, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(g + <span class="number">1</span>, <span class="number">-1</span>));</span><br><span class="line">  dist[<span class="number">0</span>][g] = <span class="number">0</span>; <span class="comment">// 可达的轮数为0</span></span><br><span class="line">  vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; que;</span><br><span class="line">  que.<span class="built_in">emplace_back</span>(<span class="number">0</span>, g);</span><br><span class="line">  <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">    <span class="comment">// 步数少于等于g的广搜</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> b = <span class="number">0</span>; b &lt; (<span class="type">int</span>) que.<span class="built_in">size</span>(); b++) &#123;</span><br><span class="line">      <span class="type">int</span> i = que[b].first; <span class="comment">// 位置</span></span><br><span class="line">      <span class="type">int</span> j = que[b].second; <span class="comment">// 剩余步数</span></span><br><span class="line">      <span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123; <span class="comment">//</span></span><br><span class="line">        <span class="type">int</span> go = d[i] - d[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (j &gt;= go) &#123;</span><br><span class="line">          <span class="keyword">if</span> (dist[i - <span class="number">1</span>][j - go] == <span class="number">-1</span>) &#123;</span><br><span class="line">            que.<span class="built_in">emplace_back</span>(i - <span class="number">1</span>, j - go);</span><br><span class="line">            dist[i - <span class="number">1</span>][j - go] = dist[i][j];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (i &lt; m - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> go = d[i + <span class="number">1</span>] - d[i];</span><br><span class="line">        <span class="keyword">if</span> (j &gt;= go) &#123;</span><br><span class="line">          <span class="keyword">if</span> (dist[i + <span class="number">1</span>][j - go] == <span class="number">-1</span>) &#123;</span><br><span class="line">            que.<span class="built_in">emplace_back</span>(i + <span class="number">1</span>, j - go);</span><br><span class="line">            dist[i + <span class="number">1</span>][j - go] = dist[i][j];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; new_que;</span><br><span class="line">    <span class="comment">// 利用g表示 上一层节点，0表示新走到的节点， 产生新的一层</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> b = <span class="number">0</span>; b &lt; (<span class="type">int</span>) que.<span class="built_in">size</span>(); b++) &#123;</span><br><span class="line">      <span class="type">int</span> j = que[b].second;</span><br><span class="line">      <span class="keyword">if</span> (j == <span class="number">0</span>) &#123; <span class="comment">// 新走道德合法点</span></span><br><span class="line">        <span class="type">int</span> i = que[b].first;</span><br><span class="line">        <span class="keyword">if</span> (dist[i][g] == <span class="number">-1</span>) &#123;</span><br><span class="line">          dist[i][g] = dist[i][<span class="number">0</span>] + <span class="number">1</span>; <span class="comment">// 轮次+1</span></span><br><span class="line">          new_que.<span class="built_in">emplace_back</span>(i, g);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">swap</span>(que, new_que);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">const</span> <span class="type">long</span> <span class="type">long</span> inf = (<span class="type">long</span> <span class="type">long</span>) <span class="number">1e18</span>;</span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> ans = inf;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= g; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (dist[m - <span class="number">1</span>][i] != <span class="number">-1</span>) &#123; <span class="comment">// 可达到 最后一个点一定是终点</span></span><br><span class="line">      <span class="type">long</span> <span class="type">long</span> cur = (<span class="type">long</span> <span class="type">long</span>) dist[m - <span class="number">1</span>][i] * (g + r) + (g - i); <span class="comment">//计算总时间</span></span><br><span class="line">      ans = <span class="built_in">min</span>(ans, cur);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; (ans == inf ? <span class="number">-1</span> : ans) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>还真是个大水题 放在1C</p>
<p>自己也在想dp，状态，还有dijs,看推有人还真的过了。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/Blog/page/36/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/Blog/">1</a><a class="page-number" href="/Blog/page/6/">6</a><a class="page-number" href="/Blog/page/22/">22</a><a class="page-number" href="/Blog/page/30/">30</a><a class="page-number" href="/Blog/page/34/">34</a><a class="page-number" href="/Blog/page/36/">36</a><span class="page-number current">37</span><a class="page-number" href="/Blog/page/38/">38</a><a class="page-number" href="/Blog/page/40/">40</a><a class="page-number" href="/Blog/page/44/">44</a><a class="page-number" href="/Blog/page/49/">49</a><a class="extend next" rel="next" href="/Blog/page/38/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiao Ye</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">424k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">23:35</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/Blog/js/comments.js"></script><script src="/Blog/js/utils.js"></script><script src="/Blog/js/schemes/muse.js"></script><script src="/Blog/js/next-boot.js"></script><script src="/Blog/js/bookmark.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/Blog/js/third-party/search/local-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/Blog/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.2.0/quicklink.umd.js" integrity="sha256-4kQf9z5ntdQrzsBC3YSHnEz02Z9C1UeW/E9OgnvlzSY=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":false,"home":false,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://yexiaorain.github.io/Blog/page/37/"}</script>
  <script src="/Blog/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"yexiaorain","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/Blog/js/third-party/comments/disqus.js"></script>

</body>
</html>
